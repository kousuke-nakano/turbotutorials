<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>02_01Lithium_dimer &mdash; Turbotutorials Updated on 09/06/2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/my_theme.css?v=153a98d2" />
      <link rel="stylesheet" href="../../../_static/roles.css" type="text/css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=eee8fc05"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="98 Wavefuntion optimization" href="../98_wf_optimization/tutorial.html" />
    <link rel="prev" title="01_02Hydrogen_dimer" href="../01_02Hydrogen_dimer/tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Turbotutorials
          </a>
              <div class="version">
                Updated on 09/06/2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../00installation/00installation.html">Installation of packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01turborvb_manual/00index.html">TurboRVB user manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../00index.html">TurboRVB tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html">01_01Hydrogen_dimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_02Hydrogen_dimer/tutorial.html">01_02Hydrogen_dimer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">02_01Lithium_dimer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">00 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#li2-dimer-and-li-atom-jdft-ansatz">01 Li<sub>2</sub> dimer and Li atom - JDFT ansatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-preparing-a-wave-function">01-01 Li<sub>2</sub> dimer: Preparing a wave function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-generate-a-trial-wave-function-using-dft">01-02 Li<sub>2</sub> dimer: generate a trial wave function using DFT.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-jastrow-factor-optimization-wf-jdft">01-03 Li<sub>2</sub> dimer: Jastrow factor optimization (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-vmc-wf-jdft">01-04 Li<sub>2</sub> dimer: VMC (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-lrdmc-wf-jdft">01-05 Li<sub>2</sub> dimer: LRDMC (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li-atom-preparation-of-a-wave-function">01-06 Li atom: preparation of a wave function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li-atom-generate-a-trial-wave-function-using-dft">01-07 Li atom: generate a trial wave function using DFT.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li-atom-jastrow-factor-optimization-wf-jdft">01-08 Li atom: Jastrow factor optimization (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li-atom-vmc-wf-jdft">01-09 Li atom: VMC (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li-atom-lrdmc-wf-jdft">01-10 Li atom: LRDMC (WF=JDFT)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#li2-dimer-and-li-atom-jsd-ansatz">02 Li<sub>2</sub> dimer and Li atom - JSD ansatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jsd">02-01 Li<sub>2</sub> dimer and Li atom: VMC-optimization (WF=JSD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-wf-jsd">02-02 Li<sub>2</sub> dimer and Li atom: VMC (WF=JSD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-lrdmc-wf-jsd">02-03 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JSD)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#li2-dimer-and-li-atom-jsagps-ansatz">03 Li<sub>2</sub> dimer and Li atom - JsAGPs ansatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-conversion-of-wf-wf-jsagps">03-01 Li<sub>2</sub> dimer and Li atom: Conversion of WF (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-conversion-check-wf-jsagps">03-02 Li<sub>2</sub> dimer and Li atom: conversion check (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jsagps">03-03 Li<sub>2</sub> dimer and Li atom: VMC-optimization (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-wf-jsagps">03-04 Li<sub>2</sub> dimer and Li atom: VMC (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-lrdmc-wf-jsagps">03-05 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JsAGPs)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#li2-dimer-and-li-atom-jagpu-ansatz">04 Li<sub>2</sub> dimer and Li atom - JAGPu ansatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-prepration-of-a-wave-function">04-01 Li<sub>2</sub> dimer: prepration of a wave function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#turborvbtutorial-0201-04-02">04-02 Li<sub>2</sub> dimer: generate a trial wave function using DFT.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-check-local-magnetic-moments">04-03 Li<sub>2</sub> dimer: Check local magnetic moments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-convert-jdft-wf-to-jagpu-one">04-04 Li<sub>2</sub> dimer and Li atom: Convert JDFT WF to JAGPu one</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-optimization-wf-jagpu">04-05 Li<sub>2</sub> dimer and Li atom: Optimization (WF=JAGPu)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-and-lrdmc">04-06 Li<sub>2</sub> dimer and Li atom: VMC and LRDMC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#li2-dimer-and-li-atom-jagp-jpf-ansatz">05 Li<sub>2</sub> dimer and Li atom - JAGP (JPf) ansatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spin-unpolarized-case-li2-dimer-convert-jdft-wf-to-jagp-one">05-01 (spin-unpolarized case) Li<sub>2</sub> dimer: Convert JDFT WF to JAGP one</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spin-polarized-case-li-atom-convert-jdft-wf-to-jagp-one">05-02 (spin-polarized case) Li atom: Convert JDFT WF to JAGP one</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jpf">05-03 Li<sub>2</sub> dimer and Li atom: VMC optimization (WF=JPf)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-wf-jpf">05-04 Li<sub>2</sub> dimer and Li atom: VMC (WF=JPf)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#li2-dimer-and-li-atom-lrdmc-wf-jpf">05-05 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JPf)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../98_wf_optimization/tutorial.html">98 Wavefuntion optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../02turbogenius_tutorial/00index.html">Turbo-Genius tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03turboworkflows_tutorial/00index.html">TurboWorkflows tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Turbotutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../00index.html">TurboRVB tutorials</a></li>
      <li class="breadcrumb-item active">02_01Lithium_dimer</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/01turborvb_tutorial/02_01Li-dimer/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lithium-dimer">
<span id="turborvbtutorial-0201"></span><h1><a class="toc-backref" href="#id2" role="doc-backlink">02_01Lithium_dimer</a><a class="headerlink" href="#lithium-dimer" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<span id="turborvbtutorial-0201-00"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">00 Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#lithium-dimer" id="id2">02_01Lithium_dimer</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id3">00 Introduction</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-jdft-ansatz" id="id4">01 Li<sub>2</sub> dimer and Li atom - JDFT ansatz</a></p>
<ul>
<li><p><a class="reference internal" href="#li2-dimer-preparing-a-wave-function" id="id5">01-01 Li<sub>2</sub> dimer: Preparing a wave function</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-generate-a-trial-wave-function-using-dft" id="id6">01-02 Li<sub>2</sub> dimer: generate a trial wave function using DFT.</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-jastrow-factor-optimization-wf-jdft" id="id7">01-03 Li<sub>2</sub> dimer: Jastrow factor optimization (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-vmc-wf-jdft" id="id8">01-04 Li<sub>2</sub> dimer: VMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-lrdmc-wf-jdft" id="id9">01-05 Li<sub>2</sub> dimer: LRDMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#li-atom-preparation-of-a-wave-function" id="id10">01-06 Li atom: preparation of a wave function</a></p></li>
<li><p><a class="reference internal" href="#li-atom-generate-a-trial-wave-function-using-dft" id="id11">01-07 Li atom: generate a trial wave function using DFT.</a></p></li>
<li><p><a class="reference internal" href="#li-atom-jastrow-factor-optimization-wf-jdft" id="id12">01-08 Li atom: Jastrow factor optimization (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#li-atom-vmc-wf-jdft" id="id13">01-09 Li atom: VMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#li-atom-lrdmc-wf-jdft" id="id14">01-10 Li atom: LRDMC (WF=JDFT)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-jsd-ansatz" id="id15">02 Li<sub>2</sub> dimer and Li atom - JSD ansatz</a></p>
<ul>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jsd" id="id16">02-01 Li<sub>2</sub> dimer and Li atom: VMC-optimization (WF=JSD)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-wf-jsd" id="id17">02-02 Li<sub>2</sub> dimer and Li atom: VMC (WF=JSD)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-lrdmc-wf-jsd" id="id18">02-03 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JSD)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-jsagps-ansatz" id="id19">03 Li<sub>2</sub> dimer and Li atom - JsAGPs ansatz</a></p>
<ul>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-conversion-of-wf-wf-jsagps" id="id20">03-01 Li<sub>2</sub> dimer and Li atom: Conversion of WF (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-conversion-check-wf-jsagps" id="id21">03-02 Li<sub>2</sub> dimer and Li atom: conversion check (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jsagps" id="id22">03-03 Li<sub>2</sub> dimer and Li atom: VMC-optimization (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-wf-jsagps" id="id23">03-04 Li<sub>2</sub> dimer and Li atom: VMC (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-lrdmc-wf-jsagps" id="id24">03-05 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JsAGPs)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-jagpu-ansatz" id="id25">04 Li<sub>2</sub> dimer and Li atom - JAGPu ansatz</a></p>
<ul>
<li><p><a class="reference internal" href="#li2-dimer-prepration-of-a-wave-function" id="id26">04-01 Li<sub>2</sub> dimer: prepration of a wave function</a></p></li>
<li><p><a class="reference internal" href="#turborvbtutorial-0201-04-02" id="id27">04-02 Li<sub>2</sub> dimer: generate a trial wave function using DFT.</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-check-local-magnetic-moments" id="id28">04-03 Li<sub>2</sub> dimer: Check local magnetic moments</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-convert-jdft-wf-to-jagpu-one" id="id29">04-04 Li<sub>2</sub> dimer and Li atom: Convert JDFT WF to JAGPu one</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-optimization-wf-jagpu" id="id30">04-05 Li<sub>2</sub> dimer and Li atom: Optimization (WF=JAGPu)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-and-lrdmc" id="id31">04-06 Li<sub>2</sub> dimer and Li atom: VMC and LRDMC</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-jagp-jpf-ansatz" id="id32">05 Li<sub>2</sub> dimer and Li atom - JAGP (JPf) ansatz</a></p>
<ul>
<li><p><a class="reference internal" href="#spin-unpolarized-case-li2-dimer-convert-jdft-wf-to-jagp-one" id="id33">05-01 (spin-unpolarized case) Li<sub>2</sub> dimer: Convert JDFT WF to JAGP one</a></p></li>
<li><p><a class="reference internal" href="#spin-polarized-case-li-atom-convert-jdft-wf-to-jagp-one" id="id34">05-02 (spin-polarized case) Li atom: Convert JDFT WF to JAGP one</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jpf" id="id35">05-03 Li<sub>2</sub> dimer and Li atom: VMC optimization (WF=JPf)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-vmc-wf-jpf" id="id36">05-04 Li<sub>2</sub> dimer and Li atom: VMC (WF=JPf)</a></p></li>
<li><p><a class="reference internal" href="#li2-dimer-and-li-atom-lrdmc-wf-jpf" id="id37">05-05 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JPf)</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<p>From this tutorial, you can learn how to calculate all-electron Variational Monte Carlo (VMC) and lattice regularized diffusion Monte Carlo (LRDMC) energies of the Li<sub>2</sub> dimer with various ansatz. JDFT, JSD, JsAGPs, JAGPu, and JAGP(JPf).</p>
<p>Reference values (<a class="reference external" href="https://aip.scitation.org/doi/suppl/10.1063/1.3288054">https://aip.scitation.org/doi/suppl/10.1063/1.3288054</a>)</p>
<dl class="simple">
<dt>Li atom</dt><dd><ul class="simple">
<li><p>HF = -7.4327 Ha</p></li>
<li><p>Exact = -7.4781 Ha</p></li>
</ul>
</dd>
<dt>Li<sub>2</sub> dimer</dt><dd><ul class="simple">
<li><p>d<sub>bond</sub> = 2.67330 angstrom (J. Chem. Phys. 129 204105)</p></li>
<li><p>HF = -14.8715 Ha</p></li>
<li><p>Exact = -14.9951 Ha</p></li>
<li><p>E<sub>bond</sub> = 24.4 kcal/mol = 38.9 mHa</p></li>
</ul>
</dd>
</dl>
</section>
<section id="li2-dimer-and-li-atom-jdft-ansatz">
<span id="turborvbtutorial-0201-01"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink">01 Li<sub>2</sub> dimer and Li atom - JDFT ansatz</a><a class="headerlink" href="#li2-dimer-and-li-atom-jdft-ansatz" title="Permalink to this heading">¶</a></h2>
<section id="li2-dimer-preparing-a-wave-function">
<span id="turborvbtutorial-0201-01-01"></span><h3><a class="toc-backref" href="#id5" role="doc-backlink">01-01 Li<sub>2</sub> dimer: Preparing a wave function</a><a class="headerlink" href="#li2-dimer-preparing-a-wave-function" title="Permalink to this heading">¶</a></h3>
<p>Prepare Li<sub>2</sub> dimer structure, <a class="reference download internal" download="" href="../../../_downloads/581f37e7ae63d205c5f6447aafbe614c/Li2.xyz"><code class="xref download docutils literal notranslate"><span class="pre">Li2.xyz</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
<span class="n">comment</span> <span class="n">line</span>
    <span class="n">Li</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="o">-</span><span class="mf">2.52589975576638451762</span>
    <span class="n">Li</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="mf">2.52589975576638451762</span>
</pre></div>
</div>
<p>and prepare <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code> and <code class="docutils literal notranslate"><span class="pre">convertfort10mol.input</span></code> and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.input</span>

<span class="p">&amp;</span>system
<span class="nv">posunits</span><span class="o">=</span><span class="s1">&#39;bohr&#39;</span>
<span class="nv">natoms</span><span class="o">=</span><span class="m">2</span>
<span class="nv">ntyp</span><span class="o">=</span><span class="m">1</span>
<span class="nv">pbcfort10</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>electrons
<span class="nv">twobody</span><span class="o">=</span>-15
<span class="nv">twobodypar</span><span class="o">=</span><span class="m">1</span>.00
<span class="nv">onebodypar</span><span class="o">=</span><span class="m">1</span>.00
<span class="nv">no_4body_jas</span><span class="o">=</span>.false.
<span class="nv">neldiff</span><span class="o">=</span><span class="m">0</span>
/

<span class="p">&amp;</span>symmetries
<span class="nv">eqatoms</span><span class="o">=</span>.true.
<span class="nv">rot_det</span><span class="o">=</span>.true.
<span class="nv">symmagp</span><span class="o">=</span>.true.
/

ATOMIC_POSITIONS
<span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span>-2.5259024244810400
<span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">2</span>.5259024244810400
/

ATOM_3
<span class="p">&amp;</span>shells
<span class="nv">nshelldet</span><span class="o">=</span><span class="m">11</span>
<span class="nv">nshelljas</span><span class="o">=</span><span class="m">5</span>
/
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">14</span>.24
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span>.581
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.58
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.564
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07345
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.02805
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.534
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.2749
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07362
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.02403
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.1144
<span class="c1">#  Parameters atomic Jastrow wf</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span>.581
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.58
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.564
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.2749
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07362
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># convertfort10mol.input</span>

<span class="p">&amp;</span>control
<span class="nv">epsdgm</span><span class="o">=</span>-1d-14
/
<span class="p">&amp;</span>mesh_info
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.20
<span class="nv">nx</span><span class="o">=</span><span class="m">64</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">68</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">128</span>
/
<span class="p">&amp;</span>molec_info
<span class="nv">nmol</span><span class="o">=</span><span class="m">3</span>
<span class="nv">nmolmax</span><span class="o">=</span><span class="m">3</span>
<span class="nv">nmolmin</span><span class="o">=</span><span class="m">3</span>
/
</pre></div>
</div>
<p>You may obtain makefort10.input. Next, you can run <code class="docutils literal notranslate"><span class="pre">makefort10.sh</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>./makefort10.sh
</pre></div>
</div>
<p>where,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.sh</span>
kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>makefort10.sh
makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
mv<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
convertfort10mol.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10mol.input<span class="w"> </span>&gt;<span class="w"> </span>out_mol
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
</pre></div>
</div>
<p>The generated wave function <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> is a symmetric Jastrow Antisymmetrized Geminal Power (JsAGPs).</p>
</section>
<section id="li2-dimer-generate-a-trial-wave-function-using-dft">
<span id="turborvbtutorial-0201-01-02"></span><h3><a class="toc-backref" href="#id6" role="doc-backlink">01-02 Li<sub>2</sub> dimer: generate a trial wave function using DFT.</a><a class="headerlink" href="#li2-dimer-generate-a-trial-wave-function-using-dft" title="Permalink to this heading">¶</a></h3>
<p>The next step is to generate a trial wave function using the built-in DFT code.
This is the minimal input file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># prep.input</span>
<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span>-4
<span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="nv">double_mesh</span><span class="o">=</span>.true
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
/
<span class="p">&amp;</span>optimization
<span class="nv">molopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
<span class="p">&amp;</span>molecul
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.2
<span class="nv">ay</span><span class="o">=</span><span class="m">0</span>.2
<span class="nv">az</span><span class="o">=</span><span class="m">0</span>.2
<span class="nv">nx</span><span class="o">=</span><span class="m">64</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">64</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">128</span>
/
<span class="p">&amp;</span>dft
<span class="nv">maxit</span><span class="o">=</span><span class="m">50</span>
<span class="nv">epsdft</span><span class="o">=</span>1d-5
<span class="nv">mixing</span><span class="o">=</span><span class="m">1</span>.0d0
<span class="nv">typedft</span><span class="o">=</span><span class="m">1</span>
<span class="nv">optocc</span><span class="o">=</span><span class="m">0</span>
<span class="nv">nelocc</span><span class="o">=</span><span class="m">3</span>
<span class="nv">l0_at</span><span class="o">=</span><span class="m">0</span>.8320335292207617
<span class="nv">scale_z</span><span class="o">=</span><span class="m">5</span>
<span class="nv">scale_hartree</span><span class="o">=</span>-1.00
<span class="nv">corr_hartree</span><span class="o">=</span>.true.
<span class="nv">linear</span><span class="o">=</span>.false.
/
<span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>Then, you can run DFT by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>prep-serial.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
</pre></div>
</div>
<p>You can optimize one-body Jastrow.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#onebody-script for bash on mac</span>
<span class="nv">b_onebody_list</span><span class="o">=</span><span class="s2">&quot;0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5&quot;</span>

<span class="nv">root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>b_onebody<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$b_onebody_list</span>
<span class="k">do</span>
<span class="w">    </span>mkdir<span class="w"> </span>onebody_<span class="nv">$b_onebody</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>onebody_<span class="nv">$b_onebody</span>
<span class="w">    </span>cp<span class="w"> </span><span class="nv">$root_dir</span>/temp/fort.10<span class="w"> </span>./
<span class="w">    </span>cp<span class="w"> </span><span class="nv">$root_dir</span>/temp/prep.input<span class="w"> </span>./
<span class="w">    </span>gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/b_onebody/</span><span class="nv">$b_onebody</span><span class="s2">/g&quot;</span><span class="w"> </span>fort.10
<span class="w">    </span>prep-serial.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$root_dir</span>
<span class="k">done</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;b_onebody dft energy&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>result.out

<span class="k">for</span><span class="w"> </span>b_onebody<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$b_onebody_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>onebody_<span class="nv">$b_onebody</span>
<span class="w">    </span><span class="nv">energy</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;Final self consistent energy&quot;</span><span class="w"> </span>./out_prep<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $7}&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">b_onebody</span><span class="si">}</span><span class="s2">  </span><span class="si">${</span><span class="nv">energy</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>../result.out
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$root_dir</span>
<span class="k">done</span>
</pre></div>
</div>
<p>You may get</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>result.out
b_onebody<span class="w"> </span>dft<span class="w"> </span>energy
<span class="m">0</span>.5<span class="w">  </span>-14.740030455469444
<span class="m">0</span>.6<span class="w">  </span>-14.746632760686529
<span class="m">0</span>.7<span class="w">  </span>-14.749842736580408
<span class="m">0</span>.8<span class="w">  </span>-14.750834382315727
<span class="m">0</span>.9<span class="w">  </span>-14.750935229881659<span class="w">  </span>&lt;-<span class="w"> </span>the<span class="w"> </span>lowest<span class="w"> </span>one
<span class="m">1</span>.0<span class="w">  </span>-14.750763468915963
<span class="m">1</span>.1<span class="w">  </span>-14.750537472297879
<span class="m">1</span>.2<span class="w">  </span>-14.750319868767475
<span class="m">1</span>.3<span class="w">  </span>-14.750124626530374
<span class="m">1</span>.4<span class="w">  </span>-14.749953844050875
<span class="m">1</span>.5<span class="w">  </span>-14.749807044323163
</pre></div>
</div>
<p>Here, the DFT double-grid integration scheme is employed.</p>
<p><code class="docutils literal notranslate"><span class="pre">l0_at</span></code> The radius where the double-grid is used (Bohr)
<code class="docutils literal notranslate"><span class="pre">scale_z</span></code> The number of grids used for the double grid. Indeed, the grid sizes in the double-grid region are <code class="docutils literal notranslate"><span class="pre">ax/scale_z</span></code>, <code class="docutils literal notranslate"><span class="pre">ay/scale_z</span></code>, and <code class="docutils literal notranslate"><span class="pre">ax/scale_z</span></code>
<code class="docutils literal notranslate"><span class="pre">scale_hartree</span></code>, <code class="docutils literal notranslate"><span class="pre">corr_hartree</span></code>, and <code class="docutils literal notranslate"><span class="pre">linear</span></code> can be default values.</p>
</section>
<section id="li2-dimer-jastrow-factor-optimization-wf-jdft">
<span id="turborvbtutorial-0201-01-03"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink">01-03 Li<sub>2</sub> dimer: Jastrow factor optimization (WF=JDFT)</a><a class="headerlink" href="#li2-dimer-jastrow-factor-optimization-wf-jdft" title="Permalink to this heading">¶</a></h3>
<p>One should refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-02"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>02optimization/
cp<span class="w"> </span>../01trial_wavefunction/02onebody_jastrow_opt/onebody_0.9/fort.10_new<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_dft
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="w"> </span><span class="p">&amp;</span>
rm<span class="w"> </span>-r<span class="w"> </span>turborvb.scratch/
plot_Energy.sh<span class="w"> </span>out_min
plot_devmax.sh<span class="w"> </span>out_min
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 41 10</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>
</pre></div>
</div>
</section>
<section id="li2-dimer-vmc-wf-jdft">
<span id="turborvbtutorial-0201-01-04"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink">01-04 Li<sub>2</sub> dimer: VMC (WF=JDFT)</a><a class="headerlink" href="#li2-dimer-vmc-wf-jdft" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-03"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>03vmc/
cp<span class="w"> </span>../02optimization/fort.10<span class="w"> </span>./
cp<span class="w"> </span>../02optimization/datasmin.input<span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ngen=.*/ngen=1/g&#39;</span><span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/iopt=.*/iopt=1/g&#39;</span><span class="w"> </span>ave.in
<span class="nv">line_num_key</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;unconstrained&quot;</span><span class="w"> </span>-n<span class="w"> </span>fort.10<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line_num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$line_num_key</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line</span><span class="o">=</span><span class="sb">`</span>gsed<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span>p<span class="w"> </span>fort.10<span class="sb">`</span>
<span class="nv">mod_line</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gsed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/0$/ 1/&#39;</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span><span class="s2">d&quot;</span><span class="w"> </span>fort.10
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num_key</span><span class="si">}</span><span class="s2">a </span><span class="nv">$mod_line</span><span class="s2">&quot;</span><span class="w"> </span>fort.10
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
forcevmc.sh<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
cat<span class="w"> </span>pip0.d<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Energy&quot;</span>
...
number<span class="w"> </span>of<span class="w"> </span>bins<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="m">14996</span>
<span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>-14.9757876300445<span class="w">       </span><span class="m">4</span>.853630781726438E-004
Variance<span class="w"> </span><span class="nv">square</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">7</span>.979609547808308E-002<span class="w">  </span><span class="m">2</span>.379635260709342E-004
Est.<span class="w"> </span>energy<span class="w"> </span>error<span class="w"> </span><span class="nv">bar</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">4</span>.748991835467470E-004<span class="w">  </span><span class="m">2</span>.848268581908139E-006
Est.<span class="w"> </span>corr.<span class="w"> </span><span class="nb">time</span><span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">3</span>.39078657629560<span class="w">       </span><span class="m">3</span>.817021016290687E-002
</pre></div>
</div>
<p>VMC (JDFT) = -14.9759(9)  Ha</p>
</section>
<section id="li2-dimer-lrdmc-wf-jdft">
<span id="turborvbtutorial-0201-01-05"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink">01-05 Li<sub>2</sub> dimer: LRDMC (WF=JDFT)</a><a class="headerlink" href="#li2-dimer-lrdmc-wf-jdft" title="Permalink to this heading">¶</a></h3>
<p>One should refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-04"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed explanations and commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasfn.input</span>
<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span>-6
<span class="nv">ngen</span><span class="o">=</span><span class="m">200000</span>
<span class="nv">iopt</span><span class="o">=</span><span class="m">2</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>dmclrdmc
<span class="nv">tbra</span><span class="o">=</span><span class="m">0</span>.1d0
<span class="nv">etry</span><span class="o">=</span>-15.00d0
<span class="nv">alat</span><span class="o">=</span>-0.20
!alat2<span class="o">=</span><span class="m">0</span>.0d0
<span class="nv">iesrandoma</span><span class="o">=</span>.true.
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
</pre></div>
</div>
<p>Here are brief explanations of the variables for a LRDMC calculation:</p>
<p><strong>&amp;dmclrdmc section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">tbra</span></code> projection time (i.e, <span class="math">\exp(-\tau \cdot \hat{\mathcal{H}})</span>). Set 0.1 in general. However, for a heavy element, it is better to choose a smaller value. Please check Average number of survived walkers in <code class="docutils literal notranslate"><span class="pre">out_fn</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Av.<span class="w"> </span>num.<span class="w"> </span>of<span class="w"> </span>survived<span class="w"> </span>walkers/<span class="w"> </span><span class="c1"># walkers in the branching</span>
<span class="m">0</span>.9939
</pre></div>
</div>
<p>if the number is too small, try smaller <code class="docutils literal notranslate"><span class="pre">tbra</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">etry</span></code> Put a DFT of VMC energy. <span class="math">\Gamma</span> in eq.6 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper is set 2 <span class="math">\times</span> <code class="docutils literal notranslate"><span class="pre">etry</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">alat</span></code> The lattice space for discretizing the Hamitonian. If you do a single grid calculation (i.e., alat2=0.0d0), please put a negative value. If you do a double-grid calculation (See. Nakano’s paper), put a positive value and set <code class="docutils literal notranslate"><span class="pre">iesrandoma=.true.</span></code>. This trick is needed for satisfying the detailed-valance condition.</p>
<p><code class="docutils literal notranslate"><span class="pre">alat2</span></code> The corser lattice space used in the double-grid calculation. If you put 0.0d0, TurboRVB does a single grid calculation. If you want to do a double-grid calculation for a compound include Z &gt; 2 element, please comment out alat2 because alat2 is automatically set (See Nakano’s paper).</p>
<p>Prepare different working directories, copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> to each directory, and set the corresponding <code class="docutils literal notranslate"><span class="pre">alat</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alat_0.8Z
alat_1.0Z
alat_1.2Z
alat_1.5Z
</pre></div>
</div>
<p>And then, run each LRDMC calculation after generating initial
electron configurations at the VMC level.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../03lrdmc/
cp<span class="w"> </span>../02vmc/fort.10<span class="w"> </span>.
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.8Z 1.0Z 1.2Z 1.5Z&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/fort.10<span class="w"> </span>./fort.10
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 20 5 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>readf.x
<span class="w">    </span><span class="nv">alat_d</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="nv">alat</span><span class="o">=</span><span class="w"> </span>datasfn.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat_d</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>fort.20<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, $2}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

gsed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in
</pre></div>
</div>
<p>One has collected all LRDMC energis into evsa.in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Z=3 (Li)</span>
<span class="m">2</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span>
<span class="m">0</span>.22222<span class="w"> </span>-14.9907899448815<span class="w">       </span><span class="m">3</span>.101461151525789E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">1</span>.5*Z<span class="o">)</span>
<span class="m">0</span>.27778<span class="w"> </span>-14.9920193657668<span class="w">       </span><span class="m">3</span>.175522770991489E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">1</span>.2*Z<span class="o">)</span>
<span class="m">0</span>.33333<span class="w"> </span>-14.9933364338623<span class="w">       </span><span class="m">3</span>.387085675247969E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">1</span>.0*Z<span class="o">)</span>
<span class="m">0</span>.41667<span class="w"> </span>-14.9969823559963<span class="w">       </span><span class="m">3</span>.650299072111256E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">0</span>.8*Z<span class="o">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">funvsa.x</span></code> is a tool for a quadratic fitting:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>You can see</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Reduced<span class="w"> </span>chi^2<span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.258290367368527
Coefficient<span class="w"> </span>found
<span class="w">         </span><span class="m">1</span><span class="w">  </span>-14.9894036676827<span class="w">       </span><span class="m">1</span>.126607950073031E-003<span class="w">  </span>&lt;-<span class="w"> </span>E_0
<span class="w">         </span><span class="m">2</span><span class="w"> </span>-2.333404434142712E-002<span class="w">  </span><span class="m">2</span>.310746587271902E-002<span class="w">  </span>&lt;-<span class="w"> </span>k_1
<span class="w">         </span><span class="m">3</span><span class="w"> </span>-0.116381701497219<span class="w">       </span><span class="m">0</span>.102032433967512<span class="w">       </span>&lt;-<span class="w"> </span>k_2
</pre></div>
</div>
<dl class="simple">
<dt>Li<sub>2</sub> dimer</dt><dd><ul class="simple">
<li><p>HF = -14.8715 Ha</p></li>
<li><p><span class="blue">VMC(JDFT)   = -14.9759(9) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JDFT) = -14.9894(11) Ha</span></p></li>
<li><p>Exact = -14.9951 Ha</p></li>
</ul>
</dd>
</dl>
</section>
<section id="li-atom-preparation-of-a-wave-function">
<span id="turborvbtutorial-0201-01-06"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">01-06 Li atom: preparation of a wave function</a><a class="headerlink" href="#li-atom-preparation-of-a-wave-function" title="Permalink to this heading">¶</a></h3>
<p>and prepare <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code> and <code class="docutils literal notranslate"><span class="pre">convertfort10mol.input</span></code> and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.input</span>

<span class="p">&amp;</span>system
<span class="nv">posunits</span><span class="o">=</span><span class="s1">&#39;bohr&#39;</span>
<span class="nv">natoms</span><span class="o">=</span><span class="m">1</span>
<span class="nv">ntyp</span><span class="o">=</span><span class="m">1</span>
<span class="nv">pbcfort10</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>electrons
<span class="nv">twobody</span><span class="o">=</span>-15
<span class="nv">twobodypar</span><span class="o">=</span><span class="m">1</span>.00
<span class="nv">onebodypar</span><span class="o">=</span><span class="m">0</span>.90
<span class="nv">no_4body_jas</span><span class="o">=</span>.false.
<span class="nv">neldiff</span><span class="o">=</span><span class="m">1</span><span class="w">  </span>!!<span class="w"> </span>unpaired<span class="w"> </span>electrons
/

<span class="p">&amp;</span>symmetries
<span class="nv">eqatoms</span><span class="o">=</span>.true.
<span class="nv">rot_det</span><span class="o">=</span>.true.
<span class="nv">symmagp</span><span class="o">=</span>.true.
/

ATOMIC_POSITIONS
<span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000
/

ATOM_3
<span class="p">&amp;</span>shells
<span class="nv">nshelldet</span><span class="o">=</span><span class="m">11</span>
<span class="nv">nshelljas</span><span class="o">=</span><span class="m">5</span>
/
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">14</span>.24
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span>.581
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.58
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.564
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07345
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.02805
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.534
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.2749
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07362
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.02403
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.1144
<span class="c1">#  Parameters atomic Jastrow wf</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span>.581
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.58
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.564
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.2749
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07362
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># convertfort10mol.input</span>

<span class="p">&amp;</span>control
<span class="nv">epsdgm</span><span class="o">=</span>-1d-14
/
<span class="p">&amp;</span>mesh_info
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.20
<span class="nv">nx</span><span class="o">=</span><span class="m">64</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">64</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">64</span>
/
<span class="p">&amp;</span>molec_info
<span class="nv">nmol</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nmolmax</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nmolmin</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<p>You may obtain makefort10.input. Next, you can run <code class="docutils literal notranslate"><span class="pre">makefort10.sh</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>./makefort10.sh
</pre></div>
</div>
<p>where,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.sh</span>
kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>makefort10.sh
makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
mv<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
convertfort10mol.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10mol.input<span class="w"> </span>&gt;<span class="w"> </span>out_mol
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
</pre></div>
</div>
<p>The generated wave function <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> is a symmetric Jastrow Antisymmetrized Geminal Power (JsAGPs).</p>
</section>
<section id="li-atom-generate-a-trial-wave-function-using-dft">
<span id="turborvbtutorial-0201-01-07"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">01-07 Li atom: generate a trial wave function using DFT.</a><a class="headerlink" href="#li-atom-generate-a-trial-wave-function-using-dft" title="Permalink to this heading">¶</a></h3>
<p>One should refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-01"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>prep-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
</pre></div>
</div>
</section>
<section id="li-atom-jastrow-factor-optimization-wf-jdft">
<span id="turborvbtutorial-0201-01-08"></span><h3><a class="toc-backref" href="#id12" role="doc-backlink">01-08 Li atom: Jastrow factor optimization (WF=JDFT)</a><a class="headerlink" href="#li-atom-jastrow-factor-optimization-wf-jdft" title="Permalink to this heading">¶</a></h3>
<p>One should refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-02"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>02optimization/
cp<span class="w"> </span>../01trial_wavefunction/01DFT/fort.10_new<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_dft
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="w"> </span><span class="p">&amp;</span>
rm<span class="w"> </span>-r<span class="w"> </span>turborvb.scratch/
plot_Energy.sh<span class="w"> </span>out_min
plot_devmax.sh<span class="w"> </span>out_min
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 41 10</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>
</pre></div>
</div>
</section>
<section id="li-atom-vmc-wf-jdft">
<span id="turborvbtutorial-0201-01-09"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">01-09 Li atom: VMC (WF=JDFT)</a><a class="headerlink" href="#li-atom-vmc-wf-jdft" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-03"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>03vmc/
cp<span class="w"> </span>../02optimization/fort.10<span class="w"> </span>./
cp<span class="w"> </span>../02optimization/datasmin.input<span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ngen=.*/ngen=1/g&#39;</span><span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/iopt=.*/iopt=1/g&#39;</span><span class="w"> </span>ave.in
<span class="nv">line_num_key</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;unconstrained&quot;</span><span class="w"> </span>-n<span class="w"> </span>fort.10<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line_num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$line_num_key</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line</span><span class="o">=</span><span class="sb">`</span>gsed<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span>p<span class="w"> </span>fort.10<span class="sb">`</span>
<span class="nv">mod_line</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gsed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/0$/ 1/&#39;</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span><span class="s2">d&quot;</span><span class="w"> </span>fort.10
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num_key</span><span class="si">}</span><span class="s2">a </span><span class="nv">$mod_line</span><span class="s2">&quot;</span><span class="w"> </span>fort.10
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
forcevmc.sh<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
cat<span class="w"> </span>pip0.d
...
number<span class="w"> </span>of<span class="w"> </span>bins<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="m">14996</span>
<span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>-7.47539042703452<span class="w">       </span><span class="m">2</span>.682804200575495E-004
Variance<span class="w"> </span><span class="nv">square</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">2</span>.847683107759093E-002<span class="w">  </span><span class="m">1</span>.295272783812896E-004
Est.<span class="w"> </span>energy<span class="w"> </span>error<span class="w"> </span><span class="nv">bar</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">2</span>.683664075931440E-004<span class="w">  </span><span class="m">1</span>.733280980510503E-006
Est.<span class="w"> </span>corr.<span class="w"> </span><span class="nb">time</span><span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">3</span>.03421296313493<span class="w">       </span><span class="m">3</span>.544802996972372E-002
</pre></div>
</div>
<p>VMC (JDFT) = -14.9759(9)  Ha  (Li<sub>2</sub> dimer)
VMC (JDFT) =  -7.4754(3)  Ha  (Li atom)</p>
<dl class="simple">
<dt>Li<sub>2</sub> dimer</dt><dd><ul class="simple">
<li><p>E<sub>bond</sub> = 38.9 mHa (experiment)</p></li>
<li><p>E<sub>bond</sub> = 25.1 mHa (VMC-JDFT)</p></li>
</ul>
</dd>
</dl>
</section>
<section id="li-atom-lrdmc-wf-jdft">
<span id="turborvbtutorial-0201-01-10"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink">01-10 Li atom: LRDMC (WF=JDFT)</a><a class="headerlink" href="#li-atom-lrdmc-wf-jdft" title="Permalink to this heading">¶</a></h3>
<p>One should refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-04"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../03lrdmc/
cp<span class="w"> </span>../02vmc/fort.10<span class="w"> </span>.
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.8Z 1.0Z 1.2Z 1.5Z&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/fort.10<span class="w"> </span>./fort.10
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 20 5 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>readf.x
<span class="w">    </span><span class="nv">alat_d</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="nv">alat</span><span class="o">=</span><span class="w"> </span>datasfn.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat_d</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>fort.20<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, $2}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

gsed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in
</pre></div>
</div>
<p>One has collected all LRDMC energis into evsa.in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Z=3 (Li)</span>
<span class="m">2</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span>
<span class="m">0</span>.22222<span class="w"> </span>-7.47824129633644<span class="w">       </span><span class="m">1</span>.450042242028465E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">1</span>.5*Z<span class="o">)</span>
<span class="m">0</span>.27778<span class="w"> </span>-7.47833093539214<span class="w">       </span><span class="m">1</span>.562945930953174E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">1</span>.2*Z<span class="o">)</span>
<span class="m">0</span>.33333<span class="w"> </span>-7.47909688312053<span class="w">       </span><span class="m">1</span>.628394384627272E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">1</span>.0*Z<span class="o">)</span>
<span class="m">0</span>.41667<span class="w"> </span>-7.48032309244573<span class="w">       </span><span class="m">1</span>.866069140147947E-004<span class="w">  </span>&lt;-<span class="w"> </span><span class="m">1</span>/<span class="o">(</span><span class="m">0</span>.8*Z<span class="o">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">funvsa.x</span></code> is a tool for a quadratic fitting:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>You can see</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Reduced<span class="w"> </span>chi^2<span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">1</span>.52438473425829
Coefficient<span class="w"> </span>found
<span class="w">         </span><span class="m">1</span><span class="w">  </span>-7.47794022870940<span class="w">       </span><span class="m">5</span>.344739888993537E-004<span class="w">  </span>&lt;-<span class="w"> </span>E_0
<span class="w">         </span><span class="m">2</span><span class="w"> </span>-1.467218812266460E-003<span class="w">  </span><span class="m">1</span>.107590136996555E-002<span class="w">  </span>&lt;-<span class="w"> </span>k_1
<span class="w">         </span><span class="m">3</span><span class="w"> </span>-7.145382242986854E-002<span class="w">  </span><span class="m">4</span>.939621583555785E-002<span class="w">  </span>&lt;-<span class="w"> </span>k_2
</pre></div>
</div>
<dl class="simple">
<dt>Li<sub>2</sub> dimer</dt><dd><ul class="simple">
<li><p><span class="blue">LRDMC(JDFT) = -14.9894(11) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JDFT) = -7.4779(5) Ha</span></p></li>
<li><p>E<sub>bond</sub> = 38.9 mHa (experiment)</p></li>
<li><p>E<sub>bond</sub> = 25.1 mHa (VMC-JDFT)</p></li>
<li><p>E<sub>bond</sub> = 33.6 mHa (LRDMC-JDFT)</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="li2-dimer-and-li-atom-jsd-ansatz">
<span id="turborvbtutorial-0201-02"></span><h2><a class="toc-backref" href="#id15" role="doc-backlink">02 Li<sub>2</sub> dimer and Li atom - JSD ansatz</a><a class="headerlink" href="#li2-dimer-and-li-atom-jsd-ansatz" title="Permalink to this heading">¶</a></h2>
<section id="li2-dimer-and-li-atom-vmc-optimization-wf-jsd">
<span id="turborvbtutorial-0201-02-01"></span><h3><a class="toc-backref" href="#id16" role="doc-backlink">02-01 Li<sub>2</sub> dimer and Li atom: VMC-optimization (WF=JSD)</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jsd" title="Permalink to this heading">¶</a></h3>
<p>One can optimize the determinant part of the JDFT ansatz, the resultant
ansatz is called JSD.
In this case, one does not have to convert the ansatz, just put the
following section in <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code> at the optimization step.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasmin.input for the Li dimer</span>

<span class="p">&amp;</span>optimization
<span class="w">  </span><span class="nv">molopt</span><span class="o">=</span>-1
<span class="w">  </span>...
/

<span class="p">&amp;</span>parameters
<span class="w">  </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iessw</span><span class="o">=</span><span class="m">1</span>
/

<span class="p">&amp;</span>molecul
<span class="w">  </span><span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.10
<span class="w">  </span><span class="nv">ay</span><span class="o">=</span><span class="m">0</span>.10
<span class="w">  </span><span class="nv">az</span><span class="o">=</span><span class="m">0</span>.10
<span class="w">  </span><span class="nv">nx</span><span class="o">=</span><span class="m">150</span>
<span class="w">  </span><span class="nv">ny</span><span class="o">=</span><span class="m">150</span>
<span class="w">  </span><span class="nv">nz</span><span class="o">=</span><span class="m">250</span>
<span class="w">  </span><span class="nv">nmolmin</span><span class="o">=</span><span class="m">3</span>
<span class="w">  </span><span class="nv">nmolmax</span><span class="o">=</span><span class="m">3</span>
/
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasmin.input for the Li atom</span>

<span class="p">&amp;</span>optimization
<span class="w">  </span><span class="nv">molopt</span><span class="o">=</span>-1
<span class="w">  </span>...
/

<span class="p">&amp;</span>parameters
<span class="w">  </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iessw</span><span class="o">=</span><span class="m">1</span>
/

<span class="p">&amp;</span>molecul
<span class="w">  </span><span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.10
<span class="w">  </span><span class="nv">ay</span><span class="o">=</span><span class="m">0</span>.10
<span class="w">  </span><span class="nv">az</span><span class="o">=</span><span class="m">0</span>.10
<span class="w">  </span><span class="nv">nx</span><span class="o">=</span><span class="m">150</span>
<span class="w">  </span><span class="nv">ny</span><span class="o">=</span><span class="m">150</span>
<span class="w">  </span><span class="nv">nz</span><span class="o">=</span><span class="m">150</span>
<span class="w">  </span><span class="nv">nmolmin</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">nmolmax</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-02"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Li2 dimer - vmc opt</span>
cp<span class="w"> </span>../../../01JDFT/01Li2_dimer/03vmc/fort.10<span class="w"> </span>.
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_jdft
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="p">;</span>
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 181 1 0</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Li atom - vmc opt</span>
cp<span class="w"> </span>../../../01JDFT/02Li_atom/03vmc/fort.10<span class="w"> </span>.
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_jdft
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="p">;</span>
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 181 1 0</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-vmc-wf-jsd">
<span id="turborvbtutorial-0201-02-02"></span><h3><a class="toc-backref" href="#id17" role="doc-backlink">02-02 Li<sub>2</sub> dimer and Li atom: VMC (WF=JSD)</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-wf-jsd" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-03"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../02vmc
cp<span class="w"> </span>../01optimization/fort.10<span class="w"> </span>.
cp<span class="w"> </span>../01optimization/datasmin.input<span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ngen=.*/ngen=1/g&#39;</span><span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/iopt=.*/iopt=1/g&#39;</span><span class="w"> </span>ave.in
<span class="nv">line_num_key</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;unconstrained&quot;</span><span class="w"> </span>-n<span class="w"> </span>fort.10<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line_num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$line_num_key</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line</span><span class="o">=</span><span class="sb">`</span>gsed<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span>p<span class="w"> </span>fort.10<span class="sb">`</span>
<span class="nv">mod_line</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gsed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/0$/ 1/&#39;</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span><span class="s2">d&quot;</span><span class="w"> </span>fort.10
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num_key</span><span class="si">}</span><span class="s2">a </span><span class="nv">$mod_line</span><span class="s2">&quot;</span><span class="w"> </span>fort.10
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
forcevmc.sh<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>
cat<span class="w"> </span>pip0.d<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Energy&quot;</span>
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-lrdmc-wf-jsd">
<span id="turborvbtutorial-0201-02-03"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink">02-03 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JSD)</a><a class="headerlink" href="#li2-dimer-and-li-atom-lrdmc-wf-jsd" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-04"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../03lrdmc/
cp<span class="w"> </span>../02vmc/fort.10<span class="w"> </span>.
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.8Z 1.0Z 1.2Z 1.5Z&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/fort.10<span class="w"> </span>./fort.10
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 20 5 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>readf.x
<span class="w">    </span><span class="nv">alat_d</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="nv">alat</span><span class="o">=</span><span class="w"> </span>datasfn.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat_d</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>fort.20<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, $2}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

gsed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in

funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>Finally I got:</p>
<p>Li<sub>2</sub> dimer</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -14.8715 Ha</p></li>
<li><p>VMC(JDFT)   = -14.9759(9) Ha</p></li>
<li><p>LRDMC(JDFT) = -14.9894(11) Ha</p></li>
<li><p><span class="blue">VMC(JSD)   = -14.9803(5) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JSD) = -14.9909(12) Ha</span></p></li>
<li><p>Exact = -14.9951 Ha</p></li>
</ul>
</div></blockquote>
<p>Li atom</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -7.4327 Ha</p></li>
<li><p>VMC(JDFT)   = -7.4754(3) Ha</p></li>
<li><p>LRDMC(JDFT) = -7.4779(5) Ha</p></li>
<li><p><span class="blue">VMC(JSD)   = -7.4769(2) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JSD) = -7.4779(4) Ha</span></p></li>
<li><p>Exact = -7.4781 Ha</p></li>
</ul>
</div></blockquote>
<p>Binding energy</p>
<blockquote>
<div><ul class="simple">
<li><p>E<sub>bond</sub> = 38.9 mHa (experiment)</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="li2-dimer-and-li-atom-jsagps-ansatz">
<span id="turborvbtutorial-0201-03"></span><h2><a class="toc-backref" href="#id19" role="doc-backlink">03 Li<sub>2</sub> dimer and Li atom - JsAGPs ansatz</a><a class="headerlink" href="#li2-dimer-and-li-atom-jsagps-ansatz" title="Permalink to this heading">¶</a></h2>
<p>The procedure is the almost same as in the Hydrogen-dimer tutorial.
Three hybrid-orbitals (<code class="docutils literal notranslate"><span class="pre">nhyb=2</span></code>) were employed here.</p>
<section id="li2-dimer-and-li-atom-conversion-of-wf-wf-jsagps">
<span id="turborvbtutorial-0201-03-01"></span><h3><a class="toc-backref" href="#id20" role="doc-backlink">03-01 Li<sub>2</sub> dimer and Li atom: Conversion of WF (WF=JsAGPs)</a><a class="headerlink" href="#li2-dimer-and-li-atom-conversion-of-wf-wf-jsagps" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-05"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Li2 dimer - conversion</span>
cp<span class="w"> </span>../../../02JSD/01Li2_dimer/02vmc/fort.10<span class="w"> </span>./fort.10_in
cp<span class="w"> </span>../../../01JDFT/01Li2_dimer/01trial_wavefunction/00makefort10/makefort10.input<span class="w"> </span>.
<span class="w"> </span><span class="nv">twobodyjas</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;Parameters Jastrow two body&quot;</span><span class="w"> </span>./fort.10_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
<span class="nv">onebodyjas</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;Parameters Jastrow two body&quot;</span><span class="w"> </span>./fort.10_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $3}&#39;</span><span class="sb">`</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;twobodyjas=</span><span class="si">${</span><span class="nv">twobodyjas</span><span class="si">}</span><span class="s2"> onebodyjas=</span><span class="si">${</span><span class="nv">onebodyjas</span><span class="si">}</span><span class="s2">&quot;</span>

gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;/twobodypar/c\ twobodypar=</span><span class="si">${</span><span class="nv">twobodyjas</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-e<span class="w"> </span><span class="s2">&quot;/onebodypar/c\ onebodypar=</span><span class="si">${</span><span class="nv">onebodyjas</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>makefort10.input

<span class="nv">hyb_line</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;nshelljas&quot;</span><span class="w"> </span>-n<span class="w"> </span>makefort10.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">hyb_line</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$hyb_line</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>

gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">hyb_line</span><span class="si">}</span><span class="s2">i   ndet_hyb=2&quot;</span><span class="w"> </span>makefort10.input

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>./makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out

convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>./convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv
grep<span class="w"> </span><span class="s2">&quot;Overlap square Geminal&quot;</span><span class="w"> </span>out_conv

mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_in<span class="w"> </span>fort.10_new
copyjas.x<span class="w"> </span>&gt;<span class="w"> </span>out_copyjas
cleanfort10.x<span class="w"> </span>&gt;<span class="w"> </span>out_cleanfort10
cp<span class="w"> </span>fort.10_clean<span class="w"> </span>fort.10
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Li atom - conversion</span>
cp<span class="w"> </span>../../../02JSD/02Li_atom/02vmc/fort.10<span class="w"> </span>./fort.10_in
cp<span class="w"> </span>../../../01JDFT/02Li_atom/01trial_wavefunction/00makefort10/makefort10.input<span class="w"> </span>.
<span class="w"> </span><span class="nv">twobodyjas</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;Parameters Jastrow two body&quot;</span><span class="w"> </span>./fort.10_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
<span class="nv">onebodyjas</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;Parameters Jastrow two body&quot;</span><span class="w"> </span>./fort.10_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $3}&#39;</span><span class="sb">`</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;twobodyjas=</span><span class="si">${</span><span class="nv">twobodyjas</span><span class="si">}</span><span class="s2"> onebodyjas=</span><span class="si">${</span><span class="nv">onebodyjas</span><span class="si">}</span><span class="s2">&quot;</span>

gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;/twobodypar/c\ twobodypar=</span><span class="si">${</span><span class="nv">twobodyjas</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-e<span class="w"> </span><span class="s2">&quot;/onebodypar/c\ onebodypar=</span><span class="si">${</span><span class="nv">onebodyjas</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>makefort10.input

<span class="nv">hyb_line</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;nshelljas&quot;</span><span class="w"> </span>-n<span class="w"> </span>makefort10.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">hyb_line</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$hyb_line</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>

gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">hyb_line</span><span class="si">}</span><span class="s2">i   ndet_hyb=2&quot;</span><span class="w"> </span>makefort10.input

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>./makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out

convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>./convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv
grep<span class="w"> </span><span class="s2">&quot;Overlap square Geminal&quot;</span><span class="w"> </span>out_conv

mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_in<span class="w"> </span>fort.10_new
copyjas.x<span class="w"> </span>&gt;<span class="w"> </span>out_copyjas
cleanfort10.x<span class="w"> </span>&gt;<span class="w"> </span>out_cleanfort10
cp<span class="w"> </span>fort.10_clean<span class="w"> </span>fort.10
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-conversion-check-wf-jsagps">
<span id="turborvbtutorial-0201-03-02"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink">03-02 Li<sub>2</sub> dimer and Li atom: conversion check (WF=JsAGPs)</a><a class="headerlink" href="#li2-dimer-and-li-atom-conversion-check-wf-jsagps" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-06"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../02conversion_check/
cp<span class="w"> </span>../01convert_WF_JSD_to_JAGP/fort.10<span class="w"> </span>.
cp<span class="w"> </span>../01convert_WF_JSD_to_JAGP/fort.10_in<span class="w"> </span>fort.10_corr

mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_read<span class="p">;</span>

cat<span class="w"> </span>corrsampling.dat
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-vmc-optimization-wf-jsagps">
<span id="turborvbtutorial-0201-03-03"></span><h3><a class="toc-backref" href="#id22" role="doc-backlink">03-03 Li<sub>2</sub> dimer and Li atom: VMC-optimization (WF=JsAGPs)</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jsagps" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-07"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want to optimized the contraction coefficients, you should put
<code class="docutils literal notranslate"><span class="pre">iesup=1</span></code> in the <code class="docutils literal notranslate"><span class="pre">&amp;parameters</span></code> section. The code optimizes also
contraction coefficients when you put <code class="docutils literal notranslate"><span class="pre">iesup=1</span></code> with <code class="docutils literal notranslate"><span class="pre">itestr4=-4</span></code>
or <code class="docutils literal notranslate"><span class="pre">itestr4=-9</span></code>. When you put <code class="docutils literal notranslate"><span class="pre">iesup=1</span></code> with <code class="docutils literal notranslate"><span class="pre">itestr4=-8</span></code>
or <code class="docutils literal notranslate"><span class="pre">itestr4=-5</span></code>, the code optimizes not only contraction coefficients
but also exponents of basis set.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#copy wavefunction</span>
<span class="nb">cd</span><span class="w"> </span>../03optimization/
cp<span class="w"> </span>../01convert_WF_JSD_to_JAGP/fort.10<span class="w"> </span>.
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_jsd

<span class="c1"># datasmin.input</span>
...
<span class="p">&amp;</span>parameters
<span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="nv">iessw</span><span class="o">=</span><span class="m">1</span>
<span class="nv">iesup</span><span class="o">=</span><span class="m">1</span>
...

<span class="c1"># commands</span>
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="p">;</span>
readalles.x
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 81 1 0</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-vmc-wf-jsagps">
<span id="turborvbtutorial-0201-03-04"></span><h3><a class="toc-backref" href="#id23" role="doc-backlink">03-04 Li<sub>2</sub> dimer and Li atom: VMC (WF=JsAGPs)</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-wf-jsagps" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-08"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../04vmc
cp<span class="w"> </span>../03optimization/fort.10<span class="w"> </span>.
cp<span class="w"> </span>../03optimization/datasmin.input<span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ngen=.*/ngen=1/g&#39;</span><span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/iopt=.*/iopt=1/g&#39;</span><span class="w"> </span>ave.in
<span class="nv">line_num_key</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;unconstrained&quot;</span><span class="w"> </span>-n<span class="w"> </span>fort.10<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line_num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$line_num_key</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line</span><span class="o">=</span><span class="sb">`</span>gsed<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span>p<span class="w"> </span>fort.10<span class="sb">`</span>
<span class="nv">mod_line</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gsed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/0$/ 1/&#39;</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span><span class="s2">d&quot;</span><span class="w"> </span>fort.10
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num_key</span><span class="si">}</span><span class="s2">a </span><span class="nv">$mod_line</span><span class="s2">&quot;</span><span class="w"> </span>fort.10
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
forcevmc.sh<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>
cat<span class="w"> </span>pip0.d<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Energy&quot;</span>
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-lrdmc-wf-jsagps">
<span id="turborvbtutorial-0201-03-05"></span><h3><a class="toc-backref" href="#id24" role="doc-backlink">03-05 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JsAGPs)</a><a class="headerlink" href="#li2-dimer-and-li-atom-lrdmc-wf-jsagps" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-09"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../05lrdmc/
cp<span class="w"> </span>../04vmc/fort.10<span class="w"> </span>.
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.8Z 1.0Z 1.2Z 1.5Z&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/fort.10<span class="w"> </span>./fort.10
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 20 5 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>readf.x
<span class="w">    </span><span class="nv">alat_d</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="nv">alat</span><span class="o">=</span><span class="w"> </span>datasfn.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat_d</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>fort.20<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, $2}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

gsed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in

funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out

cat<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>Finally I got:</p>
<p>Li<sub>2</sub> dimer</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -14.8715 Ha</p></li>
<li><p>VMC(JDFT)   = -14.9759(9) Ha</p></li>
<li><p>LRDMC(JDFT) = -14.9894(11) Ha</p></li>
<li><p>VMC(JSD)   = -14.9803(5) Ha</p></li>
<li><p>LRDMC(JSD) = -14.9909(12) Ha</p></li>
<li><p><span class="blue">VMC(JsAGPs)   = -14.9821(4) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JsAGPs) = -14.991(1) Ha</span></p></li>
<li><p>Exact = -14.9951 Ha</p></li>
</ul>
</div></blockquote>
<p>Li atom</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -7.4327 Ha</p></li>
<li><p>VMC(JDFT)   = -7.4754(3) Ha</p></li>
<li><p>LRDMC(JDFT) = -7.4779(5) Ha</p></li>
<li><p>VMC(JSD)   = -7.4769(2) Ha</p></li>
<li><p>LRDMC(JSD) = -7.4779(4) Ha</p></li>
<li><p><span class="blue">VMC(JsAGPs)   = -7.477(2) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JsAGPs) = -7.4783(4) Ha</span></p></li>
<li><p>Exact = -7.4781 Ha</p></li>
</ul>
</div></blockquote>
<p>Binding energy</p>
<blockquote>
<div><ul class="simple">
<li><p>E<sub>bond</sub> = 38.9 mHa (experiment)</p></li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a real run (i.e., for a peer-reviewed paper), one should optimize variational parameters much more carefully. We recommend that one consult to an expert or a developer of TurboRVB, or carefully read the <a class="reference internal" href="../98_wf_optimization/tutorial.html#turborvbtutorial-98"><span class="std std-ref">98 Wavefuntion optimization</span></a> part.</p>
</div>
</section>
</section>
<section id="li2-dimer-and-li-atom-jagpu-ansatz">
<span id="turborvbtutorial-0201-04"></span><h2><a class="toc-backref" href="#id25" role="doc-backlink">04 Li<sub>2</sub> dimer and Li atom - JAGPu ansatz</a><a class="headerlink" href="#li2-dimer-and-li-atom-jagpu-ansatz" title="Permalink to this heading">¶</a></h2>
<section id="li2-dimer-prepration-of-a-wave-function">
<span id="turborvbtutorial-0201-04-01"></span><h3><a class="toc-backref" href="#id26" role="doc-backlink">04-01 Li<sub>2</sub> dimer: prepration of a wave function</a><a class="headerlink" href="#li2-dimer-prepration-of-a-wave-function" title="Permalink to this heading">¶</a></h3>
<p>As in the JDFT procedure, prepare Li<sub>2</sub> dimer structure,
<a class="reference download internal" download="" href="../../../_downloads/581f37e7ae63d205c5f6447aafbe614c/Li2.xyz"><code class="xref download docutils literal notranslate"><span class="pre">Li2.xyz</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
<span class="n">comment</span> <span class="n">line</span>
    <span class="n">Li</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="o">-</span><span class="mf">2.52589975576638451762</span>
    <span class="n">Li</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="mf">2.52589975576638451762</span>
</pre></div>
</div>
<p>The point is that you should set <code class="docutils literal notranslate"><span class="pre">twobody=-22</span></code> and <code class="docutils literal notranslate"><span class="pre">symmagp=.false.</span></code> in <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.input</span>

<span class="p">&amp;</span>system
<span class="nv">posunits</span><span class="o">=</span><span class="s1">&#39;bohr&#39;</span>
<span class="nv">natoms</span><span class="o">=</span><span class="m">2</span>
<span class="nv">ntyp</span><span class="o">=</span><span class="m">1</span>
<span class="nv">pbcfort10</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>electrons
<span class="nv">twobody</span><span class="o">=</span>-22
<span class="nv">twobodypar</span><span class="o">=</span><span class="m">1</span>.00
<span class="nv">onebodypar</span><span class="o">=</span><span class="m">0</span>.90
<span class="nv">no_4body_jas</span><span class="o">=</span>.false.
<span class="nv">neldiff</span><span class="o">=</span><span class="m">0</span>
/

<span class="p">&amp;</span>symmetries
<span class="nv">eqatoms</span><span class="o">=</span>.true.
<span class="nv">rot_det</span><span class="o">=</span>.true.
<span class="nv">symmagp</span><span class="o">=</span>.false.
/

ATOMIC_POSITIONS
<span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span>-2.5259024244810400
<span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">3</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">0</span>.0000000000000000<span class="w">  </span><span class="m">2</span>.5259024244810400
/

ATOM_3
<span class="p">&amp;</span>shells
<span class="nv">nshelldet</span><span class="o">=</span><span class="m">11</span>
<span class="nv">nshelljas</span><span class="o">=</span><span class="m">5</span>
/
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">14</span>.24
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span>.581
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.58
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.564
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07345
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.02805
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.534
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.2749
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07362
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.02403
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.1144
<span class="c1">#  Parameters atomic Jastrow wf</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span>.581
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.58
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.564
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.2749
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.07362
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># convertfort10mol.input</span>

<span class="p">&amp;</span>control
<span class="nv">epsdgm</span><span class="o">=</span>-1d-14
/
<span class="p">&amp;</span>mesh_info
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.20
<span class="nv">nx</span><span class="o">=</span><span class="m">64</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">64</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">128</span>
/
<span class="p">&amp;</span>molec_info
<span class="nv">nmol</span><span class="o">=</span><span class="m">3</span>
<span class="nv">nmolmax</span><span class="o">=</span><span class="m">3</span>
<span class="nv">nmolmin</span><span class="o">=</span><span class="m">3</span>
/
</pre></div>
</div>
<p>The other procedure is the same. You may obtain makefort10.input. Next, you can run <code class="docutils literal notranslate"><span class="pre">makefort10.sh</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>./makefort10.sh
</pre></div>
</div>
<p>where,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.sh</span>
kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>makefort10.sh
makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
mv<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
convertfort10mol.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10mol.input<span class="w"> </span>&gt;<span class="w"> </span>out_mol
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
</pre></div>
</div>
<p>The generated wave function <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> is a Jastrow Antisymmetrized Geminal Power including a triplet correlation (JAGPu).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want to use a more general spin-dependent Jastrow, i.e., independent parameters for the parallel and opposite spins (<code class="docutils literal notranslate"><span class="pre">twobody</span></code> = <code class="docutils literal notranslate"><span class="pre">-27</span></code>), you should manually put variational parameters for the two-body Jastrow part after generating <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>. Since <code class="docutils literal notranslate"><span class="pre">makefort10.x</span></code> supports only one variable for the two-body part at present, while <code class="docutils literal notranslate"><span class="pre">-27</span></code> has two independent two-body Jastrow variational parameters.</p>
</div>
<p>Indeed, If you want to use a more general spin-dependent Jastrow, whenever you generate a new <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> file, you should replace</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Parameters Jastrow two body</span>
<span class="w">     </span>-2<span class="w">   </span><span class="m">1</span>.00000000000000<span class="w">       </span><span class="m">0</span>.900000000000000
</pre></div>
</div>
<p>in a generated <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Parameters Jastrow two body</span>
<span class="w">         </span>-3<span class="w">   </span><span class="m">1</span>.00000000000000<span class="w">       </span><span class="m">1</span>.00000000000000<span class="w">       </span><span class="m">0</span>.900000000000000
</pre></div>
</div>
<p>If the number of species in a system is more than 1, e.g., LiH, you should also put independent one-body Jastrows. Namely, you should replace</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Parameters Jastrow two body</span>
<span class="w">     </span>-2<span class="w">   </span><span class="m">1</span>.00000000000000<span class="w">       </span><span class="m">0</span>.900000000000000
</pre></div>
</div>
<p>in a generated <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Parameters Jastrow two body</span>
<span class="w">         </span>-4<span class="w">   </span><span class="m">1</span>.00000000000000<span class="w">       </span><span class="m">1</span>.00000000000000<span class="w">       </span><span class="m">0</span>.900000000000000<span class="w">       </span><span class="m">0</span>.900000000000000
</pre></div>
</div>
</section>
<section id="turborvbtutorial-0201-04-02">
<span id="id1"></span><h3><a class="toc-backref" href="#id27" role="doc-backlink">04-02 Li<sub>2</sub> dimer: generate a trial wave function using DFT.</a><a class="headerlink" href="#turborvbtutorial-0201-04-02" title="Permalink to this heading">¶</a></h3>
<p>The next step is to generate a trial wave function using the built-in DFT code.
This is the minimal input file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># prep.input</span>
<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span>-4
<span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="nv">double_mesh</span><span class="o">=</span>.true
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
/
<span class="p">&amp;</span>optimization
<span class="nv">molopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
<span class="p">&amp;</span>molecul
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.2
<span class="nv">ay</span><span class="o">=</span><span class="m">0</span>.2
<span class="nv">az</span><span class="o">=</span><span class="m">0</span>.2
<span class="nv">nx</span><span class="o">=</span><span class="m">64</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">64</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">128</span>
/
<span class="p">&amp;</span>dft
<span class="nv">maxit</span><span class="o">=</span><span class="m">50</span>
<span class="nv">epsdft</span><span class="o">=</span>1d-5
<span class="nv">mixing</span><span class="o">=</span><span class="m">1</span>.0d0
<span class="nv">typedft</span><span class="o">=</span><span class="m">4</span>
<span class="nv">optocc</span><span class="o">=</span><span class="m">1</span><span class="w">  </span>!<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>fix<span class="w"> </span>the<span class="w"> </span>occ.
<span class="nv">l0_at</span><span class="o">=</span><span class="m">1</span>.0
<span class="nv">scale_z</span><span class="o">=</span><span class="m">5</span>
<span class="nv">scale_hartree</span><span class="o">=</span>-1.00
<span class="nv">corr_hartree</span><span class="o">=</span>.true.
<span class="nv">linear</span><span class="o">=</span>.false.
<span class="nv">nxs</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nys</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nzs</span><span class="o">=</span><span class="m">2</span>
<span class="nv">h_field</span><span class="o">=</span><span class="m">1</span>.0d-2
/
<span class="m">1</span><span class="w"> </span>-1<span class="w">     </span>!<span class="w">  </span>&lt;-<span class="w"> </span>magnetic<span class="w"> </span>moment<span class="w"> </span><span class="o">(</span>i.e.,<span class="w"> </span>*<span class="w"> </span>h_field<span class="o">)</span>
</pre></div>
</div>
<p>Then, you can run DFT by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>prep-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
</pre></div>
</div>
</section>
<section id="li2-dimer-check-local-magnetic-moments">
<span id="turborvbtutorial-0201-04-03"></span><h3><a class="toc-backref" href="#id28" role="doc-backlink">04-03 Li<sub>2</sub> dimer: Check local magnetic moments</a><a class="headerlink" href="#li2-dimer-check-local-magnetic-moments" title="Permalink to this heading">¶</a></h3>
<p>You can check the obtained magnetic moments by using plot_orbitals.x</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># copy fort.10</span>
KosukenoMacBook-Pro-2%<span class="w"> </span>cp<span class="w"> </span>../01DFT/fort.10_new<span class="w"> </span>fort.10

<span class="c1"># plot spin density</span>
KosukenoMacBook-Pro-2%<span class="w"> </span>plot_orbitals.x

Number<span class="w"> </span>of<span class="w"> </span>molecular<span class="w"> </span>orbitals<span class="w"> </span>:<span class="w">            </span><span class="m">6</span>
Choose<span class="w"> </span>box<span class="w"> </span>size<span class="w"> </span><span class="o">(</span>x,y,z<span class="o">)</span>
<span class="m">15</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">15</span>
<span class="m">15</span>.0000000000000<span class="w">        </span><span class="m">15</span>.0000000000000<span class="w">        </span><span class="m">15</span>.0000000000000
Choose<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>mesh<span class="w"> </span>points<span class="w"> </span><span class="o">(</span>x,y,z<span class="o">)</span><span class="w"> </span>:
<span class="m">61</span><span class="w"> </span><span class="m">61</span><span class="w"> </span><span class="m">61</span>
<span class="m">61</span><span class="w">          </span><span class="m">61</span><span class="w">          </span><span class="m">61</span>
Choose<span class="w"> </span>orbitals<span class="w"> </span>to<span class="w"> </span>tabulate<span class="w"> </span><span class="o">(</span>possible<span class="w"> </span>answers<span class="w"> </span>all,<span class="w"> </span>partial,<span class="w"> </span>charge,<span class="w"> </span>spin<span class="o">)</span><span class="w"> </span>:
spin
spin
Please<span class="w"> </span>give<span class="w">  </span>the<span class="w"> </span>lowest<span class="w"> </span>molecular<span class="w"> </span>orbital<span class="w"> </span>within<span class="w"> </span><span class="m">1</span><span class="w"> </span>and<span class="w">            </span><span class="m">6</span>
<span class="m">1</span>
Number<span class="w"> </span>of<span class="w"> </span>fully<span class="w"> </span>occupied<span class="w"> </span>molecular<span class="w"> </span>orbital/total<span class="w"> </span>number<span class="w"> </span>occupied<span class="w"> </span>by<span class="w"> </span>up<span class="w"> </span>and<span class="w"> </span>down?
<span class="m">3</span><span class="w"> </span><span class="m">3</span>
Momentum<span class="w"> </span>magnetization<span class="w"> </span>?<span class="w"> </span><span class="o">(</span>unit<span class="w"> </span>2pi/cellscale<span class="o">)</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>

You<span class="w"> </span>may<span class="w"> </span>obtain<span class="w"> </span>--xsf<span class="w"> </span>output_spin000000.xsf.<span class="w"> </span>Depict<span class="w"> </span>it<span class="w"> </span>using<span class="w"> </span>xcrysden:
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># KosukenoMacBook-Pro-2%  xcrysden --xsf output_spin000000.xsf</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/Li2_dft_mag.png"><img alt="../../../_images/Li2_dft_mag.png" class="align-center" src="../../../_images/Li2_dft_mag.png" style="width: 613.0px; height: 370.5px;" /></a>
<p>Thus, one can obtain an AFM trial wavefunction.</p>
</section>
<section id="li2-dimer-and-li-atom-convert-jdft-wf-to-jagpu-one">
<span id="turborvbtutorial-0201-04-04"></span><h3><a class="toc-backref" href="#id29" role="doc-backlink">04-04 Li<sub>2</sub> dimer and Li atom: Convert JDFT WF to JAGPu one</a><a class="headerlink" href="#li2-dimer-and-li-atom-convert-jdft-wf-to-jagpu-one" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p>Next step is to convert the optimized JDFT ansatz to a JAGPu one.
You should check the consistency after conversion.</p>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># conversion of WF (02convert_WF_JDFT_to_JAGP)</span>
cp<span class="w"> </span>../01trial_wavefunction/01DFT/fort.10_new<span class="w"> </span>./fort.10_in
cp<span class="w"> </span>../01trial_wavefunction/00makefort10/makefort10.input<span class="w"> </span>.

<span class="nv">sym_line</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;&amp;symmetries&quot;</span><span class="w"> </span>-n<span class="w"> </span>makefort10.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">sym_line</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$sym_line</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">sym_line</span><span class="si">}</span><span class="s2">i   nosym_contr=.true.&quot;</span><span class="w"> </span>makefort10.input

<span class="nv">hyb_line</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;nshelljas&quot;</span><span class="w"> </span>-n<span class="w"> </span>makefort10.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">hyb_line</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$hyb_line</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">hyb_line</span><span class="si">}</span><span class="s2">i   ndet_hyb=2&quot;</span><span class="w"> </span>makefort10.input

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out
convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10

<span class="c1"># correlated sampling (03conversion_check)</span>
cp<span class="w"> </span>../02convert_WF_JDFT_to_JAGP/fort.10<span class="w"> </span>.
cp<span class="w"> </span>../02convert_WF_JDFT_to_JAGP/fort.10_in<span class="w"> </span>fort.10_corr
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_read
cat<span class="w"> </span>corrsampling.dat

<span class="c1"># Li-dimer</span>

<span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
<span class="w">  </span>reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.149056547E+02<span class="w">     </span><span class="m">0</span>.903277814E-02
<span class="w">  </span>reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.149153980E+02<span class="w">     </span><span class="m">0</span>.890288018E-02
<span class="w">  </span>reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.974326537E-02<span class="w">     </span><span class="m">0</span>.795833755E-03
<span class="w">  </span>Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.993230204E+00<span class="w">     </span><span class="m">0</span>.284523743E-03

<span class="c1"># Li-atom</span>

<span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
<span class="w">  </span>reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468673E-02
<span class="w">  </span>reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468634E-02
<span class="w">  </span>reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.124625377E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
<span class="w">  </span>Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.316227766E-07
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-optimization-wf-jagpu">
<span id="turborvbtutorial-0201-04-05"></span><h3><a class="toc-backref" href="#id30" role="doc-backlink">04-05 Li<sub>2</sub> dimer and Li atom: Optimization (WF=JAGPu)</a><a class="headerlink" href="#li2-dimer-and-li-atom-optimization-wf-jagpu" title="Permalink to this heading">¶</a></h3>
<p>Now that you have obtained a good trial JAGPu wavefunction,
you can optimize its nodal surface at the VMC level.</p>
<p>Then, copy the converted WF.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../02convert_WF_JDFT_to_JAGP/fort.10<span class="w"> </span>./
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_dft
</pre></div>
</div>
<p>Prepare <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>simulation
<span class="w">  </span><span class="nv">itestr4</span><span class="o">=</span>-4
<span class="w">  </span><span class="nv">ngen</span><span class="o">=</span><span class="m">200000</span>
<span class="w">  </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">10800</span>
<span class="w">  </span>!nscra<span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
/
<span class="p">&amp;</span>optimization
<span class="w">  </span><span class="nv">ncg</span><span class="o">=</span><span class="m">2</span>
<span class="w">  </span><span class="nv">nweight</span><span class="o">=</span><span class="m">1000</span>
<span class="w">  </span><span class="nv">nbinr</span><span class="o">=</span><span class="m">10</span>
<span class="w">  </span><span class="nv">iboot</span><span class="o">=</span><span class="m">0</span>
<span class="w">  </span><span class="nv">tpar</span><span class="o">=</span><span class="m">1</span>.5d-1
<span class="w">  </span><span class="nv">parr</span><span class="o">=</span><span class="m">5</span>.0d-3
/
<span class="p">&amp;</span>readio
<span class="w">  </span>!iread<span class="o">=</span><span class="m">3</span>
<span class="w">  </span>!nowrite12<span class="o">=</span>.true.
/
<span class="p">&amp;</span>parameters
<span class="w">  </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iessw</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<p>The difference from datasmin.input in <code class="docutils literal notranslate"><span class="pre">03optimization</span></code> is <code class="docutils literal notranslate"><span class="pre">iessw</span></code>,
because we optimize the determinant part (nodal surface) at this step.</p>
<p>Run a VMC-opt run.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#run vmc-opt</span>
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min

<span class="c1">#average fort.10</span>
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 81 1 0</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>
</pre></div>
</div>
<p>The rest of the procesure (e.g., averaging the variational parameters) is the same.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a real run (i.e., for a peer-reviewed paper), one should optimize variational parameters much more carefully. We recommend that one consult to an expert user or a developer of TurboRVB, or carefully read the <a class="reference internal" href="../98_wf_optimization/tutorial.html#turborvbtutorial-98"><span class="std std-ref">98 Wavefuntion optimization</span></a> part.</p>
</div>
</section>
<section id="li2-dimer-and-li-atom-vmc-and-lrdmc">
<span id="turborvbtutorial-0201-04-06"></span><h3><a class="toc-backref" href="#id31" role="doc-backlink">04-06 Li<sub>2</sub> dimer and Li atom: VMC and LRDMC</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-and-lrdmc" title="Permalink to this heading">¶</a></h3>
<p>VMC and LRDMC procesures are the same as in the JsAGPs case.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># VMC</span>
cp<span class="w"> </span>../04optimization/fort.10<span class="w"> </span>./
cp<span class="w"> </span>../04optimization/datasmin.input<span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ngen=.*/ngen=1/g&#39;</span><span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/iopt=.*/iopt=1/g&#39;</span><span class="w"> </span>ave.in
<span class="nv">line_num_key</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;unconstrained&quot;</span><span class="w"> </span>-n<span class="w"> </span>fort.10<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line_num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$line_num_key</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line</span><span class="o">=</span><span class="sb">`</span>gsed<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span>p<span class="w"> </span>fort.10<span class="sb">`</span>
<span class="nv">mod_line</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gsed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/0$/ 1/&#39;</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span><span class="s2">d&quot;</span><span class="w"> </span>fort.10
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num_key</span><span class="si">}</span><span class="s2">a </span><span class="nv">$mod_line</span><span class="s2">&quot;</span><span class="w"> </span>fort.10
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
forcevmc.sh<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
cat<span class="w"> </span>pip0.d<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Energy&quot;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#LRDMC</span>
cp<span class="w"> </span>../05vmc/fort.10<span class="w"> </span>.
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.8Z 1.0Z 1.2Z 1.5Z&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/fort.10<span class="w"> </span>./fort.10
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 20 5 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>readf.x
<span class="w">    </span><span class="nv">alat_d</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="nv">alat</span><span class="o">=</span><span class="w"> </span>datasfn.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat_d</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>fort.20<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, $2}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

gsed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in

funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>Li<sub>2</sub> dimer</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -14.8715 Ha</p></li>
<li><p>VMC(JDFT)   = -14.9759(9) Ha</p></li>
<li><p>LRDMC(JDFT) = -14.9894(11) Ha</p></li>
<li><p>VMC(JsAGPs)   = -14.9821(4) Ha</p></li>
<li><p>LRDMC(JsAGPs) = -14.991(1) Ha</p></li>
<li><p><span class="blue">VMC(JAGPu)   = -14.9819(5) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JAGPu) = -14.990(1) Ha</span></p></li>
<li><p>Exact = -14.9951 Ha</p></li>
</ul>
</div></blockquote>
<p>Li atom</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -7.4327 Ha</p></li>
<li><p>VMC(JDFT)   = -7.4754(3) Ha</p></li>
<li><p>LRDMC(JDFT) = -7.4779(5) Ha</p></li>
<li><p>VMC(JsAGPs)   = -7.477(2) Ha</p></li>
<li><p>LRDMC(JsAGPs) = -7.4783(4) Ha</p></li>
<li><p><span class="blue">VMC(JAGPu)   = -7.477(3) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JAGPu) = -7.4791(4) Ha</span></p></li>
<li><p>Exact = -7.4781 Ha</p></li>
</ul>
</div></blockquote>
<p>Binding energy</p>
<blockquote>
<div><ul class="simple">
<li><p>E<sub>bond</sub> = 38.9 mHa (experiment)</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="li2-dimer-and-li-atom-jagp-jpf-ansatz">
<span id="turborvbtutorial-0201-05"></span><h2><a class="toc-backref" href="#id32" role="doc-backlink">05 Li<sub>2</sub> dimer and Li atom - JAGP (JPf) ansatz</a><a class="headerlink" href="#li2-dimer-and-li-atom-jagp-jpf-ansatz" title="Permalink to this heading">¶</a></h2>
<section id="spin-unpolarized-case-li2-dimer-convert-jdft-wf-to-jagp-one">
<span id="turborvbtutorial-0201-05-01"></span><h3><a class="toc-backref" href="#id33" role="doc-backlink">05-01 (spin-unpolarized case) Li<sub>2</sub> dimer: Convert JDFT WF to JAGP one</a><a class="headerlink" href="#spin-unpolarized-case-li2-dimer-convert-jdft-wf-to-jagp-one" title="Permalink to this heading">¶</a></h3>
<p>The most important procedure in a Pfaffian calculation is to convert a JDFT or JAGPu
ansatz to JAGP(JPf) ansatz.
Since the JAGP ansatz is a special case of the JPf one,  where only <span class="math">G_{ud}</span> and <span class="math">G_{du}</span> terms are defined as described in the section <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper, the conversion can be realized just by direct substitution. Therefore, the main challenge is to find a reasonable initialization for the two spin-triplet sectors <span class="math">G_{uu}</span> and <span class="math">G_{dd}</span> that are not described in the JAGP and that otherwise have to be set to 0.
There are two possible approaches to convert an ansatz:
<span class="math">\rm(\hspace{.18em}i\hspace{.18em})</span>
for polarized systems, we can build the <span class="math">G_{uu}</span> block of the matrix by using an even number of
<span class="math">\{ \phi_i\}</span> and build an antisymmetric <span class="math">g_{uu}</span>, where the eigenvalues <span class="math">\lambda_k</span> are chosen to be large enough
to occupy certainly  these unpaired states, as in  the standard Slater determinant used
for our initialization.
Again, we emphasize that  this works only for polarized systems.
<span class="math">\rm(\hspace{.08em}ii\hspace{.08em})</span>
The second approach that also works in a spin-unpolarized case is to determine
a standard broken symmetry single determinant ansatz ({it e.g.}, by TurboRVB built-in DFT within the LSDA)  and modify it with a global  spin rotation. Indeed, in the presence of finite local magnetic moments, it is often convenient to rotate the spin moments of the WF in a direction perpendicular to  the spin quantization axis chosen for  our spin-dependent Jastrow factor, {it i.e.}, the <span class="math">z</span> quantization axis. In this way one can obtain reasonable initializations for  <span class="math">G_{uu}</span> and <span class="math">G_{dd}</span>. TurboRVB allows every possible rotation, including an arbitrary small one close to the identity.
A particularly important case is when  a rotation of <span class="math">\pi/2</span> is applied around the <span class="math">y</span> direction. This operation maps <span class="math">|\uparrow \rangle \rightarrow \frac{1} {\sqrt{2}} \left( |  \uparrow \rangle + |\downarrow \rangle \right)   \mbox{ and }  |\downarrow  \rangle  \rightarrow  \frac 1 {\sqrt{2}} \left( | \uparrow  \rangle - |\downarrow \rangle \right).</span> One can convert from a AGP the pairing function that is obtained from a VMC optimization <span class="math">{g_{ud}}(\mathbf{i},\mathbf{j}) = {f_S}({{\mathbf{r}}_i},{{\mathbf{r}}_j})\frac{{\left| { \uparrow  \downarrow } \right\rangle  - \left| { \downarrow  \uparrow } \right\rangle }}{{\sqrt 2 }} + {f_T}({{\mathbf{r}}_i},{{\mathbf{r}}_j})\frac{{\left| { \uparrow  \downarrow } \right\rangle  + \left| { \downarrow  \uparrow } \right\rangle }}{{\sqrt 2 }}</span> to a Pf one <span class="math">{g_{ud}}(\mathbf{i},\mathbf{j}) \to g\left( {\mathbf{i},\mathbf{j}} \right){\text{ }} = {f_S}({{\mathbf{r}}_i},{{\mathbf{r}}_j})\frac{{\left| { \uparrow  \downarrow } \right\rangle  - \left| { \downarrow  \uparrow } \right\rangle }}{{\sqrt 2 }} + {f_T}({{\mathbf{r}}_i},{{\mathbf{r}}_j})\left( {\left| { \uparrow  \uparrow } \right\rangle  - \left| { \downarrow  \downarrow } \right\rangle } \right).</span> This transformation provides a meaningful initialization to the Pfaffian WF that can be  then optimized for reaching the best possible description of the ground state within this ansatz.</p>
<p>The strategy <span class="math">\rm(\hspace{.08em}ii\hspace{.08em})</span> is employed for the Li dimer (i.e., unpolarized case) while <span class="math">\rm(\hspace{.18em}i\hspace{.18em})</span> is employed for the Li atom (i.e., polarized case)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">################</span>
<span class="c1"># Li-dimer, strategy (ii)</span>
<span class="c1">################</span>

<span class="c1"># run VMC for corr. sampling.</span>
cp<span class="w"> </span>../../../04JAGPu/01Li2_dimer/01trial_wavefunction/01DFT/fort.10_new<span class="w"> </span>fort.10_in
cp<span class="w"> </span>fort.10_in<span class="w"> </span>fort.10_dft
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
rm<span class="w"> </span>fort.10

<span class="c1">################</span>
<span class="c1"># convert JDFT -&gt; uncont JAGP</span>
<span class="c1">################</span>

<span class="c1"># convertfort.10</span>
cp<span class="w"> </span>../../../04JAGPu/01Li2_dimer/01trial_wavefunction/00makefort10/makefort10.input<span class="w"> </span>makefort10_agp_uncont.input
makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_agp_uncont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_agp_uncont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out
convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv_agp_uncont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_agp_uncont

<span class="c1"># corr sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_agp_uncont<span class="w"> </span>fort.10_corr
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_dft_agp_uncont.dat
rm<span class="w"> </span>fort.10
cat<span class="w"> </span>corrsampling_dft_agp_uncont.dat

KosukenoMacBook-Pro-2%<span class="w"> </span>cat<span class="w"> </span>corrsampling_dft_agp_uncont.dat
Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468647E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.122986368E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.316227766E-07

<span class="c1">################</span>
<span class="c1"># convert uncont JAGP -&gt; uncont JPf (norotate)</span>
<span class="c1">################</span>

cp<span class="w"> </span>fort.10_agp_uncont<span class="w"> </span>fort.10_in
cp<span class="w"> </span>makefort10_agp_uncont.input<span class="w"> </span>makefort10_pf_uncont.input

vi<span class="w"> </span>makefort10_pf_uncont.input

<span class="p">&amp;</span>system
...
<span class="nv">yes_pfaff</span><span class="o">=</span>.true.

<span class="p">&amp;</span>symmetries
...
<span class="nv">rot_pfaff</span><span class="o">=</span>.false.

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_pf_uncont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_pfaff_uncont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out

convertpfaff.x<span class="w"> </span>norotate

cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_pfaff_uncont

<span class="c1"># corr. sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_pfaff_uncont<span class="w"> </span>fort.10_corr
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_agp_pfaff_uncont.dat
cat<span class="w"> </span>corrsampling_agp_pfaff_uncont.dat

Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468647E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.122986368E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.316227766E-07

<span class="c1">################</span>
<span class="c1"># convert uncont JPf -&gt; cont JPf</span>
<span class="c1">################</span>

cp<span class="w"> </span>fort.10_pfaff_uncont<span class="w"> </span>fort.10_in
cp<span class="w"> </span>makefort10_pf_uncont.input<span class="w"> </span>makefort10_pf_cont.input

vi<span class="w"> </span>makefort10_pf_cont.input

<span class="p">&amp;</span>symmetries
<span class="w">  </span><span class="nv">nosym_contr</span><span class="o">=</span>.true.

ATOM_3
<span class="w">  </span><span class="p">&amp;</span>shells
<span class="w">  </span><span class="nv">nshelldet</span><span class="o">=</span><span class="m">11</span>
<span class="w">  </span><span class="nv">nshelljas</span><span class="o">=</span><span class="m">5</span>
<span class="w">  </span><span class="nv">ndet_hyb</span><span class="o">=</span><span class="m">2</span>

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_pf_cont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_pfaff_cont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out

convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv_pfaff_cont

cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_pfaff_cont
cp<span class="w"> </span>fort.10_pfaff_cont<span class="w"> </span>fort.10_corr

<span class="c1"># corr. sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_dft_pfaff_cont.dat
cat<span class="w"> </span>corrsampling_dft_pfaff_cont.dat
Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468645E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.115194734E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.505322962E-07

<span class="c1">################</span>
<span class="c1"># rotate fort.10</span>
<span class="c1">################</span>
<span class="c1"># rotate by 1/8pi</span>

cp<span class="w"> </span>fort.10_pfaff_cont<span class="w"> </span>fort.10_in
cp<span class="w"> </span>fort.10_pfaff_cont<span class="w"> </span>fort.10_out
convertpfaff.x
-0.125

cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_pfaff_cont_rot

<span class="c1"># clean fort.10</span>
cp<span class="w"> </span>fort.10_pfaff_cont_rot<span class="w"> </span>fort.10
cleanfort10.x
mv<span class="w"> </span>fort.10_clean<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_final
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_corr

<span class="c1"># corr. sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_dft_pfaff_cont_rot.dat
rm<span class="w"> </span>fort.10
cat<span class="w"> </span>corrsampling_dft_pfaff_cont_rot.dat

Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148904372E+02<span class="w">     </span><span class="m">0</span>.936290264E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.769116534E-03<span class="w">     </span><span class="m">0</span>.396919093E-03
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.998728350E+00<span class="w">     </span><span class="m">0</span>.512541253E-03
</pre></div>
</div>
<p>The total energy was a bit lost by the rotation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want to use a more general spin-dependent Jastrow, i.e., independent parameters for the parallel and opposite spins (<code class="docutils literal notranslate"><span class="pre">twobody</span></code> = <code class="docutils literal notranslate"><span class="pre">-27</span></code>), you should manually put variational parameters for the two-body Jastrow part whenever generating a new <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.</p>
</div>
</section>
<section id="spin-polarized-case-li-atom-convert-jdft-wf-to-jagp-one">
<span id="turborvbtutorial-0201-05-02"></span><h3><a class="toc-backref" href="#id34" role="doc-backlink">05-02 (spin-polarized case) Li atom: Convert JDFT WF to JAGP one</a><a class="headerlink" href="#spin-polarized-case-li-atom-convert-jdft-wf-to-jagp-one" title="Permalink to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">################</span>
<span class="c1"># Li-atom, strategy (i)</span>
<span class="c1">################</span>

<span class="c1"># run VMC for corr. sampling.</span>
cp<span class="w"> </span>../../../04JAGPu/02Li_atom/01trial_wavefunction/01DFT/fort.10_new<span class="w"> </span>fort.10_in
cp<span class="w"> </span>fort.10_in<span class="w"> </span>fort.10_dft
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
rm<span class="w"> </span>fort.10

<span class="c1">################</span>
<span class="c1"># convert JDFT -&gt; uncont JAGP</span>
<span class="c1">################</span>

<span class="c1"># convertfort.10</span>
cp<span class="w"> </span>../../../04JAGPu/02Li_atom/01trial_wavefunction/00makefort10/makefort10.input<span class="w"> </span>makefort10_agp_uncont.input
makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_agp_uncont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_agp_uncont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out
convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv_agp_uncont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_agp_uncont

<span class="c1"># corr sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_agp_uncont<span class="w"> </span>fort.10_corr
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_dft_agp_uncont.dat
rm<span class="w"> </span>fort.10
cat<span class="w"> </span>corrsampling_dft_agp_uncont.dat

Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468647E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.122986368E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.316227766E-07

<span class="c1">################</span>
<span class="c1"># convert uncont JAGP -&gt; uncont JPf (norotate)</span>
<span class="c1">################</span>

cp<span class="w"> </span>fort.10_agp_uncont<span class="w"> </span>fort.10_in
cp<span class="w"> </span>makefort10_agp_uncont.input<span class="w"> </span>makefort10_pf_uncont.input

<span class="c1"># makefort10_pf_uncont.input</span>

<span class="p">&amp;</span>system
...
<span class="nv">yes_pfaff</span><span class="o">=</span>.true.

<span class="p">&amp;</span>symmetries
...
<span class="nv">rot_pfaff</span><span class="o">=</span>.false.

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_pf_uncont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_pfaff_uncont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out

convertpfaff.x<span class="w"> </span>norotate
<span class="m">10000</span>

cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_pfaff_uncont

<span class="c1"># corr. sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_pfaff_uncont<span class="w"> </span>fort.10_corr
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_agp_pfaff_uncont.dat
cat<span class="w"> </span>corrsampling_agp_pfaff_uncont.dat

Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468647E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.122986368E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.316227766E-07

<span class="c1">################</span>
<span class="c1"># convert uncont JPf -&gt; cont JPf</span>
<span class="c1">################</span>

cp<span class="w"> </span>fort.10_pfaff_uncont<span class="w"> </span>fort.10_in
cp<span class="w"> </span>makefort10_pf_uncont.input<span class="w"> </span>makefort10_pf_cont.input

<span class="c1"># makefort10_pf_cont.input</span>

<span class="p">&amp;</span>symmetries
<span class="w">  </span><span class="nv">nosym_contr</span><span class="o">=</span>.true.

ATOM_3
<span class="w">  </span><span class="p">&amp;</span>shells
<span class="w">  </span><span class="nv">nshelldet</span><span class="o">=</span><span class="m">11</span>
<span class="w">  </span><span class="nv">nshelljas</span><span class="o">=</span><span class="m">5</span>
<span class="w">  </span><span class="nv">ndet_hyb</span><span class="o">=</span><span class="m">2</span>

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_pf_cont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_pfaff_cont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out

convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv_pfaff_cont

cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_pfaff_cont

<span class="c1"># clean fort.10</span>
cp<span class="w"> </span>fort.10_pfaff_cont<span class="w"> </span>fort.10
cleanfort10.x
mv<span class="w"> </span>fort.10_clean<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_final
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_corr

<span class="c1"># corr. sampling</span>
cp<span class="w"> </span>fort.10_dft<span class="w"> </span>fort.10
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_dft_pfaff_cont.dat
cat<span class="w"> </span>corrsampling_dft_pfaff_cont.dat
Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.148896680E+02<span class="w">     </span><span class="m">0</span>.929468674E-02
reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.148896681E+02<span class="w">     </span><span class="m">0</span>.929468645E-02
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.115194734E-07<span class="w">     </span><span class="m">0</span>.316227766E-07
Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999997E+00<span class="w">     </span><span class="m">0</span>.505322962E-07
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-vmc-optimization-wf-jpf">
<span id="turborvbtutorial-0201-05-03"></span><h3><a class="toc-backref" href="#id35" role="doc-backlink">05-03 Li<sub>2</sub> dimer and Li atom: VMC optimization (WF=JPf)</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-optimization-wf-jpf" title="Permalink to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Li2-dimer</span>
cp<span class="w"> </span>../01convert_WF_JDFT_to_JAGP/fort.10_pfaff_cont_rot<span class="w">  </span>fort.10
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_sav
cp<span class="w"> </span>../01convert_WF_JDFT_to_JAGP/makefort10_pf_cont.input<span class="w"> </span>.

<span class="c1"># Li-atom</span>
cp<span class="w"> </span>../01convert_WF_JDFT_to_JAGP/fort.10_pfaff_cont<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_sav
cp<span class="w"> </span>../01convert_WF_JDFT_to_JAGP/makefort10_pf_cont.input<span class="w"> </span>.

<span class="c1"># Li2-dimer and Li-atom</span>
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="w"> </span><span class="p">&amp;</span>
cleanfort10.x
mv<span class="w"> </span>fort.10_clean<span class="w"> </span>fort.10

<span class="c1"># check convergence</span>
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 1 0 1</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>

<span class="c1"># average</span>
readalles.x<span class="w"> </span><span class="s">&lt;&lt; ____EOS</span>
<span class="s">1 81 1 0</span>
<span class="s">0</span>
<span class="s">1000</span>
<span class="s">____EOS</span>

!!<span class="w"> </span>If<span class="w"> </span>you<span class="w"> </span>find<span class="w"> </span>many<span class="w"> </span>War<span class="w"> </span><span class="k">in</span><span class="w"> </span>your<span class="w"> </span>output<span class="w"> </span>during<span class="w"> </span>optimization,<span class="w"> </span>!!
!!<span class="w"> </span>please<span class="w"> </span><span class="k">do</span><span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>stabilization,<span class="w"> </span>and<span class="w"> </span><span class="k">continue</span><span class="w"> </span>optimization.<span class="w"> </span>!!

<span class="c1"># Stabilization (especially needed for an open system, Li atom)</span>
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_opt
vi<span class="w"> </span>convertfort10mol.input
<span class="c1"># you should comment out epsdgm=-1d-14 -&gt; !epsdgm=1d-14.</span>
<span class="c1"># If this value is set negative, a generated molecular orbitals are random.</span>
<span class="c1"># You can start from nmolmin=1, until nmolmin=N_el/ 2.</span>
<span class="c1"># and check you do not loose much energy.</span>
convertfort10mol.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10mol.input<span class="w"> </span>&gt;<span class="w"> </span>out_mol_stabilized
cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10

<span class="c1"># Correlated sampling (after the above conversion)</span>
cp<span class="w"> </span>fort.10_in<span class="w"> </span>fort.10_corr
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
mv<span class="w"> </span>corrsampling.dat<span class="w"> </span>corrsampling_pfaff_stabilized.dat
cat<span class="w"> </span>corrsampling_pfaff_stabilized.dat

<span class="c1"># Convert back to a geminal (JAGP)</span>
cp<span class="w"> </span>../01convert_WF_JDFT_to_JAGP/makefort10_pf_cont.input<span class="w"> </span>.
cp<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
<span class="nv">twobodyjas</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;Parameters Jastrow two body&quot;</span><span class="w"> </span>./fort.10_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
<span class="nv">onebodyjas</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;Parameters Jastrow two body&quot;</span><span class="w"> </span>./fort.10_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $3}&#39;</span><span class="sb">`</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;twobodyjas=</span><span class="si">${</span><span class="nv">twobodyjas</span><span class="si">}</span><span class="s2"> onebodyjas=</span><span class="si">${</span><span class="nv">onebodyjas</span><span class="si">}</span><span class="s2">&quot;</span>

gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;/twobodypar/c\ twobodypar=</span><span class="si">${</span><span class="nv">twobodyjas</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-e<span class="w"> </span><span class="s2">&quot;/onebodypar/c\ onebodypar=</span><span class="si">${</span><span class="nv">onebodyjas</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>makefort10_pf_cont.input

makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10_pf_cont.input<span class="w"> </span>&gt;<span class="w"> </span>out_make_pfaff_cont
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out
convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv

cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
cleanfort10.x
mv<span class="w"> </span>fort.10_clean<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_opt<span class="w"> </span>fort.10_new
copyjas.x
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are using a more general spin-dependent Jastrow (i.e., <code class="docutils literal notranslate"><span class="pre">twobody</span></code> = <code class="docutils literal notranslate"><span class="pre">-27</span></code>), you should manually put Jastrow parameters after generating <code class="docutils literal notranslate"><span class="pre">fort.10_out</span></code> by <code class="docutils literal notranslate"><span class="pre">makerfort10.x</span></code>.</p>
</div>
</section>
<section id="li2-dimer-and-li-atom-vmc-wf-jpf">
<span id="turborvbtutorial-0201-05-04"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">05-04 Li<sub>2</sub> dimer and Li atom: VMC (WF=JPf)</a><a class="headerlink" href="#li2-dimer-and-li-atom-vmc-wf-jpf" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-03"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../03vmc
cp<span class="w"> </span>../02optimization/fort.10<span class="w"> </span>.
cp<span class="w"> </span>../02optimization/datasmin.input<span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ngen=.*/ngen=1/g&#39;</span><span class="w"> </span>ave.in
gsed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/iopt=.*/iopt=1/g&#39;</span><span class="w"> </span>ave.in
<span class="nv">line_num_key</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;unconstrained&quot;</span><span class="w"> </span>-n<span class="w"> </span>fort.10<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line_num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="nv">$line_num_key</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="nv">line</span><span class="o">=</span><span class="sb">`</span>gsed<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span>p<span class="w"> </span>fort.10<span class="sb">`</span>
<span class="nv">mod_line</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gsed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/0$/ 1/&#39;</span><span class="sb">`</span>
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num</span><span class="si">}</span><span class="s2">d&quot;</span><span class="w"> </span>fort.10
gsed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line_num_key</span><span class="si">}</span><span class="s2">a </span><span class="nv">$mod_line</span><span class="s2">&quot;</span><span class="w"> </span>fort.10
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
forcevmc.sh<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>
cat<span class="w"> </span>pip0.d<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Energy&quot;</span>
</pre></div>
</div>
</section>
<section id="li2-dimer-and-li-atom-lrdmc-wf-jpf">
<span id="turborvbtutorial-0201-05-05"></span><h3><a class="toc-backref" href="#id37" role="doc-backlink">05-05 Li<sub>2</sub> dimer and Li atom: LRDMC (WF=JPf)</a><a class="headerlink" href="#li2-dimer-and-li-atom-lrdmc-wf-jpf" title="Permalink to this heading">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../01_01Hydrogen_dimer/tutorial.html#turborvbtutorial-0101-04"><span class="std std-ref">Hydrogen tutorial</span></a> for the details.
Here, only needed commands are shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../04lrdmc/
cp<span class="w"> </span>../03vmc/fort.10<span class="w"> </span>.
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.8Z 1.0Z 1.2Z 1.5Z&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/fort.10<span class="w"> </span>./fort.10
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;10 20 5 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>readf.x
<span class="w">    </span><span class="nv">alat_d</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="nv">alat</span><span class="o">=</span><span class="w"> </span>datasfn.input<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat_d</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>fort.20<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, $2}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

gsed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in

funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>Finally I got:</p>
<p>Li<sub>2</sub> dimer</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -14.8715 Ha</p></li>
<li><p>VMC(JDFT)   = -14.9759(9) Ha</p></li>
<li><p>LRDMC(JDFT) = -14.989(1) Ha</p></li>
<li><p>VMC(JsAGPs)   = -14.9821(4) Ha</p></li>
<li><p>LRDMC(JsAGPs) = -14.991(1) Ha</p></li>
<li><p>VMC(JAGPu)   = -14.9819(5) Ha</p></li>
<li><p>LRDMC(JAGPu) = -14.990(1) Ha</p></li>
<li><p><span class="blue">VMC(JAGP)   = -14.9831(4) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JAGP) = -14.993(1) Ha</span></p></li>
<li><p>Exact = -14.9951 Ha</p></li>
</ul>
</div></blockquote>
<p>Li atom</p>
<blockquote>
<div><ul class="simple">
<li><p>HF = -7.4327 Ha</p></li>
<li><p>VMC(JDFT)   = -7.4754(3) Ha</p></li>
<li><p>LRDMC(JDFT) = -7.4779(5) Ha</p></li>
<li><p>VMC(JsAGPs)   = -7.477(2) Ha</p></li>
<li><p>LRDMC(JsAGPs) = -7.4783(4) Ha</p></li>
<li><p>VMC(JAGPu)   = -7.477(3) Ha</p></li>
<li><p>LRDMC(JAGPu) = -7.4791(4) Ha</p></li>
<li><p><span class="blue">VMC(JAGP)   = -7.4766(3) Ha</span></p></li>
<li><p><span class="blue">LRDMC(JAGP) = -7.4784(4) Ha</span></p></li>
<li><p>Exact = -7.4781 Ha</p></li>
</ul>
</div></blockquote>
<p>Binding energy</p>
<blockquote>
<div><ul class="simple">
<li><p>E<sub>bond</sub> = 38.9 mHa (experiment)</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../01_02Hydrogen_dimer/tutorial.html" class="btn btn-neutral float-left" title="01_02Hydrogen_dimer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../98_wf_optimization/tutorial.html" class="btn btn-neutral float-right" title="98 Wavefuntion optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kosuke Nakano (SISSA/JAIST) and collaborators..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>