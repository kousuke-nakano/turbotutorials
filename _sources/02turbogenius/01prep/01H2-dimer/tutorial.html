<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>01Hydrogen_dimer &mdash; Turbotutorials Updated on 03/07/2023 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/roles.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="02Carbon_dimer" href="../02C-dimer/tutorial.html" />
    <link rel="prev" title="Starting from a built-in DFT calculation" href="../00prep_index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Turbotutorials
          </a>
              <div class="version">
                Updated on 03/07/2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../00installation/00installation.html">Installation of packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../01turborvb/00index.html">TurboRVB tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../00index.html">Turbo-Genius tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../00prep_index.html">Starting from a built-in DFT calculation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">01Hydrogen_dimer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#important-introduction-for-turbogenius">00 Important introduction for TurboGenius</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparing-a-jdft-trial-wavefunction">01 Preparing a JDFT trial wavefunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jastrow-factor-optimization-wf-jdft">02 Jastrow factor optimization (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vmc-wf-jdft">03 VMC (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lrdmc-wf-jdft">04 LRDMC (WF=JDFT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lrdmc-wf-jdft-extrapolation">05 LRDMC (WF=JDFT) Extrapolation.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#convert-jdft-wf-to-jagp-one">06 Convert JDFT WF to JAGP one</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-check">07 Conversion check</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nodal-surface-optimization-wf-jsagps">08 Nodal surface optimization (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vmc-wf-jsagps">09 VMC (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lrdmc-wf-jsagps">10 LRDMC (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary">11 Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparing-a-jagp-wavefuction-of-the-h-dimer-with-a-shorter-bond-distance">12 Preparing a JAGP wavefuction of the H dimer with a shorter bond distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">13 Nodal surface optimization (WF=JsAGPs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vmc-before-structural-optimization">14 VMC before structural optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#structural-optimization">15 Structural optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vmc-after-structural-optimization">16 VMC after structural optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../02C-dimer/tutorial.html">02Carbon_dimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../03Hydrogen_chain/tutorial.html">03Hydrogen_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04Diamond_k_pi_pi_pi/tutorial.html">04Diamond with k twist (pi,pi,pi)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05Diamond_twist_average/tutorial.html">05Diamond with k twist average</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06hBN_finite_size_correction/tutorial.html">06h-BN with finite-size extrapolation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../02PySCF/00PySCF_index.html">Starting from a PySCF calculation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../03turboworkflows/00index.html">TurboWorkflows tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Turbotutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../00index.html">Turbo-Genius tutorials</a></li>
          <li class="breadcrumb-item"><a href="../00prep_index.html">Starting from a built-in DFT calculation</a></li>
      <li class="breadcrumb-item active">01Hydrogen_dimer</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/02turbogenius/01prep/01H2-dimer/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hydrogen-dimer">
<span id="turbogeniustutorial-0101"></span><h1><a class="toc-backref" href="#id4" role="doc-backlink">01Hydrogen_dimer</a><a class="headerlink" href="#hydrogen-dimer" title="Permalink to this heading">¶</a></h1>
<p>From this tutorial, you can learn how to calculate all-electron Variational Monte Carlo (VMC) and lattice regularized diffusion Monte Carlo (LRDMC) energies of the H<sub>2</sub> dimer using Turbo-genius. There is also a TurboRVB tutorial, which does the same calculations but without using Turbo-Genius. For detailed information about input parameters in various input files, we recomment visiting that tutorial. You can download all the input and output files for this tutorial from <a class="reference download internal" download="" href="../../../../_downloads/a09f915a1138f5fdddd023504e00465f/file.tar.gz"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#hydrogen-dimer" id="id4">01Hydrogen_dimer</a></p>
<ul>
<li><p><a class="reference internal" href="#important-introduction-for-turbogenius" id="id5">00 Important introduction for TurboGenius</a></p></li>
<li><p><a class="reference internal" href="#preparing-a-jdft-trial-wavefunction" id="id6">01 Preparing a JDFT trial wavefunction</a></p></li>
<li><p><a class="reference internal" href="#jastrow-factor-optimization-wf-jdft" id="id7">02 Jastrow factor optimization (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#vmc-wf-jdft" id="id8">03 VMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#lrdmc-wf-jdft" id="id9">04 LRDMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#lrdmc-wf-jdft-extrapolation" id="id10">05 LRDMC (WF=JDFT) Extrapolation.</a></p></li>
<li><p><a class="reference internal" href="#convert-jdft-wf-to-jagp-one" id="id11">06 Convert JDFT WF to JAGP one</a></p></li>
<li><p><a class="reference internal" href="#conversion-check" id="id12">07 Conversion check</a></p></li>
<li><p><a class="reference internal" href="#nodal-surface-optimization-wf-jsagps" id="id13">08 Nodal surface optimization (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#vmc-wf-jsagps" id="id14">09 VMC (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#lrdmc-wf-jsagps" id="id15">10 LRDMC (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#summary" id="id16">11 Summary</a></p></li>
<li><p><a class="reference internal" href="#preparing-a-jagp-wavefuction-of-the-h-dimer-with-a-shorter-bond-distance" id="id17">12 Preparing a JAGP wavefuction of the H dimer with a shorter bond distance</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id18">13 Nodal surface optimization (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#vmc-before-structural-optimization" id="id19">14 VMC before structural optimization</a></p></li>
<li><p><a class="reference internal" href="#structural-optimization" id="id20">15 Structural optimization</a></p></li>
<li><p><a class="reference internal" href="#vmc-after-structural-optimization" id="id21">16 VMC after structural optimization</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="important-introduction-for-turbogenius">
<span id="turbogeniustutorial-0101-00"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink">00 Important introduction for TurboGenius</a><a class="headerlink" href="#important-introduction-for-turbogenius" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">TurboGenius</span></code> has a very useful command line tool that allows us
to manipulate input and output files very efficiently. One of the most
useful function of the command line tool is its <cite>helper</cite>. To see this, please
try to type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>turbogenius<span class="w"> </span>--help
Usage:<span class="w"> </span>turbogenius<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...

Options:
--help<span class="w">  </span>Show<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span>exit.

Commands:
convertfort10<span class="w">        </span>convertfort10_genius
convertfort10mol<span class="w">     </span>convertfort10mol_genius
convertpfaff<span class="w">         </span>readforward_genius
convertwf<span class="w">            </span>convert<span class="w"> </span>wavefunction
correlated-sampling<span class="w">  </span>correlated_sampling_genius
lrdmc<span class="w">                </span>lrdmc_genius
lrdmcopt<span class="w">             </span>lrdmc_genius
makefort10<span class="w">           </span>makefort10_genius
prep<span class="w">                 </span>prep_genius
vmc<span class="w">                  </span>vmc_genius
vmcopt<span class="w">               </span>vmcopt_genius
</pre></div>
</div>
<p>You can easily see what commands are implemented in <code class="docutils literal notranslate"><span class="pre">TurboGenius</span></code>.
Please type the following command to see what options are implemented for each command,</p>
<p>e.g., vmcopt:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>--help
Usage:<span class="w"> </span>turbogenius<span class="w"> </span>vmcopt<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>

Options:
-post<span class="w">                 </span>Postprocess
-r<span class="w">                    </span>Run<span class="w"> </span>a<span class="w"> </span>program
-g<span class="w">                    </span>Generate<span class="w"> </span>an<span class="w"> </span>input<span class="w"> </span>file
-vmcoptsteps<span class="w"> </span>INTEGER<span class="w">  </span>Specify<span class="w"> </span>vmcoptsteps
-optwarmup<span class="w"> </span>INTEGER<span class="w">    </span>Specify<span class="w"> </span>optwarmupsteps
-steps<span class="w"> </span>INTEGER<span class="w">        </span>Specify<span class="w"> </span>steps<span class="w"> </span>per<span class="w"> </span>one<span class="w"> </span>iteration
-bin<span class="w"> </span>INTEGER<span class="w">          </span>Specify<span class="w"> </span>bin_block
-warmup<span class="w"> </span>INTEGER<span class="w">       </span>Specify<span class="w"> </span>warmupblocks
-nw<span class="w"> </span>INTEGER<span class="w">           </span>Specify<span class="w"> </span>num_walkers
-maxtime<span class="w"> </span>INTEGER<span class="w">      </span>Specify<span class="w"> </span>maxtime
-optimizer<span class="w"> </span>TEXT<span class="w">       </span>Specify<span class="w"> </span>optimizer,<span class="w"> </span>sr<span class="w"> </span>or<span class="w"> </span>lr
-learn<span class="w"> </span>FLOAT<span class="w">          </span>Specify<span class="w"> </span>learning_rate
-reg<span class="w"> </span>FLOAT<span class="w">            </span>Specify<span class="w"> </span>regularization
-opt_onebody<span class="w">          </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_onebody
-opt_twobody<span class="w">          </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_twobody
-opt_det_mat<span class="w">          </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_det_mat
-opt_jas_mat<span class="w">          </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_jas_mat
-opt_det_basis_exp<span class="w">    </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_det_basis_exp
-opt_jas_basis_exp<span class="w">    </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_jas_basis_exp
-opt_det_basis_coeff<span class="w">  </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_det_basis_coeff
-opt_jas_basis_coeff<span class="w">  </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>opt_jas_basis_coeff
-twist<span class="w">                </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>twist_average
-kpts<span class="w"> </span>INTEGER...<span class="w">      </span>kpts,<span class="w"> </span>Specify<span class="w"> </span>Monkhorst-Pack<span class="w"> </span>grids<span class="w"> </span>and<span class="w"> </span>shifts,
<span class="w">                    </span><span class="o">[</span>nkx,nky,nkz,kx,ky,kz<span class="o">]</span>
-plot<span class="w">                 </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>plotting<span class="w"> </span>graph
-log<span class="w"> </span>TEXT<span class="w">             </span>logger<span class="w"> </span>level,<span class="w"> </span>DEBUG,<span class="w"> </span>INFO,<span class="w"> </span>ERROR
--help<span class="w">                </span>Show<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span>exit.
</pre></div>
</div>
<p>e.g.,lrdmc</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>meiwaku20pc06%<span class="w"> </span>turbogenius<span class="w"> </span>lrdmc<span class="w"> </span>--help
Usage:<span class="w"> </span>turbogenius<span class="w"> </span>lrdmc<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>

Options:
-post<span class="w">             </span>Postprocess
-r<span class="w">                </span>Run<span class="w"> </span>a<span class="w"> </span>program
-g<span class="w">                </span>Generate<span class="w"> </span>an<span class="w"> </span>input<span class="w"> </span>file
-steps<span class="w"> </span>INTEGER<span class="w">    </span>Specify<span class="w"> </span>lrdmcsteps
-bin<span class="w"> </span>INTEGER<span class="w">      </span>Specify<span class="w"> </span>bin_block
-corr<span class="w"> </span>INTEGER<span class="w">     </span>Specify<span class="w"> </span>correcting_factor
-alat<span class="w"> </span>FLOAT<span class="w">       </span>Specify<span class="w"> </span>alat
-etry<span class="w"> </span>FLOAT<span class="w">       </span>Specify<span class="w"> </span>etry
-warmup<span class="w"> </span>INTEGER<span class="w">   </span>Specify<span class="w"> </span>warmupblocks
-nw<span class="w"> </span>INTEGER<span class="w">       </span>Specify<span class="w"> </span>num_walkers
-maxtime<span class="w"> </span>INTEGER<span class="w">  </span>Specify<span class="w"> </span>maxtime
-twist<span class="w">            </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>twist_average
-force<span class="w">            </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>force_calc_flag
-nonlocal<span class="w"> </span>TEXT<span class="w">    </span>Specify<span class="w"> </span>nonlocalmoves,<span class="w"> </span>tmove,<span class="w"> </span>dla,<span class="w"> </span>dlatm
-log<span class="w"> </span>TEXT<span class="w">         </span>logger<span class="w"> </span>level,<span class="w"> </span>DEBUG,<span class="w"> </span>INFO,<span class="w"> </span>ERROR
--help<span class="w">            </span>Show<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span>exit.
</pre></div>
</div>
</section>
<section id="preparing-a-jdft-trial-wavefunction">
<span id="turbogeniustutorial-0101-01"></span><h2><a class="toc-backref" href="#id6" role="doc-backlink">01 Preparing a JDFT trial wavefunction</a><a class="headerlink" href="#preparing-a-jdft-trial-wavefunction" title="Permalink to this heading">¶</a></h2>
<section id="preparing-a-makefort10-input-file">
<span id="turbogeniustutorial-0101-01-01"></span><h3>01-01 Preparing a makefort10.input file<a class="headerlink" href="#preparing-a-makefort10-input-file" title="Permalink to this heading">¶</a></h3>
<p>The first step of this tutorial is to generate an antisymmetrized Geminal Power (AGP) ansatz, which will be convert to a Slater determinant (SD) ansatz later. First, one should prepare <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code> to generate an AGP ansatz. The <code class="docutils literal notranslate"><span class="pre">makefort10</span></code> module of Turbo-Genius can be used to generate AGP ansatz. Use the following command to generate a makefort10.input file. Remember that the structure file is also required at this step. Note: If you are interested in a pseudo-potential calculation, please refer to <a class="reference internal" href="../02C-dimer/tutorial.html#turbogeniustutorial-0202"><span class="std std-ref">02Carbon_dimer</span></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>01trial_wavefunction/00makefort10/
turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-g<span class="w"> </span>-str<span class="w"> </span>H2_dimer.xyz<span class="w"> </span>-detbasis<span class="w"> </span>cc-pVTZ<span class="w"> </span>-jasbasis<span class="w"> </span>cc-pVDZ<span class="w"> </span>-detcutbasis<span class="w"> </span>-jascutbasis
</pre></div>
</div>
<p>The command line options:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-j</span></code> is used to specify the job type (like makefort10, prep etc.),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-g</span></code> is used to generate input files. Alternatively <code class="docutils literal notranslate"><span class="pre">-r</span></code> may be used for running calculations and <code class="docutils literal notranslate"><span class="pre">-post</span></code> is used for postprocessing of results after running.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-str</span></code> is used to indicate the structure file name, which could be in several formats: <code class="docutils literal notranslate"><span class="pre">.xyz</span></code>, <code class="docutils literal notranslate"><span class="pre">.cif</span></code>, <code class="docutils literal notranslate"><span class="pre">POSCAR</span></code>, <code class="docutils literal notranslate"><span class="pre">.vasp</span></code>, <code class="docutils literal notranslate"><span class="pre">.xsf</span></code>, or whatever <code class="docutils literal notranslate"><span class="pre">ASE</span></code>’s <code class="docutils literal notranslate"><span class="pre">read</span></code> function supports.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-detbasis</span></code> is used to specify the basis set used to construct atomic orbitals for the determinant part. Here we are using cc-pVTZ type basis set to construct the atomic orbitals. See the –help for checking the basis set currently implemented.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--cutdetbasis</span></code> flag is a command line argument to cut the determinant basis set based on the AZ algorithm (see below) It makes sense only for an all-electron calculation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-jasbasis</span></code> is used to specify the basis set used to construct atomic orbitals for the jastrow part. Here we are using cc-pVTZ type basis set to construct the atomic orbitals. See the –help for checking the basis set currently implemented.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--cutjasbasis</span></code> flag is a command line argument to cut the determinant basis set based on the AZ algorithm (see below) It makes sense only for an all-electron calculation.</p></li>
</ol>
<p>This is a generated <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10 input</span>
<span class="p">&amp;</span>system
<span class="w">    </span><span class="nv">posunits</span><span class="o">=</span><span class="s1">&#39;bohr&#39;</span>
<span class="w">    </span><span class="nv">natoms</span><span class="o">=</span><span class="m">2</span>
<span class="w">    </span><span class="nv">ntyp</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">complexfort10</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">pbcfort10</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">yes_pfaff</span><span class="o">=</span>.false.
<span class="w">    </span>nxyz<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">1</span>
<span class="w">    </span>nxyz<span class="o">(</span><span class="m">2</span><span class="o">)=</span><span class="m">1</span>
<span class="w">    </span>nxyz<span class="o">(</span><span class="m">3</span><span class="o">)=</span><span class="m">1</span>
<span class="w">    </span>phase<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">0</span>.0
<span class="w">    </span>phase<span class="o">(</span><span class="m">2</span><span class="o">)=</span><span class="m">0</span>.0
<span class="w">    </span>phase<span class="o">(</span><span class="m">3</span><span class="o">)=</span><span class="m">0</span>.0
<span class="w">    </span>phasedo<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">0</span>.0
<span class="w">    </span>phasedo<span class="o">(</span><span class="m">2</span><span class="o">)=</span><span class="m">0</span>.0
<span class="w">    </span>phasedo<span class="o">(</span><span class="m">3</span><span class="o">)=</span><span class="m">0</span>.0
/

<span class="p">&amp;</span>electrons
<span class="w">    </span><span class="nv">orbtype</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span>
<span class="w">    </span><span class="nv">jorbtype</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span>
<span class="w">    </span><span class="nv">twobody</span><span class="o">=</span>-6
<span class="w">    </span><span class="nv">filling</span><span class="o">=</span><span class="s1">&#39;diagonal&#39;</span>
<span class="w">    </span><span class="nv">yes_crystal</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">yes_crystalj</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">no_4body_jas</span><span class="o">=</span>.true.
<span class="w">    </span><span class="nv">neldiff</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span>!onebodypar<span class="o">=</span><span class="m">1</span>.0
<span class="w">    </span>twobodypar<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">1</span>.0
<span class="w">    </span>!twobodypar<span class="o">=</span><span class="m">1</span>.0
/

<span class="p">&amp;</span>symmetries
<span class="w">    </span><span class="nv">nosym</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">eqatoms</span><span class="o">=</span>.true.
<span class="w">    </span><span class="nv">rot_det</span><span class="o">=</span>.true.
<span class="w">    </span><span class="nv">symmagp</span><span class="o">=</span>.true.
/

ATOMIC_POSITIONS
<span class="m">1</span>.00000000<span class="w">  </span><span class="m">1</span>.00000000<span class="w">  </span><span class="m">0</span>.00000000000000<span class="w">  </span><span class="m">0</span>.00000000000000<span class="w">  </span>-0.70014352917385
<span class="m">1</span>.00000000<span class="w">  </span><span class="m">1</span>.00000000<span class="w">  </span><span class="m">0</span>.00000000000000<span class="w">  </span><span class="m">0</span>.00000000000000<span class="w">  </span><span class="m">0</span>.70014352917385
/

ATOM_1
<span class="p">&amp;</span>shells
<span class="nv">nshelldet</span><span class="o">=</span><span class="m">7</span>
<span class="nv">nshelljas</span><span class="o">=</span><span class="m">4</span>
/
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.325800000000
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">5</span>.095000000000
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.159000000000
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.102700000000
<span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.407000000000
<span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.388000000000
<span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">37</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.057000000000
<span class="c1"># Parameters atomic Jastrow wf</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">1</span>.962000000000
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.444600000000
<span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.122000000000
<span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="m">1</span><span class="w">   </span><span class="m">0</span>.727000000000
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We have cut first few orbitals from the basis sets for atomic wavefunction as well as for the Jastrow part (<code class="docutils literal notranslate"><span class="pre">nshelldet</span></code> and <code class="docutils literal notranslate"><span class="pre">nshelljas</span></code> should be changed accordingly) by the option <code class="docutils literal notranslate"><span class="pre">-cutbasis</span></code>. The basis set can be automatically cut by using the <code class="docutils literal notranslate"><span class="pre">--cutbasis</span></code> flag as a command line argument while generating the makefort10 input. It cuts the basis set based on the AZ algorithm. An empirical criteria is <span class="math">\eta \ge 8 \times Z^2</span> in the <span class="math">s</span> channel, where <span class="math">Z = \rm{atomic number}</span>. For example, we can discard the topmost <span class="math">\eta = 33.87 \ge 8 \times 1^2</span>. The cut <span class="math">s</span> orbitals are implicitly compensated by the one body Jastrow term  (See <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00295">J. Chem. Theory Comput. 2019, 15, 7, 4044-4055</a> ).</p>
</div>
<p>For explanations of the input variables, please refer to the doc files in the TurboRVB repository.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want to use your own Det. or Jas. basis sets, you can edit <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code> at this step.</p>
</div>
</section>
<section id="generating-a-jagps-template">
<span id="turbogeniustutorial-0101-01-02"></span><h3>01-02 Generating a JAGPs template<a class="headerlink" href="#generating-a-jagps-template" title="Permalink to this heading">¶</a></h3>
<p>One can generate a JAGPs template using the prepared makefort10.input by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-r<span class="w">         </span><span class="c1"># ``-r`` for running calculations</span>
turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-post<span class="w">      </span><span class="c1"># ``-post`` for post-analysis or cleanup</span>

<span class="c1"># Note: the corresponding TurboRVB commands:</span>
makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make<span class="w">  </span><span class="c1"># turbogenius makefort10 -r</span>
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10<span class="w">                      </span><span class="c1"># turbogenius makefort10 -post</span>
</pre></div>
</div>
<p>You can also do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-r<span class="w"> </span>-post
</pre></div>
</div>
<p>The generated JAGPs template is the file <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.</p>
<p>At the same time, <code class="docutils literal notranslate"><span class="pre">structure.xsf</span></code> is generated. One can check if the input structure is what you expect.</p>
</section>
<section id="adding-molecular-orbitals-to-the-jagps-template">
<span id="turbogeniustutorial-0101-01-03"></span><h3>01-03 Adding molecular orbitals to the JAGPs template<a class="headerlink" href="#adding-molecular-orbitals-to-the-jagps-template" title="Permalink to this heading">¶</a></h3>
<p>One should convert the generated JAGPs template to Jastrow Slater Determinant (JDFT) one to prepare a trial wavefunction using DFT. This can be done using the <code class="docutils literal notranslate"><span class="pre">convertfort10</span></code> module. Generate an input file for convertfort10mol using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
turbogenius<span class="w"> </span>convertfort10mol<span class="w"> </span>-g
</pre></div>
</div>
<p>convertfort10 mol input will look like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#convertfort10mol.input</span>
<span class="p">&amp;</span>control
<span class="w">    </span><span class="nv">epsdgm</span><span class="o">=</span>-1e-14
/

<span class="p">&amp;</span>mesh_info
<span class="w">    </span><span class="nv">ax</span><span class="o">=</span><span class="m">10</span>
<span class="w">    </span><span class="nv">ay</span><span class="o">=</span><span class="m">10</span>
<span class="w">    </span><span class="nv">az</span><span class="o">=</span><span class="m">10</span>
<span class="w">    </span><span class="nv">nx</span><span class="o">=</span><span class="m">30</span>
<span class="w">    </span><span class="nv">ny</span><span class="o">=</span><span class="m">30</span>
<span class="w">    </span><span class="nv">nz</span><span class="o">=</span><span class="m">30</span>
/

<span class="p">&amp;</span>molec_info
<span class="w">    </span><span class="nv">nmol</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These variables should be set so that the rectangular of (<code class="docutils literal notranslate"><span class="pre">ax</span></code> × <code class="docutils literal notranslate"><span class="pre">nx</span></code>)(<code class="docutils literal notranslate"><span class="pre">ay</span></code> × <code class="docutils literal notranslate"><span class="pre">ny</span></code>)(<code class="docutils literal notranslate"><span class="pre">az</span></code> × <code class="docutils literal notranslate"><span class="pre">nz</span></code>) encloses the molecule, and <code class="docutils literal notranslate"><span class="pre">ax</span></code>, <code class="docutils literal notranslate"><span class="pre">ay</span></code>, and <code class="docutils literal notranslate"><span class="pre">az</span></code> are small enough to be consistent with an electronic scale, typically 0.01 Bohr and 0.10 Bohr for all-electron and pseudo-potential calculations.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>However, the size of grids are not necessarily small here because <code class="docutils literal notranslate"><span class="pre">convertfort10mol.x</span></code> puts random coefficients of molecular orbitals, just for initialization of the coefficients.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">nmol</span></code>, <code class="docutils literal notranslate"><span class="pre">nmolmin</span></code>, <code class="docutils literal notranslate"><span class="pre">nmolmax</span></code>  The numbers of molecular orbitals. When they equals to <span class="math">N/2</span>, where <span class="math">N</span> is the total number of electrons in the system, JAGPs = JDFT.</p>
<p>After preparing <code class="docutils literal notranslate"><span class="pre">convertfort10mol.input</span></code>, run the calculation by typing the following commands to covert <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> (JAGPs) to <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> (JDFT) by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>convertfort10mol<span class="w"> </span>-r
turbogenius<span class="w"> </span>convertfort10mol<span class="w"> </span>-post

<span class="c1"># the corresponding turborvb commands are:</span>
convertfort10mol.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10mol.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv<span class="w">  </span><span class="c1"># turbogenius convertfort10mol -r</span>
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10<span class="w">                                  </span><span class="c1"># turbogenius convertfort10mol -post</span>
</pre></div>
</div>
<p>The new JDFT template is <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>. If you find <code class="docutils literal notranslate"><span class="pre">100000</span></code> (molecular orbital) in fort.10 and it counts <span class="math">N/2</span>, you have successfully converted the JAGPs template to a JDFT one.</p>
</section>
<section id="run-dft">
<span id="turbogeniustutorial-0101-01-04"></span><h3>01-04 Run DFT<a class="headerlink" href="#run-dft" title="Permalink to this heading">¶</a></h3>
<p>As written above, the coefficients of the molecular orbitals generated by <code class="docutils literal notranslate"><span class="pre">convertfort10mol.x</span></code> are random. Indeed, the <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> is just a template file. The next step is to optimize coefficients using a build-in DFT code, called <code class="docutils literal notranslate"><span class="pre">prep.x</span></code>. This is done by using the <code class="docutils literal notranslate"><span class="pre">prep</span></code> module of Turbo-Genius.</p>
<p>Copy the prepared <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> to 01DFT directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../01DFT/
cp<span class="w"> </span>../00makefort10/fort.10<span class="w"> </span>./
</pre></div>
</div>
<p>To generate input for a DFT calculation type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>prep<span class="w"> </span>-g<span class="w"> </span>-grid<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span>-lbox<span class="w"> </span><span class="m">10</span>.0<span class="w"> </span><span class="m">10</span>.0<span class="w"> </span><span class="m">10</span>.0
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-grid</span></code> specifies the numerical grid size (the unit is <code class="docutils literal notranslate"><span class="pre">bohr</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-lbox</span></code> specifies the simulation box size (the unit is <code class="docutils literal notranslate"><span class="pre">bohr</span></code>).</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the generated <code class="docutils literal notranslate"><span class="pre">prep.input</span></code> file, set <code class="docutils literal notranslate"><span class="pre">nelocc</span></code> to 1, indicating a single occupied spatial orbital. The occupation of this orbital is specified at the end of the input file (2 in this case, indicating a paired electrons)</p>
</div>
<p>The generated input file will look like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#prep.input</span>
<span class="p">&amp;</span>simulation
<span class="w">    </span><span class="nv">itestr4</span><span class="o">=</span>-4
<span class="w">    </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">3600</span>
/

<span class="p">&amp;</span>pseudo
/

<span class="p">&amp;</span>vmc
/

<span class="p">&amp;</span>optimization
<span class="w">    </span><span class="nv">molopt</span><span class="o">=</span><span class="m">1</span>
/

<span class="p">&amp;</span>readio
<span class="w">    </span><span class="nv">writescratch</span><span class="o">=</span><span class="m">1</span>
/

<span class="p">&amp;</span>parameters
<span class="w">    </span><span class="nv">yes_kpoints</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>kpoints
/

<span class="p">&amp;</span>molecul
<span class="w">    </span><span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.2
<span class="w">    </span><span class="nv">ay</span><span class="o">=</span><span class="m">0</span>.2
<span class="w">    </span><span class="nv">az</span><span class="o">=</span><span class="m">0</span>.2
<span class="w">    </span><span class="nv">nx</span><span class="o">=</span><span class="m">50</span>
<span class="w">    </span><span class="nv">ny</span><span class="o">=</span><span class="m">50</span>
<span class="w">    </span><span class="nv">nz</span><span class="o">=</span><span class="m">57</span>
/

<span class="p">&amp;</span>dft
<span class="w">    </span><span class="nv">contracted_on</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">maxit</span><span class="o">=</span><span class="m">50</span>
<span class="w">    </span><span class="nv">epsdft</span><span class="o">=</span>1e-05
<span class="w">    </span><span class="nv">mixing</span><span class="o">=</span><span class="m">0</span>.5
<span class="w">    </span><span class="nv">typedft</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">optocc</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">epsshell</span><span class="o">=</span><span class="m">0</span>.01
<span class="w">    </span><span class="nv">memlarge</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">nelocc</span><span class="o">=</span><span class="m">1</span>
/

<span class="m">2</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>One should carefully choose the size and the number of grids in DFT calculation. Grid sizes and the numbers should be set so that the rectangular of (<code class="docutils literal notranslate"><span class="pre">ax</span></code> × <code class="docutils literal notranslate"><span class="pre">nx</span></code>)(<code class="docutils literal notranslate"><span class="pre">ay</span></code> × <code class="docutils literal notranslate"><span class="pre">ny</span></code>)(<code class="docutils literal notranslate"><span class="pre">az</span></code> × <code class="docutils literal notranslate"><span class="pre">nz</span></code>) encloses the molecule, and ax, ay, and az are small enough to be consistent with an electronic scale, typically 0.01 Bohr and 0.10 Bohr for all-electron and pseudo-potential calculations. The so-called double-grid scheme avoids us from using the small size of grid for all-electron calculation. <code class="docutils literal notranslate"><span class="pre">-doublegrid</span></code> option activates this. Please refer to <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00295">J. Chem. Theory Comput. 2019, 15, 7, 4044-4055</a>.</p>
</div>
<p>After preparing <code class="docutils literal notranslate"><span class="pre">prep.input</span></code>, one can start DFT on a local machine:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
prep-serial.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>prep-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
</pre></div>
</div>
<p>If you want to run the job via a job-queuing system, please prepare a job submission script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you submit a job via a queuing system. Please set always the output <code class="docutils literal notranslate"><span class="pre">out_prep</span></code>. <code class="docutils literal notranslate"><span class="pre">Turbo-Genius</span></code> assumes this output name.</p>
</div>
<p>Note that optimized molecular orbitals are written to the file <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code>. Now to check convergence, we can use post-processing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>prep<span class="w"> </span>-post
</pre></div>
</div>
<p>DFT-LDA total energy, the occupations, etc… are written in <code class="docutils literal notranslate"><span class="pre">out_prep</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>Iter<span class="w"> </span>out_prep

Iter,E,xc,corr<span class="w">     </span><span class="m">1</span><span class="w">        </span>-1.1577548<span class="w">        </span>-0.6705818<span class="w">        </span>-0.1023040<span class="w">         </span><span class="m">1</span>.4094156
Iter,E,xc,corr<span class="w">     </span><span class="m">2</span><span class="w">        </span>-1.1408581<span class="w">        </span>-0.6015049<span class="w">        </span>-0.0972514<span class="w">         </span><span class="m">0</span>.0168967
Iter,E,xc,corr<span class="w">     </span><span class="m">3</span><span class="w">        </span>-1.1378899<span class="w">        </span>-0.5764296<span class="w">        </span>-0.0954901<span class="w">         </span><span class="m">0</span>.0029683
Iter,E,xc,corr<span class="w">     </span><span class="m">4</span><span class="w">        </span>-1.1373530<span class="w">        </span>-0.5661320<span class="w">        </span>-0.0947749<span class="w">         </span><span class="m">0</span>.0005369
Iter,E,xc,corr<span class="w">     </span><span class="m">5</span><span class="w">        </span>-1.1372555<span class="w">        </span>-0.5618074<span class="w">        </span>-0.0944771<span class="w">         </span><span class="m">0</span>.0000975
Iter,E,xc,corr<span class="w">     </span><span class="m">6</span><span class="w">        </span>-1.1372385<span class="w">        </span>-0.5600486<span class="w">        </span>-0.0943592<span class="w">         </span><span class="m">0</span>.0000170
Iter,E,xc,corr<span class="w">     </span><span class="m">7</span><span class="w">        </span>-1.1372355<span class="w">        </span>-0.5593173<span class="w">        </span>-0.0943114<span class="w">         </span><span class="m">0</span>.0000030
<span class="c1"># Iterations =     7</span>
</pre></div>
</div>
<p>The generated <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> is used for the following VMC and DMC calculations as its <strong>trial wave function</strong> / <strong>guiding wave function</strong>.</p>
</section>
</section>
<section id="jastrow-factor-optimization-wf-jdft">
<span id="turbogeniustutorial-0101-02"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">02 Jastrow factor optimization (WF=JDFT)</a><a class="headerlink" href="#jastrow-factor-optimization-wf-jdft" title="Permalink to this heading">¶</a></h2>
<p>In this step, Jastrow factors are optimized at the VMC level using <code class="docutils literal notranslate"><span class="pre">vmcopt</span></code> module of Turbo-Genius.</p>
<p>Next, copy the trial wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> generated by the DFT calculation to <code class="docutils literal notranslate"><span class="pre">02optimization</span></code> directory and rename it to <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../../02optimization/
cp<span class="w"> </span>../01trial_wavefunction/01DFT/fort.10_new<span class="w"> </span>fort.10
</pre></div>
</div>
<p>To generate <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code>, which is a minimal input file for a VMC-optimization:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-g<span class="w"> </span>-opt_onebody<span class="w"> </span>-opt_twobody<span class="w"> </span>-opt_jas_mat<span class="w"> </span>-optimizer<span class="w"> </span>lr<span class="w"> </span>-vmcoptsteps<span class="w"> </span><span class="m">100</span><span class="w"> </span>-steps<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
<p>The input file should look something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasmin.input</span>
<span class="p">&amp;</span>simulation
<span class="w">    </span><span class="nv">itestr4</span><span class="o">=</span>-4
<span class="w">    </span><span class="nv">ngen</span><span class="o">=</span><span class="m">1000</span>
<span class="w">    </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">nw</span><span class="o">=</span><span class="m">40</span>
<span class="w">    </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">3600</span>
<span class="w">    </span><span class="nv">disk_io</span><span class="o">=</span><span class="s1">&#39;mpiio&#39;</span>
/

<span class="p">&amp;</span>pseudo
/

<span class="p">&amp;</span>vmc
<span class="w">    </span><span class="nv">epscut</span><span class="o">=</span><span class="m">0</span>.0
/

<span class="p">&amp;</span>optimization
<span class="w">    </span><span class="nv">ncg</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">nweight</span><span class="o">=</span><span class="m">10</span>
<span class="w">    </span><span class="nv">nbinr</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iboot</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">tpar</span><span class="o">=</span><span class="m">0</span>.35
<span class="w">    </span><span class="nv">parr</span><span class="o">=</span><span class="m">0</span>.001
<span class="w">    </span><span class="nv">iesdonebodyoff</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">iesdtwobodyoff</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">twobodyoff</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>readio
/

<span class="p">&amp;</span>parameters
<span class="w">    </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iessw</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">iesup</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">iesm</span><span class="o">=</span><span class="m">0</span>
/

<span class="p">&amp;</span>kpoints
/
</pre></div>
</div>
<p>There is a command-line variable <code class="docutils literal notranslate"><span class="pre">-opt_XXXXX</span></code> which can be used to specify the type of vmc optimization to be used. Currently the following options are implemented:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_onebody</span></code> (default:True): optimize the homogenius and imhomogenius one-body Jastrow part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_twobody</span></code> (default:True): optimize the two-body Jastrow part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_det_mat</span></code> (default:False): optimize the matrix element of the det. part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_jas_mat</span></code> (default:True): optimize the matrix element of the jas. part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_det_basis_exp</span></code> (default:False): optimize the exponents of the det. part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_jas_basis_exp</span></code> (default:False): optimize the exponents of the jas. part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_det_basis_coeff</span></code> (default:False): optimize the coefficients of the det. part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-opt_jas_basis_coeff</span></code> (default:False): optimize the coefficients of the jas. part.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-vmcoptsteps</span></code>: The number of optimization steps</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-steps</span></code>: MCMC steps per optimization step</p></li>
</ol>
</div></blockquote>
<p>You can also specify an optimization algorithm via <code class="docutils literal notranslate"><span class="pre">-optimizer</span></code> command-line variable.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sr</span></code> : Stochastic Reconfiguration method. See <a class="reference external" href="https://doi.org/10.1063/1.2746035">J. Chem. Phys. 127, 014105 (2007)</a> and the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lr</span></code> : Linear method with natural gradients. See <a class="reference external" href="https://doi.org/10.1103/PhysRevB.71.241103">Phys. Rev. B 71, 241103(R) (2005)</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.98.110201">Phys. Rev. Lett. 98, 110201 (2007)</a>, and <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper.</p></li>
</ol>
</div></blockquote>
<p>Now you can launch the VMC optimization:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p>Now for post-processing use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-post<span class="w"> </span>-optwarmup<span class="w"> </span><span class="m">80</span><span class="w"> </span>-plot
<span class="c1"># and then please follow the instructions.</span>

<span class="c1"># the corresponding command in turborvb is</span>
readalles.x
</pre></div>
</div>
<p>It plots energy with the error bars and devmax wrt optimization steps (plot_energy_and_devmax.png).
e.g., eog plot_energy_and_devmax.png</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vmcopt_Energy_devmax.png"><img alt="../../../../_images/vmcopt_Energy_devmax.png" class="align-center" src="../../../../_images/vmcopt_Energy_devmax.png" style="width: 70%;" /></a>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">devmax</span></code> is below the converged criteria of devmax = 4.5, hence we can say the convergence is achieved.</p>
<p>Post-processing performs three important functions:</p>
<ol class="arabic">
<li><p>The parameters of Jastrow were optimized over <span class="math">\frac{ngen}{nweight}</span> iterations. Post-processing plots all the parameters with respect to iterations which is saved in all_parameters_saved. check png files in parameters_graphs directory (e.g., eog parameters_graphs/Parameter_No*_averaged.png). Here, we show the plots of first two parameters:</p>
<a class="reference internal image-reference" href="../../../../_images/parameter_No_1.png"><img alt="../../../../_images/parameter_No_1.png" class="align-center" src="../../../../_images/parameter_No_1.png" style="width: 70%;" /></a>
<a class="reference internal image-reference" href="../../../../_images/parameter_No_2.png"><img alt="../../../../_images/parameter_No_2.png" class="align-center" src="../../../../_images/parameter_No_2.png" style="width: 70%;" /></a>
</li>
<li><p>In the second step post-processing averages optimized variational parameters. In our case, this is done over the last several thousands optimisation steps. If you wish to change the number of <code class="docutils literal notranslate"><span class="pre">-optwarmup</span></code>. The average values of parameters are stored in the file Average_parameters.dat.</p></li>
<li><p>Finally a dummy vmc calculation is done in ave_temp to write these averaged parameters in <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>. The final averaged WF is <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>. The original WF is renamed as <code class="docutils literal notranslate"><span class="pre">fort.10_bak</span></code></p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a real run, one should optimize variational parameters much more carefully. We recommend that one consult to an expert or a developer of TurboRVB.</p>
</div>
</section>
<section id="vmc-wf-jdft">
<span id="turbogeniustutorial-0101-03"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">03 VMC (WF=JDFT)</a><a class="headerlink" href="#vmc-wf-jdft" title="Permalink to this heading">¶</a></h2>
<p>The next step is to run a single-shot VMC calculation, This is done using the <code class="docutils literal notranslate"><span class="pre">vmc</span></code> module of Turbo-Genius.</p>
<p>First, copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> from <code class="docutils literal notranslate"><span class="pre">02optimization</span></code> to <code class="docutils literal notranslate"><span class="pre">03VMC</span></code> and rename it to <code class="docutils literal notranslate"><span class="pre">fort.10</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../03vmc/
cp<span class="w"> </span>../02optimization/fort.10<span class="w"> </span>fort.10
</pre></div>
</div>
<p>Now generate an input file <code class="docutils literal notranslate"><span class="pre">datasvmc.input</span></code> using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmc<span class="w"> </span>-g<span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-force
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-force</span></code> (default:False): It allows us to compute VMC forces.</p>
<p>It should look something like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>simulation
<span class="w">    </span><span class="nv">itestr4</span><span class="o">=</span><span class="m">2</span>
<span class="w">    </span><span class="nv">ngen</span><span class="o">=</span><span class="m">1000</span>
<span class="w">    </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">3600</span>
<span class="w">    </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">disk_io</span><span class="o">=</span><span class="s1">&#39;mpiio&#39;</span>
/

<span class="p">&amp;</span>pseudo
/

<span class="p">&amp;</span>vmc
/

<span class="p">&amp;</span>readio
/

<span class="p">&amp;</span>parameters
<span class="w">    </span><span class="nv">ieskin</span><span class="o">=</span><span class="m">1</span>
/

<span class="p">&amp;</span>kpoints
/
</pre></div>
</div>
<p>Run the VMC calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p>After the VMC run finishes, use post-processing to check the total energy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmc<span class="w"> </span>-post<span class="w"> </span>-bin<span class="w"> </span><span class="m">10</span><span class="w"> </span>-warmup<span class="w"> </span><span class="m">5</span>
</pre></div>
</div>
<p># Note: this corresponds to <code class="docutils literal notranslate"><span class="pre">forces_vmc.sh</span> <span class="pre">10</span> <span class="pre">5</span> <span class="pre">1</span></code></p>
<p>Use the following values in this example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin<span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
init<span class="w"> </span><span class="nv">bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="nv">pulay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>default<span class="o">)</span>

Chosen<span class="w"> </span>values:<span class="w"> </span><span class="nv">bin</span><span class="o">=</span><span class="m">10</span>,<span class="w"> </span><span class="nv">init_bin</span><span class="o">=</span><span class="m">5</span>,<span class="w"> </span><span class="nv">pulay</span><span class="o">=</span><span class="m">1</span>,<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="nv">equil_steps</span><span class="o">=</span><span class="m">50</span>
</pre></div>
</div>
<p>Postprocessing basically does reblocking using the binning technique. Here again post-processing has two modes: manual and interactive. The reblocked total energy and error are written in the file <code class="docutils literal notranslate"><span class="pre">pip0.d</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>cat<span class="w"> </span>pip0.d
<span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>-1.17274455570072<span class="w"> </span><span class="m">6</span>.835811355104208E-004
</pre></div>
</div>
<p>The obtained forces are written in the file <code class="docutils literal notranslate"><span class="pre">forces_vmc.dat</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>cat<span class="w"> </span>forces_vmc.dat
Force<span class="w"> </span>component<span class="w"> </span><span class="m">1</span>
<span class="nv">Force</span><span class="w">   </span><span class="o">=</span><span class="w"> </span>-5.482787285095939E-004<span class="w">  </span><span class="m">8</span>.061798963778890E-003
<span class="m">1</span>.399428140420830E-003
Der<span class="w"> </span><span class="nv">Eloc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-4.043812504378014E-003<span class="w">  </span><span class="m">7</span>.049753081906847E-003
&lt;OH&gt;<span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.958681484345894<span class="w">       </span><span class="m">1</span>.543217777712891E-002
&lt;O&gt;&lt;H&gt;<span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.956933717457959<span class="w">       </span><span class="m">1</span>.515228470654634E-002
<span class="m">2</span>*<span class="o">(</span>&lt;OH&gt;<span class="w"> </span>-<span class="w"> </span>&lt;O&gt;&lt;H&gt;<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">3</span>.495533775868420E-003<span class="w">  </span><span class="m">2</span>.153459465078023E-003
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Force component 1 refers to the <strong>sum</strong> of the forces of the first line (i.e.,  2 1 3 -2 3) in <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>. The first index is the number of force components and the second and third are the nucleus index and the direction (x:1, y:2, z:3 for a positive nucleus index whereas -x:1, -y:2, -z:3 for a negative nucleus index). Indeed, the forces in the z-direction acting on the first and second hydrogen atoms are -2.74e-4 Ha/Bohr and +2.74e-4 Ha/Bohr, respectively. <em>Not</em> -5.48e-4 Ha/Bohr and +5.48e-4 Ha/Bohr.</p>
</div>
</section>
<section id="lrdmc-wf-jdft">
<span id="turbogeniustutorial-0101-04"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink">04 LRDMC (WF=JDFT)</a><a class="headerlink" href="#lrdmc-wf-jdft" title="Permalink to this heading">¶</a></h2>
<p>Lattice regularized diffusion Monte Carlo (LRDMC) is a projection technique that
can improve a trial wavefunction obtained by a DFT calculation or a VMC optimization systematically. Indeed, this method filters out the ground state wavefunction from a given trial wavefunction. See <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.95.100201">the original Casula’s paper</a>, or the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper in detail.</p>
<p>There is the so-called lattice-space error in LRDMC because the Hamiltonian is regularized by allowing electrons hopping with finite step size <code class="docutils literal notranslate"><span class="pre">alat</span></code> (Bohr). Therefore, one should extrapolate energies calculated by several lattice spaces (<code class="docutils literal notranslate"><span class="pre">alat</span></code>) to obtain an unbiased energy (<span class="math">alat \to 0</span>).</p>
<p>Please create each <code class="docutils literal notranslate"><span class="pre">alat</span></code> folder, and copy an optimized <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> from <code class="docutils literal notranslate"><span class="pre">03vmc</span></code> to the current <code class="docutils literal notranslate"><span class="pre">alat</span></code> directory. To generate lrdmc input files for a LRDMC calc.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../04lrdmc/alat_0.20
cp<span class="w"> </span>../../03vmc/fort.10<span class="w"> </span>.
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>lrdmc<span class="w"> </span>-g<span class="w"> </span>-etry<span class="w"> </span>-1.10<span class="w"> </span>-alat<span class="w"> </span>-0.20<span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">etry</span></code> Put an obtained DFT or VMC energy. <span class="math">\Gamma</span> in eq.6 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper is set 2 <span class="math">\times</span> <code class="docutils literal notranslate"><span class="pre">etry</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">alat</span></code> The lattice space for discretizing the Hamiltonian. If you do a single grid calculation (i.e., alat2=0.0d0), please put a negative value. If you do a double-grid calculation (See <a class="reference external" href="https://doi.org/10.1103/PhysRevB.101.155106">the Nakano’s paper</a>), put a positive value and set <code class="docutils literal notranslate"><span class="pre">iesrandoma=.true.</span></code>. This trick is needed for satisfying the detailed-valance condition.</p>
<p>The input file should look something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#datasfn.input</span>
<span class="p">&amp;</span>simulation
<span class="w">    </span><span class="nv">itestr4</span><span class="o">=</span>-6
<span class="w">    </span><span class="nv">ngen</span><span class="o">=</span><span class="m">1000</span>
<span class="w">    </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">disk_io</span><span class="o">=</span><span class="s1">&#39;mpiio&#39;</span>
/

<span class="p">&amp;</span>pseudo
/

<span class="p">&amp;</span>dmclrdmc
<span class="w">    </span><span class="nv">tbra</span><span class="o">=</span><span class="m">0</span>.1
<span class="w">    </span><span class="nv">etry</span><span class="o">=</span>-1.1
<span class="w">    </span><span class="nv">Klrdmc</span><span class="o">=</span><span class="m">0</span>.0
<span class="w">    </span><span class="nv">alat</span><span class="o">=</span>-0.2
<span class="w">    </span><span class="nv">alat2</span><span class="o">=</span><span class="m">0</span>.0
<span class="w">    </span><span class="nv">gamma</span><span class="o">=</span><span class="m">0</span>.0
<span class="w">    </span><span class="nv">parcutg</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">typereg</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">npow</span><span class="o">=</span><span class="m">0</span>.0
/

<span class="p">&amp;</span>readio
/

<span class="p">&amp;</span>parameters
/

<span class="p">&amp;</span>kpoints
/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, Turbo-genius automatically sets double grid calculations for all electron systems with <span class="math">Z &gt; 2</span>, and single-grid otherwise. If you want to do something different, please change the input files manually.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">alat2</span></code> The corser lattice space used in the double-grid calculation. If you put 0.0d0, Turbo does a single grid calculation. If you want to do a double-grid calculation for a compound include Z &gt; 2 element, please comment out <code class="docutils literal notranslate"><span class="pre">alat2</span></code> because <code class="docutils literal notranslate"><span class="pre">alat2</span></code> is automatically set. See <a class="reference external" href="https://doi.org/10.1103/PhysRevB.101.155106">the Nakano’s paper</a>.</p>
<p>Now run the LRDMC calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="w"> </span><span class="c1"># parallel version</span>
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p>For post-processing use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>lrdmc<span class="w"> </span>-post<span class="w"> </span>-bin<span class="w"> </span><span class="m">20</span><span class="w"> </span>-corr<span class="w"> </span><span class="m">3</span><span class="w"> </span>-warmup<span class="w"> </span><span class="m">5</span>
<span class="c1"># This corresponds to forcefn.sh 20 3 5 1</span>
</pre></div>
</div>
<p>Thus, we get <span class="math">E (a=0.20 bohr)</span> = -1.1744(7) Ha.</p>
</section>
<section id="lrdmc-wf-jdft-extrapolation">
<span id="turbogeniustutorial-0101-05"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">05 LRDMC (WF=JDFT) Extrapolation.</a><a class="headerlink" href="#lrdmc-wf-jdft-extrapolation" title="Permalink to this heading">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the hydrogen dimer, extrapolation is not needed because the energies are almost constant in the region. Try to plot evsa.gnu with gnuplot later.</p>
</div>
<p>If you want to extrapolate energies, please collect all LRDMC energies into <code class="docutils literal notranslate"><span class="pre">evsa.in</span></code>, # at 04lrdmc directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preparation of the input files for all alat.</span>
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.10 0.40 0.60&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="nb">cd</span><span class="w"> </span>../04lrdmc/alat_0.10
cp<span class="w"> </span>../../03vmc/fort.10<span class="w"> </span>.
turbogenius<span class="w"> </span>lrdmc<span class="w"> </span>-g<span class="w"> </span>-etry<span class="w"> </span>-1.10<span class="w"> </span>-alat<span class="w"> </span><span class="nv">$alat</span><span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span>
<span class="nb">cd</span><span class="w"> </span><span class="nv">$lrdmc_root_dir</span>
<span class="k">done</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># run the jobs</span>
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.10 0.40 0.60&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="c1"># on a local machine (serial version)</span>
<span class="w">    </span>turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn
<span class="w">    </span><span class="c1"># on a local machine (parallel version)</span>
<span class="w">    </span>mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="w"> </span><span class="c1"># parallel version</span>
<span class="w">    </span><span class="c1"># on a cluster machine (PBS)</span>
<span class="w">    </span>qsub<span class="w"> </span>submit.sh
<span class="w">    </span><span class="c1"># on a cluster machine (Slurm)</span>
<span class="w">    </span>sbatch<span class="w"> </span>submit.sh
<span class="nb">cd</span><span class="w"> </span><span class="nv">$lrdmc_root_dir</span>
<span class="k">done</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extrapolations of the obtained energies</span>
<span class="nv">alat_list</span><span class="o">=</span><span class="s2">&quot;0.10 0.20 0.40 0.60&quot;</span>
<span class="nv">lrdmc_root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>

<span class="nv">num</span><span class="o">=</span><span class="m">0</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="k">for</span><span class="w"> </span>alat<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$alat_list</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>alat_<span class="si">${</span><span class="nv">alat</span><span class="si">}</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="sb">`</span>expr<span class="w"> </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">alat</span><span class="si">}</span><span class="s2"> &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span>grep<span class="w"> </span><span class="s2">&quot;Energy =&quot;</span><span class="w"> </span>pip0_fn.d<span class="w">  </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $3, $4}&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>/evsa.gnu
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">lrdmc_root_dir</span><span class="si">}</span>
<span class="k">done</span>

sed<span class="w"> </span><span class="s2">&quot;1i 1  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in<span class="w">  </span><span class="c1"># linear fitting</span>
sed<span class="w"> </span><span class="s2">&quot;1i 2  </span><span class="si">${</span><span class="nv">num</span><span class="si">}</span><span class="s2">  4  1&quot;</span><span class="w"> </span>evsa.gnu<span class="w"> </span>&gt;<span class="w"> </span>evsa.in<span class="w">  </span><span class="c1"># quadratic fitting</span>

funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out

gnuplot
<span class="c1">#  p &quot;evsa.gnu&quot; u 1:2:3 with yerr</span>
</pre></div>
</div>
<p>It performs a curve fitting for energies vs alat. turbo-genius asks for the degree of polynomial to be used for curve fitting. The result of fitting is written to the file <code class="docutils literal notranslate"><span class="pre">evsa.out</span></code></p>
<p>For a quartic fitting i.e. <span class="math">E(a)=E(0) + k_{1} \cdots a^2 + k_{2} \cdots a^4</span>, the result is like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Reduced<span class="w"> </span>chi^2<span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">8</span>.6591216401279383E-002
Coefficient<span class="w"> </span>found
<span class="m">1</span><span class="w">  </span>-1.1XXXXXXXXXXXXXXXXXXXX<span class="w">        </span><span class="m">3</span>.2386557773931917E-004<span class="w">  </span>&lt;-<span class="w"> </span>E_0
<span class="m">2</span><span class="w">   </span><span class="m">9</span>.6921066460640640E-003<span class="w">   </span><span class="m">1</span>.0580713770253138E-002<span class="w">  </span>&lt;-<span class="w"> </span>k_1
<span class="m">3</span><span class="w">  </span>-4.5430694740357318E-002<span class="w">   </span><span class="m">6</span>.0957893276622911E-002<span class="w">  </span>&lt;-<span class="w"> </span>k_2
</pre></div>
</div>
<p>For a quadratic fitting i.e. <span class="math">E(a)=E(0) + k_{1} \cdots a^2</span>, the result is like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Reduced<span class="w"> </span>chi^2<span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.31499156876147028
Coefficient<span class="w"> </span>found
<span class="m">1</span><span class="w">  </span>-1.1XXXXXXXXXXXXXXXXXXXX<span class="w">   </span><span class="m">2</span>.3072803389120099E-004
<span class="m">2</span><span class="w">   </span><span class="m">1</span>.9281569799385230E-003<span class="w">   </span><span class="m">2</span>.5923005758555885E-003
</pre></div>
</div>
</section>
<section id="convert-jdft-wf-to-jagp-one">
<span id="turbogeniustutorial-0101-06"></span><h2><a class="toc-backref" href="#id11" role="doc-backlink">06 Convert JDFT WF to JAGP one</a><a class="headerlink" href="#convert-jdft-wf-to-jagp-one" title="Permalink to this heading">¶</a></h2>
<p>We have finished all JDFT calculation. The next step is to convert the optimized JDFT ansatz to a JAGPs one.This can be done using <code class="docutils literal notranslate"><span class="pre">convertfort10</span></code> module of Turbo-Genius. Basically, we require two fort.10 files: the JDFT one (that we want to convert) and a JAGPs fort10 file which we will use as a template for conversion. The JDFT one should be named as <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> and the JAGPs one should be named as <code class="docutils literal notranslate"><span class="pre">fort.10_out</span></code>.</p>
<p>Copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> in <code class="docutils literal notranslate"><span class="pre">03VMC</span></code> to <code class="docutils literal notranslate"><span class="pre">05jdft_to_jagp</span></code> and rename it as <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code>, and copy makefort10.input in 01trial_wavefunction/00makefort10 directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../05jdft_to_jagp/
cp<span class="w"> </span>../03vmc/fort.10<span class="w"> </span>.
turbogenius<span class="w"> </span>convertwf<span class="w"> </span>-to<span class="w"> </span>agps
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Here, onebody, twobody, and basis set exponents are read from <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>the original <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> is renamed to <code class="docutils literal notranslate"><span class="pre">fort.10_bak</span></code></p>
</div>
<p>Please check the overlap square in out_conv:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># grep Overlap out_conv</span>
....
Overlap<span class="w"> </span>square<span class="w"> </span>with<span class="w"> </span>no<span class="w"> </span>zero<span class="w">  </span><span class="m">0</span>.9999....
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Overlap</span> <span class="pre">square</span></code> should be close to unity, i.e., if the conversion is perfect, this becomes unity.</p>
<p>The converted WF <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>. This is a JAGPs wavefunction.</p>
<p>The conversion has finished. The obtained JAGPs wavefunction is <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.</p>
</section>
<section id="conversion-check">
<span id="turbogeniustutorial-0101-07"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">07 Conversion check</a><a class="headerlink" href="#conversion-check" title="Permalink to this heading">¶</a></h2>
<p>We recommend you should check if the above conversion was successful.
This can be checked using the so-called correlated sampling method.
Indeed, one can check the difference in energies of WFs using a VMC calculation.</p>
<p>Copy the obtained JAGPs wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>, and the optimized JDFT wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> as <code class="docutils literal notranslate"><span class="pre">fort.10_corr</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../06conversion_check/
cp<span class="w"> </span>../05jdft_to_jagp/fort.10<span class="w"> </span>./fort.10
cp<span class="w"> </span>../05jdft_to_jagp/fort.10_bak<span class="w"> </span>./fort.10_corr
</pre></div>
</div>
<p>Prepare input files using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>correlated-sampling<span class="w"> </span>-g<span class="w"> </span>-steps<span class="w"> </span><span class="m">100</span>
</pre></div>
</div>
<p>For the correlating sampling, we need two input files, for a vmc calculation (i.e., generation of Markov chain) and a correlated sampling itself.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#datasvmc.input</span>
<span class="p">&amp;</span>simulation
<span class="w">    </span><span class="nv">itestr4</span><span class="o">=</span><span class="m">2</span>
<span class="w">    </span><span class="nv">ngen</span><span class="o">=</span><span class="m">100</span>
<span class="w">    </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">3600</span>
<span class="w">    </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">disk_io</span><span class="o">=</span><span class="s1">&#39;mpiio&#39;</span>
/

<span class="p">&amp;</span>pseudo
/

<span class="p">&amp;</span>vmc
/

<span class="p">&amp;</span>readio
<span class="w">    </span><span class="nv">iread</span><span class="o">=</span><span class="m">3</span>
/

<span class="p">&amp;</span>parameters
/

<span class="p">&amp;</span>kpoints
/
</pre></div>
</div>
<p>and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#readforward.input</span>
<span class="p">&amp;</span>simulation
/

<span class="p">&amp;</span>system
/

<span class="p">&amp;</span>corrfun
<span class="w">    </span><span class="nv">bin_length</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">initial_bin</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">correlated_samp</span><span class="o">=</span>.true.
/
</pre></div>
</div>
<p>Now run the calculation using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
readforward-serial.x<span class="w">  </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>readforward-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_readforward
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">corrsampling.dat</span></code> contains the output.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># corrsampling.dat</span>
Energy<span class="w"> </span><span class="o">(</span>fort10<span class="w"> </span>ref.<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-1.17606202<span class="w"> </span>Ha<span class="w"> </span>+-<span class="w"> </span><span class="m">0</span>.00119647941<span class="w"> </span>Ha
Energy<span class="w"> </span><span class="o">(</span>fort10<span class="w"> </span>corr.<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-1.17606265<span class="w"> </span>Ha<span class="w"> </span>+-<span class="w"> </span><span class="m">0</span>.00119634713<span class="w"> </span>Ha
Energy<span class="w"> </span><span class="nv">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>.26299353e-07<span class="w"> </span>Ha<span class="w"> </span>+-<span class="w"> </span><span class="m">2</span>.29651078e-06<span class="w"> </span>Ha
Overlap<span class="w"> </span><span class="nv">square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.999999977<span class="w"> </span>+-<span class="w"> </span><span class="m">6</span>.05288029e-08
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">reweighted</span> <span class="pre">difference</span></code> indicates the difference in energies of the WFs, <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> and <code class="docutils literal notranslate"><span class="pre">fort.10_corr</span></code>. This should be close to zero. <code class="docutils literal notranslate"><span class="pre">Overlap</span> <span class="pre">square</span></code> should be close to unity, i.e., if a conversion is perfect, this becomes unity.</p>
</section>
<section id="nodal-surface-optimization-wf-jsagps">
<span id="turbogeniustutorial-0101-08"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink">08 Nodal surface optimization (WF=JsAGPs)</a><a class="headerlink" href="#nodal-surface-optimization-wf-jsagps" title="Permalink to this heading">¶</a></h2>
<p>In this step, the Jastrow factors and the determinant part are optimized at the VMC level using <code class="docutils literal notranslate"><span class="pre">vmcopt</span></code> module of Turbo-Genius. The procedure is almost the same as in <a class="reference internal" href="#turbogeniustutorial-0101-02"><span class="std std-ref">02 Jastrow factor optimization (WF=JDFT)</span></a>
First of all, copy the converted wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../07optimization/
cp<span class="w"> </span>../05jdft_to_jagp/fort.10<span class="w"> </span>./
</pre></div>
</div>
<p>To generate <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code>, which is a minimal input file for a VMC-optimization use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-g<span class="w"> </span>-opt_onebody<span class="w"> </span>-opt_twobody<span class="w"> </span>-opt_jas_mat<span class="w"> </span>-opt_det_mat<span class="w"> </span>-optimizer<span class="w"> </span>lr<span class="w"> </span>-vmcoptsteps<span class="w"> </span><span class="m">100</span><span class="w"> </span>-steps<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
<p>The input file should look something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>simulation
<span class="w">    </span><span class="nv">itestr4</span><span class="o">=</span>-4
<span class="w">    </span><span class="nv">ngen</span><span class="o">=</span><span class="m">1000</span>
<span class="w">    </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">3600</span>
<span class="w">    </span><span class="nv">disk_io</span><span class="o">=</span><span class="s1">&#39;mpiio&#39;</span>
/

<span class="p">&amp;</span>pseudo
/

<span class="p">&amp;</span>vmc
/

<span class="p">&amp;</span>optimization
<span class="w">    </span><span class="nv">ncg</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">nweight</span><span class="o">=</span><span class="m">10</span>
<span class="w">    </span><span class="nv">nbinr</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iboot</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">tpar</span><span class="o">=</span><span class="m">0</span>.35
<span class="w">    </span><span class="nv">parr</span><span class="o">=</span><span class="m">0</span>.001
<span class="w">    </span><span class="nv">iesdonebodyoff</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">iesdtwobodyoff</span><span class="o">=</span>.false.
<span class="w">    </span><span class="nv">twobodyoff</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>readio
/

<span class="p">&amp;</span>parameters
<span class="w">    </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iessw</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="nv">iesup</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="nv">iesm</span><span class="o">=</span><span class="m">0</span>
/

<span class="p">&amp;</span>kpoints
/
</pre></div>
</div>
<p>Now run VMC optimization using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p>Now for post-processing use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-post<span class="w"> </span>-optwarmup<span class="w"> </span><span class="m">80</span><span class="w"> </span>-plot

<span class="c1"># this corresponds readalles.x</span>
</pre></div>
</div>
<p>It plots energy with the error bars and devmax wrt optimization steps (vmcopt_Energy_devmax.png).</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vmcopt_jsagps_Energy_devmax.png"><img alt="../../../../_images/vmcopt_jsagps_Energy_devmax.png" class="align-center" src="../../../../_images/vmcopt_jsagps_Energy_devmax.png" style="width: 70%;" /></a>
</div></blockquote>
<p>For the hydrogen dimer, the JDFT ansatz is enough accurate, so nothing has gained.</p>
</section>
<section id="vmc-wf-jsagps">
<span id="turbogeniustutorial-0101-09"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">09 VMC (WF=JsAGPs)</a><a class="headerlink" href="#vmc-wf-jsagps" title="Permalink to this heading">¶</a></h2>
<p>The same as in the JDFT case. See <a class="reference internal" href="#turbogeniustutorial-0101-03"><span class="std std-ref">03 VMC (WF=JDFT)</span></a></p>
<p>First, copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> from <code class="docutils literal notranslate"><span class="pre">02optimization</span></code> to <code class="docutils literal notranslate"><span class="pre">08vmc</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../08vmc
cp<span class="w"> </span>../07optimization/fort.10<span class="w"> </span>fort.10
</pre></div>
</div>
<p>Now generate the input file for vmc <code class="docutils literal notranslate"><span class="pre">datasvmc.input</span></code> using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmc<span class="w"> </span>-g<span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
<p>Run a VMC calculation by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p>After the VMC run finishes, use post-processing to check the total energy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>vmc<span class="w"> </span>-post<span class="w"> </span>-bin<span class="w"> </span><span class="m">10</span><span class="w"> </span>-warmup<span class="w"> </span><span class="m">5</span>
<span class="c1"># this corresponds to forcevmc.sh 10 5 1</span>
</pre></div>
</div>
<p>Use the following values in this example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin<span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
init<span class="w"> </span><span class="nv">bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="nv">pulay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>default<span class="o">)</span>

Chosen<span class="w"> </span>values:<span class="w"> </span><span class="nv">bin</span><span class="o">=</span><span class="m">10</span>,<span class="w"> </span><span class="nv">init_bin</span><span class="o">=</span><span class="m">5</span>,<span class="w"> </span><span class="nv">pulay</span><span class="o">=</span><span class="m">1</span>,<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="nv">equil_steps</span><span class="o">=</span><span class="m">50</span>

<span class="c1"># Note: this corresponds to ``forces_vmc.sh 10 5 1``</span>
</pre></div>
</div>
<p>Postprocessing basically does reblocking using the binning technique. Here again post-processing has two modes: manual and interactive. The reblocked total energy and error are written to the file <code class="docutils literal notranslate"><span class="pre">energy_error.out</span></code>. More details are provided in the file <code class="docutils literal notranslate"><span class="pre">pip0.d</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>cat<span class="w"> </span>pip0.d
<span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>-1.17399712181874<span class="w">  </span><span class="m">4</span>.494314925096871E-004
</pre></div>
</div>
</section>
<section id="lrdmc-wf-jsagps">
<span id="turbogeniustutorial-0101-10"></span><h2><a class="toc-backref" href="#id15" role="doc-backlink">10 LRDMC (WF=JsAGPs)</a><a class="headerlink" href="#lrdmc-wf-jsagps" title="Permalink to this heading">¶</a></h2>
<p>The same as in the JDFT case. See <a class="reference internal" href="#turbogeniustutorial-0101-04"><span class="std std-ref">04 LRDMC (WF=JDFT)</span></a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../09lrdmc/alat_0.20/
cp<span class="w"> </span>../../08vmc/fort.10<span class="w"> </span>.
turbogenius<span class="w"> </span>lrdmc<span class="w"> </span>-g<span class="w"> </span>-etry<span class="w"> </span>-1.10<span class="w"> </span>-alat<span class="w"> </span>-0.20<span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
<p>Now run the LRDMC calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="w"> </span><span class="c1"># parallel version</span>
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh
</pre></div>
</div>
<p>For post-processing use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turbogenius<span class="w"> </span>lrdmc<span class="w"> </span>-post<span class="w"> </span>-bin<span class="w"> </span><span class="m">20</span><span class="w"> </span>-corr<span class="w"> </span><span class="m">3</span><span class="w"> </span>-warmup<span class="w"> </span><span class="m">5</span>
<span class="c1"># This corresponds to forcefn.sh 20 3 5 1</span>
</pre></div>
</div>
<p>Thus, we get <span class="math">E (a=0.20 bohr)</span> = -1.1739(4) Ha.</p>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">11 Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>Total energy:</p>
<ul class="simple">
<li><p>DFT (PZ-LDA) = -1.1373 Ha</p></li>
<li><p>VMC (JDFT) = -1.1727(7) Ha</p></li>
<li><p>VMC (JAGPs) = -1.1749(4) Ha</p></li>
<li><p>LRDMC (JDFT at a=0.20 bohr) = -1.1744(7) Ha.</p></li>
<li><p>LRDMC (JAGPs at a=0.20 bohr) = -1.1739(4) Ha.</p></li>
<li><p>CCSD(T)=FULL/cc-pVQZ = -1.173793 Ha (<a class="reference external" href="https://cccbdb.nist.gov/energy3x.asp?method=63&amp;basis=25&amp;charge=0">Computational Chemistry Comparison and Benchmark DataBase</a>)</p></li>
</ul>
</section>
<section id="preparing-a-jagp-wavefuction-of-the-h-dimer-with-a-shorter-bond-distance">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">12 Preparing a JAGP wavefuction of the H dimer with a shorter bond distance</a><a class="headerlink" href="#preparing-a-jagp-wavefuction-of-the-h-dimer-with-a-shorter-bond-distance" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># preparing a JDFT trial wavefunction</span>
<span class="nb">cd</span><span class="w"> </span>10trial_wavefunction/00makefort10/
turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-g<span class="w"> </span>-str<span class="w"> </span>H2_dimer.xyz<span class="w"> </span>-detbasis<span class="w"> </span>cc-pVTZ<span class="w"> </span>-jasbasis<span class="w"> </span>cc-pVDZ<span class="w"> </span>-detcutbasis<span class="w"> </span>-jascutbasis
turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-r
turbogenius<span class="w"> </span>makefort10<span class="w"> </span>-post

mv<span class="w"> </span>fort.10<span class="w"> </span>fort.10_in
turbogenius<span class="w"> </span>convertfort10mol<span class="w"> </span>-g<span class="w"> </span>-r<span class="w"> </span>-post

<span class="c1"># run DFT</span>
<span class="nb">cd</span><span class="w"> </span>../01DFT/
cp<span class="w"> </span>../00makefort10/fort.10<span class="w"> </span>./
turbogenius<span class="w"> </span>prep<span class="w"> </span>-g<span class="w"> </span>-grid<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span>-lbox<span class="w"> </span><span class="m">10</span>.0<span class="w"> </span><span class="m">10</span>.0<span class="w"> </span><span class="m">10</span>.0

<span class="c1"># on a local machine (serial version)</span>
prep-serial.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>prep-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh

turbogenius<span class="w"> </span>prep<span class="w"> </span>-post

<span class="c1"># conversion</span>
<span class="nb">cd</span><span class="w"> </span>../02jdft_to_jagp/
cp<span class="w"> </span>../01DFT/fort.10_new<span class="w"> </span>fort.10
turbogenius<span class="w"> </span>convertwf<span class="w"> </span>-to<span class="w"> </span>agps
</pre></div>
</div>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">13 Nodal surface optimization (WF=JsAGPs)</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../../11optimization/
cp<span class="w"> </span>../10trial_wavefunction/02jdft_to_jagp/fort.10<span class="w"> </span>./
turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-g<span class="w"> </span>-opt_onebody<span class="w"> </span>-opt_twobody<span class="w"> </span>-opt_jas_mat<span class="w"> </span>-opt_det_mat<span class="w"> </span>-optimizer<span class="w"> </span>lr<span class="w"> </span>-vmcoptsteps<span class="w"> </span><span class="m">100</span><span class="w"> </span>-steps<span class="w"> </span><span class="m">10</span>

<span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh

turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-post<span class="w"> </span>-optwarmup<span class="w"> </span><span class="m">80</span><span class="w"> </span>-plot
</pre></div>
</div>
</section>
<section id="vmc-before-structural-optimization">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">14 VMC before structural optimization</a><a class="headerlink" href="#vmc-before-structural-optimization" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../12vmc
cp<span class="w"> </span>../11optimization/fort.10<span class="w"> </span>fort.10
turbogenius<span class="w"> </span>vmc<span class="w"> </span>-g<span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-force

<span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh

turbogenius<span class="w"> </span>vmc<span class="w"> </span>-post<span class="w"> </span>-bin<span class="w"> </span><span class="m">10</span><span class="w"> </span>-warmup<span class="w"> </span><span class="m">5</span>

<span class="c1"># check force</span>
%cat<span class="w"> </span>forces_vmc.dat
Force<span class="w"> </span>component<span class="w"> </span><span class="m">1</span>
<span class="nv">Force</span><span class="w">   </span><span class="o">=</span><span class="w"> </span>-0.581448055902718<span class="w">       </span><span class="m">3</span>.012635556421040E-002
<span class="m">1</span>.943226397097583E-003
Der<span class="w"> </span><span class="nv">Eloc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.566537913456315<span class="w">       </span><span class="m">2</span>.996930056497041E-002
&lt;OH&gt;<span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.890900221204126<span class="w">       </span><span class="m">4</span>.750020105279961E-002
&lt;O&gt;&lt;H&gt;<span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.898355292427328<span class="w">       </span><span class="m">4</span>.681606812429169E-002
<span class="m">2</span>*<span class="o">(</span>&lt;OH&gt;<span class="w"> </span>-<span class="w"> </span>&lt;O&gt;&lt;H&gt;<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-1.491014244640310E-002<span class="w">  </span><span class="m">3</span>.607617628391403E-003
</pre></div>
</div>
</section>
<section id="structural-optimization">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">15 Structural optimization</a><a class="headerlink" href="#structural-optimization" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../13str_optimization
cp<span class="w"> </span>../12vmc/fort.10<span class="w"> </span>./
turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-g<span class="w"> </span>-opt_onebody<span class="w"> </span>-opt_twobody<span class="w"> </span>-opt_jas_mat<span class="w"> </span>-opt_det_mat<span class="w"> </span>-optimizer<span class="w"> </span>lr<span class="w"> </span>-vmcoptsteps<span class="w"> </span><span class="m">100</span><span class="w"> </span>-steps<span class="w"> </span><span class="m">10</span><span class="w"> </span>-opt_structure<span class="w"> </span>-strlearn<span class="w"> </span><span class="m">1</span>.0e-6

<span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh

turbogenius<span class="w"> </span>vmcopt<span class="w"> </span>-post<span class="w"> </span>-optwarmup<span class="w"> </span><span class="m">80</span><span class="w"> </span>-plot
</pre></div>
</div>
</section>
<section id="vmc-after-structural-optimization">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">16 VMC after structural optimization</a><a class="headerlink" href="#vmc-after-structural-optimization" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../14vmc
cp<span class="w"> </span>../13str_optimization/fort.10<span class="w"> </span>fort.10
turbogenius<span class="w"> </span>vmc<span class="w"> </span>-g<span class="w"> </span>-steps<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-force

<span class="c1"># on a local machine (serial version)</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a local machine (parallel version)</span>
mpirun<span class="w"> </span>-np<span class="w"> </span>XX<span class="w"> </span>turborvb-mpi.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
<span class="c1"># on a cluster machine (PBS)</span>
qsub<span class="w"> </span>submit.sh
<span class="c1"># on a cluster machine (Slurm)</span>
sbatch<span class="w"> </span>submit.sh

turbogenius<span class="w"> </span>vmc<span class="w"> </span>-post<span class="w"> </span>-bin<span class="w"> </span><span class="m">10</span><span class="w"> </span>-warmup<span class="w"> </span><span class="m">5</span>

<span class="c1"># check force</span>
%cat<span class="w"> </span>forces_vmc.dat
Force<span class="w"> </span>component<span class="w"> </span><span class="m">1</span>
<span class="nv">Force</span><span class="w">   </span><span class="o">=</span><span class="w">  </span><span class="m">8</span>.845943906431761E-003<span class="w">  </span><span class="m">2</span>.073719499651680E-002
<span class="m">1</span>.397654468993750E-003
Der<span class="w"> </span><span class="nv">Eloc</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">6</span>.856205295579485E-003<span class="w">  </span><span class="m">2</span>.011093288033853E-002
&lt;OH&gt;<span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.901136545231286<span class="w">       </span><span class="m">3</span>.656293234452725E-002
&lt;O&gt;&lt;H&gt;<span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.900141675925860<span class="w">       </span><span class="m">3</span>.673121825334205E-002
<span class="m">2</span>*<span class="o">(</span>&lt;OH&gt;<span class="w"> </span>-<span class="w"> </span>&lt;O&gt;&lt;H&gt;<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">1</span>.989738610852276E-003<span class="w">  </span><span class="m">3</span>.770140210987045E-003
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../00prep_index.html" class="btn btn-neutral float-left" title="Starting from a built-in DFT calculation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../02C-dimer/tutorial.html" class="btn btn-neutral float-right" title="02Carbon_dimer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kosuke Nakano (SISSA/JAIST) and collaborators..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>