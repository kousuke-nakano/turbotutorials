<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>01_01Hydrogen_dimer &mdash; Turbotutorials Updated on 24/04/2023 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/roles.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="01_02Hydrogen_dimer" href="../01_02Hydrogen_dimer/tutorial.html" />
    <link rel="prev" title="TurboRVB tutorials" href="../00index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Turbotutorials
          </a>
              <div class="version">
                Updated on 24/04/2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../00index.html">TurboRVB tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">01_01Hydrogen_dimer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">00 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparing-a-jdft-trial-wavefunction">01 Preparing a JDFT trial wavefunction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#preparing-a-makefort10-input-file">01-01 Preparing a makefort10.input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-a-jsagps-ansatz">01-02 Generating a JsAGPs ansatz</a></li>
<li class="toctree-l4"><a class="reference internal" href="#convert-the-jsagps-ansatz-to-a-jsd-one">01-03 Convert the JsAGPs ansatz to a JSD one</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-dft-calculation">01-04 Run DFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#one-body-jastrow-factor-optimization">01-05 One-body Jastrow factor optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jastrow-factor-optimization-wf-jdft">02 Jastrow factor optimization (WF=JDFT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vmc-wf-jdft">03 VMC (WF=JDFT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lrdmc-wf-jdft">04 LRDMC (WF=JDFT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convert-jdft-wf-to-jsagps-one">05 Convert JDFT WF to JsAGPs one</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-check">06 Conversion check</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-wf-jsagps">07 Optimization (WF=JsAGPs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vmc-wf-jsagps">08 VMC (WF=JsAGPs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lrdmc-wf-jsagps">09 LRDMC (WF=JsAGPs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">10 Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../01_02Hydrogen_dimer/tutorial.html">01_02Hydrogen_dimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_01Li-dimer/tutorial.html">02_01Lithium_dimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../98_wf_optimization/tutorial.html">98 Wavefuntion optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../02turbogenius/00index.html">Turbo-Genius tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03turboworkflows/00index.html">TurboWorkflows tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Turbotutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../00index.html">TurboRVB tutorials</a></li>
      <li class="breadcrumb-item active">01_01Hydrogen_dimer</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/01turborvb/01_01Hydrogen_dimer/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hydrogen-dimer">
<span id="turborvbtutorial-0101"></span><h1><a class="toc-backref" href="#id2" role="doc-backlink">01_01Hydrogen_dimer</a><a class="headerlink" href="#hydrogen-dimer" title="Permalink to this heading">¶</a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#hydrogen-dimer" id="id2">01_01Hydrogen_dimer</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id3">00 Introduction</a></p></li>
<li><p><a class="reference internal" href="#preparing-a-jdft-trial-wavefunction" id="id4">01 Preparing a JDFT trial wavefunction</a></p></li>
<li><p><a class="reference internal" href="#jastrow-factor-optimization-wf-jdft" id="id5">02 Jastrow factor optimization (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#vmc-wf-jdft" id="id6">03 VMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#lrdmc-wf-jdft" id="id7">04 LRDMC (WF=JDFT)</a></p></li>
<li><p><a class="reference internal" href="#convert-jdft-wf-to-jsagps-one" id="id8">05 Convert JDFT WF to JsAGPs one</a></p></li>
<li><p><a class="reference internal" href="#conversion-check" id="id9">06 Conversion check</a></p></li>
<li><p><a class="reference internal" href="#optimization-wf-jsagps" id="id10">07 Optimization (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#vmc-wf-jsagps" id="id11">08 VMC (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#lrdmc-wf-jsagps" id="id12">09 LRDMC (WF=JsAGPs)</a></p></li>
<li><p><a class="reference internal" href="#summary" id="id13">10 Summary</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<span id="turborvbtutorial-0101-00"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">00 Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>From this tutorial, you can learn how to calculate all-electron Variational Monte Carlo (VMC) and lattice regularized diffusion Monte Carlo (LRDMC) energies of the H<sub>2</sub> dimer. You can download all the input and output files from <a class="reference download internal" download="" href="../../../_downloads/f854fe96a505707f2e05b215d30f1afb/file.tar.gz"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
<p>This is a workflow of this tutorial:</p>
<a class="reference internal image-reference" href="../../../_images/workflow_detailed.jpeg"><img alt="../../../_images/workflow_detailed.jpeg" class="align-center" src="../../../_images/workflow_detailed.jpeg" style="width: 614.4000000000001px; height: 819.2px;" /></a>
<p>This is the detailed workflow of this tutorial:</p>
<a class="reference internal image-reference" href="../../../_images/turbo_flow.jpg"><img alt="../../../_images/turbo_flow.jpg" class="align-center" src="../../../_images/turbo_flow.jpg" style="width: 582.2px; height: 1342.6000000000001px;" /></a>
</section>
<section id="preparing-a-jdft-trial-wavefunction">
<span id="turborvbtutorial-0101-01"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink">01 Preparing a JDFT trial wavefunction</a><a class="headerlink" href="#preparing-a-jdft-trial-wavefunction" title="Permalink to this heading">¶</a></h2>
<section id="preparing-a-makefort10-input-file">
<span id="turborvbtutorial-0101-01-01"></span><h3>01-01 Preparing a makefort10.input file<a class="headerlink" href="#preparing-a-makefort10-input-file" title="Permalink to this heading">¶</a></h3>
<p>Move to a working directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>01trial_wavefunction/00makefort10
</pre></div>
</div>
<p>The first step of this tutorial is to generate a Jastrow antisymmetrized Geminal Power (JsAGPs) ansatz,
which will be convert to a Jastrow Slater determinant (JSD) ansatz later. First, one should prepare “makefort10.input” to generate an AGP ansatz. This is a <em>minimun</em> makefort10.input.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># makefort10.input</span>

<span class="p">&amp;</span>system
<span class="w"> </span><span class="nv">posunits</span><span class="o">=</span><span class="s1">&#39;bohr&#39;</span>
<span class="w"> </span><span class="nv">natoms</span><span class="o">=</span><span class="m">2</span>
<span class="w"> </span><span class="nv">ntyp</span><span class="o">=</span><span class="m">1</span>
<span class="w"> </span><span class="nv">pbcfort10</span><span class="o">=</span>.false.
/

<span class="p">&amp;</span>electrons
<span class="w"> </span><span class="nv">twobody</span><span class="o">=</span>-15
<span class="w"> </span><span class="nv">twobodypar</span><span class="o">=</span><span class="m">0</span>.50
<span class="w"> </span><span class="nv">onebodypar</span><span class="o">=</span><span class="m">0</span>.50
<span class="w"> </span><span class="nv">no_4body_jas</span><span class="o">=</span>.false.
<span class="w"> </span><span class="nv">neldiff</span><span class="o">=</span><span class="m">0</span>
/

<span class="p">&amp;</span>symmetries
<span class="w"> </span><span class="nv">eqatoms</span><span class="o">=</span>.true.
<span class="w"> </span><span class="nv">rot_det</span><span class="o">=</span>.true.
<span class="w"> </span><span class="nv">symmagp</span><span class="o">=</span>.true.
/

ATOMIC_POSITIONS
<span class="m">1</span>.0<span class="w">   </span><span class="m">1</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span>-1.0000000000
<span class="m">1</span>.0<span class="w">   </span><span class="m">1</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0000000000
/

ATOM_1
<span class="p">&amp;</span>shells
<span class="w"> </span><span class="nv">nshelldet</span><span class="o">=</span><span class="m">7</span>
<span class="w"> </span><span class="nv">nshelljas</span><span class="o">=</span><span class="m">6</span>
/
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">5</span>.095000000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.159000000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.325800000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.102700000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.407000000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.388000000000
<span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.057000000000
<span class="c1">#  Parameters atomic Jastrow wf</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.83560000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.18530000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.09555000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.26134000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.18114000000
<span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.36285000000
</pre></div>
</div>
<p>Here are brief explanations of the input variables.
Please refer to the user manual and README in details:</p>
<p><strong>&amp;system namelist</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">posunits</span></code> Unit used in the calculation (STRING). bohr and crystal are implemented.</p>
<p><code class="docutils literal notranslate"><span class="pre">natoms</span></code> The number of atoms contained in the system (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">ntyp</span></code> The number of atomic species (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">pbcfort10</span></code> periodic boundary condition (BOOLEN).</p>
<p><strong>&amp;electrons namelist</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">twobody</span></code> Switch of Jastrow factor (INTEGER). For all electron calculation, we recommend -15 (spin-independent) or -22 (spin-dependent). In this tutorial, we employ -15.</p>
<p><code class="docutils literal notranslate"><span class="pre">twobodypar</span></code> Variational parameter of two-body Jastrow factor (Float). <span class="math">b_{ee}</span> in Eq.33 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper. we recommend 1.00 as the initial value.</p>
<p><code class="docutils literal notranslate"><span class="pre">onebodypar</span></code> Variational Parameter of one-body Jastrow factor (Float). <span class="math">b_{ea}</span> in Eq.31 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper. The suitable initial value depends on the largest exponent of an employed basis set. See later.</p>
<p><code class="docutils literal notranslate"><span class="pre">no_4body_jas</span></code> No four-body Jastrow factor (BOOLEAN). Indeed, if this is true, <span class="math">M</span> in Eq.34 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper is set zero for <span class="math">a \neq b</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">neldiff</span></code> Difference between the number of spin-up electrons and the number of spin-down electrons (INTEGER).</p>
<p><strong>&amp;symmetries namelist</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">eqatoms</span></code> Treating the same atoms equally  (BOOLEAN).</p>
<p><code class="docutils literal notranslate"><span class="pre">rot_det</span></code> Taking the rotational symmetries into account (BOOLEAN).</p>
<p><code class="docutils literal notranslate"><span class="pre">symmagp</span></code> If true, taking into account of only singlet pairings, if false, considering also triplet pairings (BOOLEAN).</p>
<p><strong>ATOMIC_POSITIONS namelist</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ATOMIC_POSITIONS
<span class="m">1</span>.0<span class="w">   </span><span class="m">1</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span>-1.0000000000
<span class="m">1</span>.0<span class="w">   </span><span class="m">1</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0000000000
</pre></div>
</div>
<p>They represent:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ATOMIC_POSITIONS
Electrons,<span class="w"> </span>Atomic<span class="w"> </span>number,<span class="w"> </span>Position<span class="w"> </span>x,<span class="w"> </span>Position<span class="w"> </span>y,<span class="w"> </span>Position<span class="w"> </span>z
Electrons,<span class="w"> </span>Atomic<span class="w"> </span>number,<span class="w"> </span>Position<span class="w"> </span>x,<span class="w"> </span>Position<span class="w"> </span>y,<span class="w"> </span>Position<span class="w"> </span>z
...
</pre></div>
</div>
<p>wherein The unit of the coordinations are set by “posunits” in &amp;system namelist.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Electrons = Atomic number in an all-electron calculation.
On the other hand,  Electrons != Atomic number in a pseudo-potential calculation.</p>
</div>
<p><strong>ATOM_1</strong></p>
<p>This section describes basis sets used for the determinant and Jastrow parts for ATOM_1.</p>
<p>As in quantum chemistry, the choice of a basis set strongly affects the results.
One can employ an well-optimized basis set for an open system, from the Basis Set Exchange (<a class="reference external" href="https://www.basissetexchange.org/">https://www.basissetexchange.org/</a>). In this tutorial, we choose the cc-pVTZ basis set.
You can see optimized exponents and contraction coefficients as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#Gaussian format</span>

H<span class="w">     </span><span class="m">0</span>
S<span class="w">   </span><span class="m">5</span><span class="w">   </span><span class="m">1</span>.00
<span class="w">      </span><span class="m">3</span>.387000D+01<span class="w">           </span><span class="m">6</span>.068000D-03
<span class="w">      </span><span class="m">5</span>.095000D+00<span class="w">           </span><span class="m">4</span>.530800D-02
<span class="w">      </span><span class="m">1</span>.159000D+00<span class="w">           </span><span class="m">2</span>.028220D-01
<span class="w">      </span><span class="m">3</span>.258000D-01<span class="w">           </span><span class="m">5</span>.039030D-01
<span class="w">      </span><span class="m">1</span>.027000D-01<span class="w">           </span><span class="m">3</span>.834210D-01
S<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.00
<span class="w">      </span><span class="m">3</span>.258000D-01<span class="w">           </span><span class="m">1</span>.000000D+00
S<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.00
<span class="w">      </span><span class="m">1</span>.027000D-01<span class="w">           </span><span class="m">1</span>.000000D+00
P<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.00
<span class="w">      </span><span class="m">1</span>.407000D+00<span class="w">           </span><span class="m">1</span>.000000D+00
P<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.00
<span class="w">      </span><span class="m">3</span>.880000D-01<span class="w">           </span><span class="m">1</span>.000000D+00
D<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.00
<span class="w">      </span><span class="m">1</span>.057000D+00<span class="w">           </span><span class="m">1</span>.0000000
****
</pre></div>
</div>
<p>In Gaussian format, exponents are listed a the left column (<span class="math">33.87</span>, <span class="math">5.095</span>…), and contraction coefficients appears at the right (<span class="math">0.006068</span>, <span class="math">0.04530800</span>…).
Only the optimized exponents are needed in general.</p>
<p>In all-electron calculations, we recommend that you cut several s orbitals having large exponents.
The cut s orbitals are implicitly compensated by the one body Jastrow term  (see. <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00295">J. Chem. Theory Comput. 2019, 15, 7, 4044-4055</a> ).
An empirical criteria is <span class="math">\eta \ge 8 \times \rm{atomic number}</span>. For example, we can discard the topmost <span class="math">\eta = 33.87 \ge 8 \time 1.0</span>.</p>
<p>Also, when there exist duplicated coefficients, you can choose only one of them.
For example, <span class="math">0.1027</span> appears twice, and you can remove one of them.
Finally, you should take 7 Gaussian primitive basis in total:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>S<span class="w">   </span><span class="m">4</span>
<span class="w">      </span><span class="m">5</span>.095000
<span class="w">      </span><span class="m">1</span>.159000
<span class="w">      </span><span class="m">0</span>.325800
<span class="w">      </span><span class="m">0</span>.102700
P<span class="w">   </span><span class="m">2</span>
<span class="w">      </span><span class="m">1</span>.407000
<span class="w">      </span><span class="m">0</span>.388000
D<span class="w">   </span><span class="m">1</span>
<span class="w">      </span><span class="m">1</span>.057000
</pre></div>
</div>
<p>put the Gaussian basis set into makefort10.input file as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ATOM_1
<span class="p">&amp;</span>shells
<span class="nv">nshelldet</span><span class="o">=</span><span class="m">7</span>
<span class="nv">nshelljas</span><span class="o">=</span><span class="m">6</span>
/
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">5</span>.095000000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.159000000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.325800000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.102700000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.407000000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.388000000000
<span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.057000000000
<span class="c1">#  Parameters atomic Jastrow wf</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.83560000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.18530000000
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.09555000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">1</span>.26134000000
<span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">36</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.18114000000
<span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">68</span>
<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">0</span>.36285000000
</pre></div>
</div>
<p>wherein,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">16</span>
<span class="m">1</span><span class="w">   </span><span class="m">5</span>.095000000000
</pre></div>
</div>
<p>represents,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Number<span class="w"> </span>of<span class="w"> </span>orbitals,<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>exponents<span class="w"> </span><span class="o">(</span>and/or<span class="w"> </span>coefficients<span class="o">)</span>,<span class="w"> </span>Type<span class="w"> </span>of<span class="w"> </span>orbital
Label,<span class="w">  </span>Exponents
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Type</span> <span class="pre">of</span> <span class="pre">orbital</span></code> specifies an angular momentum of orbital, i.e., s, p, d, f, g, h, which correspond to 16, 36, 68, 48, xx, and xx, respectively. In detail, please refer to makefun.f90 in src directory.</p>
<p><code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">orbitals</span></code> should be consistenti with the type of orbital, i.e., 1, 3, 5, 7, 9, 11 for s, p, d, f, g, h, respectively.</p>
<p><code class="docutils literal notranslate"><span class="pre">Label</span></code> is a dummy variable in makefort10.input as long as <code class="docutils literal notranslate"><span class="pre">eqatoms</span></code> is set .true., so one can usually set it unity.</p>
<p>You should also set the following two variables:</p>
<p><code class="docutils literal notranslate"><span class="pre">nshelldet</span></code> The number of gaussian basis for use in the determinant part (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">nshelljas</span></code> The number of gaussian basis for use in Jastrow factor (INTEGER).</p>
<p>We are ready for generating a JAGP ansatz.</p>
</section>
<section id="generating-a-jsagps-ansatz">
<span id="turborvbtutorial-0101-01-02"></span><h3>01-02 Generating a JsAGPs ansatz<a class="headerlink" href="#generating-a-jsagps-ansatz" title="Permalink to this heading">¶</a></h3>
<p>One can generate a JsAGPs ansatz using the prepared makefort10.input by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">makefort10.x</span></code> outputs <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code>. All information of a many body wavefunction is written in <code class="docutils literal notranslate"><span class="pre">fort.10_XXX</span></code> file in TurboRVB.</p>
<p>At the same time, <code class="docutils literal notranslate"><span class="pre">structure.xsf</span></code> is generated. One can check if the input structure is what you have expected, e.g., by xcrysden.</p>
<a class="reference internal image-reference" href="../../../_images/H2_dimer.jpg"><img alt="../../../_images/H2_dimer.jpg" class="align-center" src="../../../_images/H2_dimer.jpg" style="width: 304.2px; height: 134.20000000000002px;" /></a>
</section>
<section id="convert-the-jsagps-ansatz-to-a-jsd-one">
<span id="turborvbtutorial-0101-01-03"></span><h3>01-03 Convert the JsAGPs ansatz to a JSD one<a class="headerlink" href="#convert-the-jsagps-ansatz-to-a-jsd-one" title="Permalink to this heading">¶</a></h3>
<p>One should convert the generated JAGP ansatz to Jastrow Slater Determinant (JSD) one to prepare a trial wavefunction using DFT. In this tutorial, the nodal surface of the JSD ansatz is fixed to DFT one, so the trial wave function is called JDFT (i.e., JSD with DFT orbitals).
First, rename <cite>fort.10_new</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_in
</pre></div>
</div>
<p>Then, prepare <code class="docutils literal notranslate"><span class="pre">convertfort10mol.input</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># convertfort10mol.input</span>

<span class="p">&amp;</span>control
<span class="nv">epsdgm</span><span class="o">=</span>-1d-14
/
<span class="p">&amp;</span>mesh_info
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.20
<span class="nv">nx</span><span class="o">=</span><span class="m">64</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">68</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">128</span>
/
<span class="p">&amp;</span>molec_info
<span class="nv">nmol</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nmolmax</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nmolmin</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<p>Here are brief explanations of the variables:</p>
<p><strong>&amp;mesh_info namelist</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">ax</span></code> Mesh width in x direction. The unit is Bohr</p>
<p><code class="docutils literal notranslate"><span class="pre">ay</span></code> Mesh width in y direction. If it is not specified, <code class="docutils literal notranslate"><span class="pre">ay</span></code> = <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">az</span></code> Mesh width in y direction. If it is not specified, <code class="docutils literal notranslate"><span class="pre">az</span></code> = <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nx</span></code> The number of mesh in x direction.</p>
<p><code class="docutils literal notranslate"><span class="pre">ny</span></code> The number of mesh in y direction.  If it is not specified, <code class="docutils literal notranslate"><span class="pre">ny</span></code> = <code class="docutils literal notranslate"><span class="pre">nx</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">nz</span></code> The number of mesh in z direction.  If it is not specified, <code class="docutils literal notranslate"><span class="pre">nz</span></code> = <code class="docutils literal notranslate"><span class="pre">nx</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These variables should be set so that the rectangular of (ax × nx)(ay × ny)(az × nz) encloses the molecule, and ax, ay, and az are small enough to be consistent with an electronic scale, typically 0.01 Bohr and 0.10 Bohr for all-electron and pseudo-potential calculations.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>However, the size of grids are not necessarily small here because convertfort10mol.x generetes random coefficients of molecular orbitals, just for initialization of the coefficients.</p>
</div>
<p><strong>&amp;molec_info namelist</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">nmol</span></code> <code class="docutils literal notranslate"><span class="pre">nmolmin</span></code> <code class="docutils literal notranslate"><span class="pre">nmolmax</span></code>  The numbers of molecular orbitals. When they equals to N/2, where N is the total number of electrons in the system, JAGP = JDFT.</p>
<p>After preparing “convertfort10mol.input”, covert <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> (JAGP) to <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> (JSD) by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>convertfort10mol.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10mol.input<span class="w"> </span>&gt;<span class="w"> </span>out_mol
</pre></div>
</div>
<p>Confirm that the <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> is generated. If you find <code class="docutils literal notranslate"><span class="pre">100000</span></code> (molecular orbital) in fort.10_new and it counts N/2, you have successfully converted the JAGP to a JSD ansatz.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># fort.10_new</span>

<span class="m">1</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">1000000</span>
<span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">30</span><span class="w">  </span><span class="m">2</span>.692246437072754E-002<span class="w">  </span>-0.490652024745941<span class="w">  </span><span class="m">0</span>.157296895980835<span class="w">  </span><span class="m">0</span>.340546727180481<span class="w">  </span><span class="m">0</span>.224633455276489<span class="w">  </span><span class="m">0</span>.208685338497162<span class="w">  </span>-0.312226712703705<span class="w">  </span>-0.185131192207336<span class="w">  </span><span class="m">0</span>.174039185047150<span class="w">  </span>-0.284971058368683<span class="w">  </span><span class="m">0</span>.335320353507996<span class="w">  </span><span class="m">0</span>.242606043815613<span class="w">  </span>-0.442098379135132<span class="w">  </span>-0.289426684379578<span class="w">  </span>-0.410119652748108<span class="w">  </span><span class="m">0</span>.449322640895844<span class="w">  </span><span class="m">0</span>.266223728656769<span class="w">  </span>-0.189827919006348<span class="w">  </span>-0.223830282688141<span class="w">  </span><span class="m">0</span>.267185926437378<span class="w">  </span><span class="m">0</span>.268258810043335<span class="w">  </span><span class="m">0</span>.370114803314209<span class="w">  </span><span class="m">0</span>.462309062480927<span class="w">  </span><span class="m">0</span>.226067721843719<span class="w">  </span><span class="m">0</span>.272605717182159<span class="w">  </span>-0.395478725433350<span class="w">  </span>-0.320022642612457<span class="w">   </span><span class="m">0</span>.356949687004089<span class="w">  </span><span class="m">0</span>.159764945507050<span class="w">  </span>-0.193772673606873
</pre></div>
</div>
<p>Finally, rename <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
</pre></div>
</div>
</section>
<section id="run-dft-calculation">
<span id="turborvbtutorial-0101-01-04"></span><h3>01-04 Run DFT calculation<a class="headerlink" href="#run-dft-calculation" title="Permalink to this heading">¶</a></h3>
<p>As written above, the coefficients of the molecular orbitals generated by “convertfort10mol.x” are random. Therefore, the next step is to optimize coefficients using a build-in DFT code, called <cite>prep.x</cite>.</p>
<p>First, make a working directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../01DFT
</pre></div>
</div>
<p>Next, copy the prepared <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> to 01DFT directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../00makefort10/fort.10<span class="w"> </span>./
</pre></div>
</div>
<p>This is a minimum input for a DFT calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#prep.input</span>

<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span>-4
<span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
/
<span class="p">&amp;</span>optimization
<span class="nv">molopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
<span class="p">&amp;</span>molecul
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.20
<span class="nv">nx</span><span class="o">=</span><span class="m">32</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">32</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">64</span>
/
<span class="p">&amp;</span>dft
<span class="nv">maxit</span><span class="o">=</span><span class="m">50</span>
<span class="nv">epsdft</span><span class="o">=</span>1d-5
<span class="nv">mixing</span><span class="o">=</span><span class="m">0</span>.5d0
<span class="nv">typedft</span><span class="o">=</span><span class="m">1</span>
<span class="nv">optocc</span><span class="o">=</span><span class="m">0</span>
<span class="nv">nelocc</span><span class="o">=</span><span class="m">1</span>
/
<span class="m">2</span>
</pre></div>
</div>
<p>Here are brief explanations of the variables:</p>
<p><strong>&amp;simulation section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">itestr4</span></code> Always set -4 in a DFT calculation (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">iopt=1</span></code>  From scratch 1, Restart 0 (INTEGER).</p>
<p><strong>&amp;optimization section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">molopt</span></code> Always set 1 in a DFT calculation (INTEGER).</p>
<p><strong>&amp;dft section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">maxit</span></code> Maximun number of SCF iterations (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">epsdft</span></code> Tollerance in convergence in total energy (DOUBLE).</p>
<p><code class="docutils literal notranslate"><span class="pre">mixing</span></code> Mixing in the density (DOUBLE).</p>
<p><code class="docutils literal notranslate"><span class="pre">typedft</span></code> Type of exchange-correlation functional (INTEGER). typedft=0 Hartree, typedft=1 LDA (PZ 1981), typefit=2 LDA (OB 1994). We recommend 1 (PZ-LDA).</p>
<p><code class="docutils literal notranslate"><span class="pre">optocc</span></code> Flag, smearing (Integer). 0: no use (i.e, fixed), 1: use.</p>
<p><code class="docutils literal notranslate"><span class="pre">neloc</span></code> The number of occupied spatial orbitals (INTEGER). You should specify this variable and put the occupations explicitly below when you use <code class="docutils literal notranslate"><span class="pre">optocc</span></code> = 0.</p>
<p><strong>&amp;mesh_info namelist</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">ax</span></code> Mesh width in x direction. The unit is Bohr</p>
<p><code class="docutils literal notranslate"><span class="pre">ay</span></code> Mesh width in y direction. If it is not specified, <code class="docutils literal notranslate"><span class="pre">ay</span></code> = <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">az</span></code> Mesh width in y direction. If it is not specified, <code class="docutils literal notranslate"><span class="pre">az</span></code> = <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nx</span></code> The number of mesh in x direction.</p>
<p><code class="docutils literal notranslate"><span class="pre">ny</span></code> The number of mesh in y direction.  If it is not specified, <code class="docutils literal notranslate"><span class="pre">ny</span></code> = <code class="docutils literal notranslate"><span class="pre">nx</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">nz</span></code> The number of mesh in z direction.  If it is not specified, <code class="docutils literal notranslate"><span class="pre">nz</span></code> = <code class="docutils literal notranslate"><span class="pre">nx</span></code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>One should carefully choose the size and the number of grids in DFT calculation. Grid sizes and the numbers should be set so that the rectangular of (ax × nx)(ay × ny)(az × nz) encloses the molecule, and ax, ay, and az are small enough to be consistent with an electronic scale, typically 0.01 Bohr and 0.10 Bohr for all-electron and pseudo-potential calculations. The so-called double-grid scheme avoids us from using the small size of grid for all-electron calculation. Please refer to the Li-tutorial.</p>
</div>
<p><strong>occupation</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">2</span></code> in the last line. This indicates the number of electrons occupying each electron orbital.</p>
<p>After preparing <code class="docutils literal notranslate"><span class="pre">prep.input</span></code>, one can start DFT:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>prep-serial.x<span class="w"> </span>&lt;<span class="w"> </span>prep.input<span class="w"> </span>&gt;<span class="w"> </span>out_prep
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">prep-serial.x</span></code> generates an output file <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code>, to which optimized molecular orbitals are written. This obtained trial wavefunction is denoted <code class="docutils literal notranslate"><span class="pre">JDFT</span></code> (i.e., JSD ansatz with DFT orbitals).</p>
<p>DFT-LDA total energy, the occupations, etc… are written in <code class="docutils literal notranslate"><span class="pre">out_prep</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iterations =     7</span>
Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.108056839095119
</pre></div>
</div>
<p>The generated <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> is used for the following VMC and DMC calculations as its <strong>trial wave function</strong> / <strong>guiding wave function</strong>.</p>
</section>
<section id="one-body-jastrow-factor-optimization">
<span id="turborvbtutorial-0101-01-05"></span><h3>01-05 One-body Jastrow factor optimization<a class="headerlink" href="#one-body-jastrow-factor-optimization" title="Permalink to this heading">¶</a></h3>
<p>In TurboRVB, inner s orbitals are implicitly compensated by the one body Jastrow term  (See. <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00295">J. Chem. Theory Comput. 2019, 15, 7, 4044-4055</a> ). Indeed, the quality of a trial wavefunction depends on onebody Jastrow factor <span class="math">b</span> in Eq.31 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper. Therefore, we should optimize the one-body parameter <span class="math">b</span> at the DFT level.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../02onebody_jastrow_opt
</pre></div>
</div>
<p>Run DFT calculations by changing parameter <span class="math">b</span> in fort.10</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># in fort.10</span>

<span class="c1"># Parameters Jastrow two body</span>
<span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">0</span>.500000000000000<span class="w">       </span><span class="m">0</span>.600000000000000<span class="w"> </span>&lt;-<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>b
</pre></div>
</div>
<p>Then, you get:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%kosukenoMBP%<span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;variat&quot;</span><span class="w"> </span>b_*/out_prep

b_0.50/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.108442236649934
b_0.60/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.109010338029238
b_0.70/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.109205292027722
b_0.80/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.109229424614839
b_0.90/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.109156340624355
b_1.00/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.109032022526679
b_1.20/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.108750694390122
b_1.30/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.108626544919879
b_1.50/out_prep:<span class="w"> </span>Final<span class="w"> </span>variational<span class="w"> </span>DFT<span class="w">  </span>energy<span class="w"> </span><span class="o">(</span>Ha<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>-1.108434821311452
</pre></div>
</div>
<p>we can choose the lowest one, i.e., <span class="math">b = 0.80</span>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#onebody-script for csh</span>
<span class="nb">set</span><span class="w"> </span><span class="nv">b_onebody_list</span><span class="o">=</span><span class="s2">&quot;0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5&quot;</span>

<span class="nb">set</span><span class="w"> </span><span class="nv">root_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
foreach<span class="w"> </span>b_onebody<span class="w"> </span><span class="o">(</span><span class="nv">$b_onebody_list</span><span class="o">)</span>
<span class="w">    </span>mkdir<span class="w"> </span>onebody_<span class="nv">$b_onebody</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>onebody_<span class="nv">$b_onebody</span>
<span class="w">    </span>cp<span class="w"> </span><span class="nv">$root_dir</span>/temp/fort.10<span class="w"> </span>./
<span class="w">    </span>cp<span class="w"> </span><span class="nv">$root_dir</span>/temp/prep.input<span class="w"> </span>./
<span class="w">    </span>cp<span class="w"> </span><span class="nv">$root_dir</span>/temp/submit.sh<span class="w"> </span>./
<span class="w">    </span>sed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/b_onebody/</span><span class="nv">$b_onebody</span><span class="s2">/g&quot;</span><span class="w"> </span>fort.10
<span class="w">    </span>qsub<span class="w"> </span>submit.sh
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$root_dir</span>
end

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;b_onebody dft energy&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>result.out

foreach<span class="w"> </span>b_onebody<span class="w"> </span><span class="o">(</span><span class="nv">$b_onebody_list</span><span class="o">)</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>onebody_<span class="nv">$b_onebody</span>
<span class="w">    </span><span class="nb">set</span><span class="w"> </span><span class="nv">energy</span><span class="o">=</span><span class="sb">`</span>grep<span class="w"> </span><span class="s2">&quot;Final self consistent energy&quot;</span><span class="w"> </span>./out_prep<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $7}&#39;</span><span class="sb">`</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">b_onebody</span><span class="si">}</span><span class="s2">  </span><span class="si">${</span><span class="nv">energy</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>../result.out
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$root_dir</span>
end
</pre></div>
</div>
</section>
</section>
<section id="jastrow-factor-optimization-wf-jdft">
<span id="turborvbtutorial-0101-02"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink">02 Jastrow factor optimization (WF=JDFT)</a><a class="headerlink" href="#jastrow-factor-optimization-wf-jdft" title="Permalink to this heading">¶</a></h2>
<p>In this step, Jastrow factors are optimized at the VMC level
First, create a working directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../../02optimization
</pre></div>
</div>
<p>Next, copy the trial wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> generated by the DFT calculation to <code class="docutils literal notranslate"><span class="pre">02optimization</span></code> directory and rename it to <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../01trial_wavefunction/01DFT/fort.10_new<span class="w"> </span>fort.10
</pre></div>
</div>
<p>Then, prepare <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code>, which is a minimal input file for a VMC-optimization:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasmin.input</span>

<span class="p">&amp;</span>simulation
<span class="w">  </span><span class="nv">itestr4</span><span class="o">=</span>-4
<span class="w">  </span><span class="nv">ngen</span><span class="o">=</span><span class="m">50000</span>
<span class="w">  </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">10800</span>

/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
<span class="w">  </span><span class="nv">epscut</span><span class="o">=</span><span class="m">1</span>.0d-10
/
<span class="p">&amp;</span>optimization
<span class="w">  </span><span class="nv">nweight</span><span class="o">=</span><span class="m">1000</span>
<span class="w">  </span><span class="nv">nbinr</span><span class="o">=</span><span class="m">10</span>
<span class="w">  </span><span class="nv">iboot</span><span class="o">=</span><span class="m">0</span>
<span class="w">  </span><span class="nv">tpar</span><span class="o">=</span><span class="m">3</span>.5d-1
<span class="w">  </span><span class="nv">parr</span><span class="o">=</span><span class="m">5</span>.0d-3
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
<span class="w">  </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<p>Here are brief explanations of the variables:</p>
<p><strong>&amp;simulation section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">itestr4</span></code> Optimization method (INTEGER). -4 (-8) the modified linear method (LR) [<a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.98.110201">the original linear method</a>], -9 (-5) the stochastic reconfiguration (SR) [See. <a class="reference external" href="https://aip.scitation.org/doi/abs/10.1063/1.2746035">ref</a>]. See also the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper.</p>
<p><code class="docutils literal notranslate"><span class="pre">ngen</span></code> Total number of Monte Carlo sampling (INTEGER). Number of optimization steps is <code class="docutils literal notranslate"><span class="pre">ngen</span></code>/<code class="docutils literal notranslate"><span class="pre">nweight</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">1</span></code> 1:From scratch, 0:Restart.</p>
<p><code class="docutils literal notranslate"><span class="pre">maxtime</span></code> Maximun CPU time (INTEGER).</p>
<p><strong>&amp;vmc section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">epscut</span></code> Regularization parameter. Small positive value (DOUBLE).</p>
<p><strong>&amp;optimization section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">nweight</span></code> Number of Monte Carlo sampling per a optimization step (INTEGER).  Be careful to choose <code class="docutils literal notranslate"><span class="pre">nweight</span></code>.  If it is too small, the outcome is biased, also error bars during optimization steps become too large. Again, the total number of optimization steps is <code class="docutils literal notranslate"><span class="pre">ngen</span></code>/<code class="docutils literal notranslate"><span class="pre">nweight</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nbinr</span></code> Bin (reblocking) length per a optimization step (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">iboot</span></code> Number of equilibrium step per a optimization step (INTEGER).</p>
<p><code class="docutils literal notranslate"><span class="pre">ncg</span></code> The number of the natural gradients calculated the present and the previous optimization steps (ncg) to span global line parameter directions in eq. 135 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper. See the <code class="docutils literal notranslate"><span class="pre">VII</span> <span class="pre">B.</span> <span class="pre">Linear</span> <span class="pre">method</span></code> section of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper.
Choose 1 for the SR method (not used), 2-4 is fine for the linear method.</p>
<p><code class="docutils literal notranslate"><span class="pre">tpar</span></code> a hyper parameter <span class="math">\Delta</span> for the acceleration (DOUBLE).  See the eq. 128 and eq. 139 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper, for the SR and LR method, respectively.
~ 0.30 is preferable for LR method. On the other hand, ~1.0d-4 can be an initial value of <code class="docutils literal notranslate"><span class="pre">tpar</span></code> for the SR method, and you can use <code class="docutils literal notranslate"><span class="pre">adjust_tpar</span></code> option to find an optimal <code class="docutils literal notranslate"><span class="pre">tpar</span></code> automatically, as discussed later.</p>
<p><code class="docutils literal notranslate"><span class="pre">parr</span></code> a hyper parameter  <span class="math">\varepsilon</span> for the regularization of the preconditioning matrix (i.e., ill-conditioned).  See the equation (130) of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper.</p>
<p><strong>&amp;parameters section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">iesd</span></code> Optimizing one-body and two-body Jastrow parameters (INTEGER).  0: fixed, 1: optimized.</p>
<p><code class="docutils literal notranslate"><span class="pre">iesfree</span></code> Optimizing three/four-body Jastrow parameters (INTEGER).  0: fixed, 1: optimized.</p>
<p><code class="docutils literal notranslate"><span class="pre">iessw</span></code> Optimizing coefficients of the antisymmetric (determinant of pfaffian) part (INTEGER).  0: fixed, 1: optimized.</p>
<p><code class="docutils literal notranslate"><span class="pre">iesup</span></code> Optimizing exponents of the atomic orbitals (the antisymmetric part) and coefficients of hybrid orbitals (INTEGER).  0: fixed, 1: optimized.</p>
<p><code class="docutils literal notranslate"><span class="pre">iesm</span></code> Optimizing exponents of the atomic orbitals (Jastrow part) (INTEGER).  0: fixed, 1: optimized.</p>
<p>After preparing <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code>, you can start a VMC optimization:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a real run (i.e., for a peer-reviewed paper), one should optimize variational parameters much more carefully. We recommend that one consult to an expert or a developer of TurboRVB, or carefully read the <a class="reference internal" href="../98_wf_optimization/tutorial.html#turborvbtutorial-98"><span class="std std-ref">98 Wavefuntion optimization</span></a> part.</p>
</div>
<p>After finishing the calculation, you can delete temporary files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-r<span class="w"> </span>turborvb.scratch/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Files in turborvb.scratch is needed for continuing the calculation (i.e., <code class="docutils literal notranslate"><span class="pre">iopt</span></code> = 0).</p>
</div>
<p>Next, confirm energy convergence by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>plot_Energy.sh<span class="w"> </span>out_min
</pre></div>
</div>
<p>Then, you can see the following window.</p>
<a class="reference internal image-reference" href="../../../_images/plot_Energy.PNG"><img alt="../../../_images/plot_Energy.PNG" class="align-center" src="../../../_images/plot_Energy.PNG" style="width: 384.0px; height: 288.0px;" /></a>
<p>When the energy (plotted in violet) is converged, energy minimization is successfully completed.
As can be seen from this window, 200 steps are performed to minimize the total energy.</p>
<p>Alternatively, you may check the convergence using row data:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>New<span class="w"> </span>out_min
</pre></div>
</div>
<p>Next, check the convergence of devmax by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>plot_devmax.sh<span class="w"> </span>out_min
</pre></div>
</div>
<p>Then, you can see following window.</p>
<a class="reference internal image-reference" href="../../../_images/plot_devmax.PNG"><img alt="../../../_images/plot_devmax.PNG" class="align-center" src="../../../_images/plot_devmax.PNG" style="width: 384.0px; height: 288.0px;" /></a>
<p>When the devmax (plotted in violet) is below the threshold, convergence is achieved.</p>
<p>Alternatively, you may check the convergence using row data:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>KosukenoMacBook-Pro-2%<span class="w"> </span>grep<span class="w"> </span>New<span class="w"> </span>out_min
New<span class="w"> </span><span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">   </span>-1.11404046317607<span class="w">       </span><span class="m">1</span>.050065489593612E-002
New<span class="w"> </span><span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">   </span>-1.11787627130192<span class="w">       </span><span class="m">7</span>.600965145837732E-003
New<span class="w"> </span><span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">   </span>-1.11586670351862<span class="w">       </span><span class="m">9</span>.751652956980546E-003
New<span class="w"> </span><span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">   </span>-1.12715052371262<span class="w">       </span><span class="m">5</span>.705645767390606E-003
New<span class="w"> </span><span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">   </span>-1.12493358677406<span class="w">       </span><span class="m">4</span>.972731686123029E-003
...
</pre></div>
</div>
<p>Next step is to average optimized variational parameters. first of all, you can check variational parameters v.s. optimization step:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>readalles.x
bin<span class="w"> </span>length,<span class="w"> </span>ibinit,<span class="w"> </span>write<span class="w"> </span>fort.10<span class="w"> </span><span class="o">(</span><span class="m">0</span>/1<span class="o">)</span>,<span class="w"> </span>draw<span class="w"> </span><span class="o">(</span><span class="m">0</span>/1<span class="o">)</span><span class="w"> </span>?
<span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>
number<span class="w"> </span>of<span class="w"> </span>generations<span class="w"> </span>from<span class="w"> </span>standard<span class="w"> </span>input?<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w">  </span>yes,<span class="w"> </span><span class="m">0</span><span class="w"> </span>no<span class="o">)</span>
<span class="m">0</span>
max<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>ind<span class="w"> </span>par<span class="w">  </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>wf
<span class="m">1000</span>
</pre></div>
</div>
<p>Here:</p>
<p><code class="docutils literal notranslate"><span class="pre">bin</span> <span class="pre">length</span></code> is the number of steps per bin.</p>
<p><code class="docutils literal notranslate"><span class="pre">ibinit</span></code> is the number of disregarded steps for averaging, i.e, , 1 to (<code class="docutils literal notranslate"><span class="pre">ibinit</span></code> - 1) steps are discarded, and remaining steps starting from <code class="docutils literal notranslate"><span class="pre">ibinit</span></code> are averaged. This is used at the next step.</p>
<p><code class="docutils literal notranslate"><span class="pre">write</span> <span class="pre">fort.10</span> <span class="pre">(0/1)</span></code> indicates whether the averaged variational parameters is written to fort.10.</p>
<p><code class="docutils literal notranslate"><span class="pre">draw</span> <span class="pre">(0/1)</span></code> plot optimized parameters using gnuplot.</p>
<p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">ind</span> <span class="pre">par</span></code> is the number of the parameters plotted using gnuplot.</p>
<p>Then, you can see following figures:</p>
<a class="reference internal image-reference" href="_sources/01turborvb/01_01Hydrogen_dimer/J2.PNG"><img alt="_sources/01turborvb/01_01Hydrogen_dimer/J2.PNG" class="align-center" src="_sources/01turborvb/01_01Hydrogen_dimer/J2.PNG" /></a>
<a class="reference internal image-reference" href="_sources/01turborvb/01_01Hydrogen_dimer/J1.PNG"><img alt="_sources/01turborvb/01_01Hydrogen_dimer/J1.PNG" class="align-center" src="_sources/01turborvb/01_01Hydrogen_dimer/J1.PNG" /></a>
<a class="reference internal image-reference" href="_sources/01turborvb/01_01Hydrogen_dimer/J3.PNG"><img alt="_sources/01turborvb/01_01Hydrogen_dimer/J3.PNG" class="align-center" src="_sources/01turborvb/01_01Hydrogen_dimer/J3.PNG" /></a>
<p>The figures show the changes in variational parameters. In our experience, it is very difficult all the variational parameters are converged. However, at least, we should keep optimizing WF until the first two variational parameters (i.e., the two-body and the one-body Jastrow parameters) are converged well, as shown here.</p>
<p>You may know the number of steps that required to obtain converged the Jastrow factors (e.g, 201- in this example).  Since QMC calculations always suffers from statistical noises, the variational parameters also fluctuate. Therefore, one should average the optimized variational parameters in the converged region (e.g, 201-300 in this example). The average can be also done by <cite>readalles.x</cite> module.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>readalles.x
bin<span class="w"> </span>length,<span class="w"> </span>ibinit,<span class="w"> </span>write<span class="w"> </span>fort.10<span class="w"> </span><span class="o">(</span><span class="m">0</span>/1<span class="o">)</span>,<span class="w"> </span>draw<span class="w"> </span><span class="o">(</span><span class="m">0</span>/1<span class="o">)</span><span class="w"> </span>?
<span class="m">1</span><span class="w"> </span><span class="m">201</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span>
number<span class="w"> </span>of<span class="w"> </span>generations<span class="w"> </span>from<span class="w"> </span>standard<span class="w"> </span>input?<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w">  </span>yes,<span class="w"> </span><span class="m">0</span><span class="w"> </span>no<span class="o">)</span>
<span class="m">0</span>
max<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>ind<span class="w"> </span>par<span class="w">  </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>wf
<span class="m">1000</span>

...

record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">290</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">291</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">292</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">293</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">294</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">295</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">296</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">297</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">298</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">299</span>
record<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">300</span>
number<span class="w"> </span>of<span class="w"> </span>measures<span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="m">100</span><span class="w">  </span>&lt;-<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>averaged<span class="w"> </span>steps
</pre></div>
</div>
<p>Thus, variational parameters will be averaged over the remaining last 60 steps.
<code class="docutils literal notranslate"><span class="pre">readalles.x</span></code> writes the averaged variational parameters in the end of <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># fort.10</span>

...
<span class="c1"># new parameters</span>
<span class="m">0</span>.290626442260694E+00<span class="w">   </span><span class="m">0</span>.108521356525542E+01<span class="w">  </span>-0.301131622319121E+00<span class="w">  </span>-0.102380295055131E+01<span class="w">   </span><span class="m">0</span>.229700639835700E+01<span class="w">  </span>-0.220409737565913E-02<span class="w">  </span>-0.609584028614942E-02<span class="w">   </span><span class="m">0</span>.272306548035257E-01<span class="w">   </span><span class="m">0</span>.734700209267177E-01<span class="w">  </span>-0.182065664321832E-01<span class="w">   </span><span class="m">0</span>.453293541473009E+00<span class="w">   </span><span class="m">0</span>.164648614827512E+00<span class="w">   </span><span class="m">0</span>.173486608007203E-02<span class="w">   </span><span class="m">0</span>.583308470999047E-02<span class="w">  </span>-0.188429085081367E-01<span class="w">   </span><span class="m">0</span>.248889135790375E-01<span class="w">  </span>-0.138300779564990E+00<span class="w">   </span><span class="m">0</span>.440777377680407E+00<span class="w">  </span>-0.134604374717883E+01<span class="w">  </span>-0.707524794465785E-03<span class="w">   </span><span class="m">0</span>.780729515612661E-03<span class="w">  </span>-0.151361566539925E-01<span class="w">  </span>-0.522035153211261E-01<span class="w">   </span><span class="m">0</span>.366708625842555E-01<span class="w">  </span>-0.175477073796467E+00<span class="w">   </span><span class="m">0</span>.211200067156240E+00<span class="w">   </span><span class="m">0</span>.925206078797516E-03<span class="w">   </span><span class="m">0</span>.334330184442289E-02<span class="w">  </span>-0.556589712590827E-02<span class="w">   </span><span class="m">0</span>.324861920952639E-01<span class="w">   </span><span class="m">0</span>.941094689163063E-01<span class="w">  </span>-0.387403732714091E+01<span class="w">  </span>-0.872987341975953E+01<span class="w">  </span>-0.489666531788676E-01<span class="w">   </span><span class="m">0</span>.509954432475785E-01<span class="w">  </span>-0.151442414
</pre></div>
</div>
</section>
<section id="vmc-wf-jdft">
<span id="turborvbtutorial-0101-03"></span><h2><a class="toc-backref" href="#id6" role="doc-backlink">03 VMC (WF=JDFT)</a><a class="headerlink" href="#vmc-wf-jdft" title="Permalink to this heading">¶</a></h2>
<p>As written above, averaged (i.e., optimized) variational parameters are just written in the end of <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.  The next step is to write the optimized parameters. Run a dummy VMC.</p>
<p>First, create a working directory by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../03vmc
</pre></div>
</div>
<p>and copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> from <code class="docutils literal notranslate"><span class="pre">02optimization</span></code> to <code class="docutils literal notranslate"><span class="pre">03VMC</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../02optimization/fort.10<span class="w"> </span>./
</pre></div>
</div>
<p>Then, copy <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code> from <code class="docutils literal notranslate"><span class="pre">02optimization</span></code> and rename it as <code class="docutils literal notranslate"><span class="pre">ave.in</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../02optimization/datasmin.input<span class="w"> </span>ave.in
</pre></div>
</div>
<p>You must also rewrite value of <code class="docutils literal notranslate"><span class="pre">ngen</span></code> in <code class="docutils literal notranslate"><span class="pre">ave.in</span></code> as <code class="docutils literal notranslate"><span class="pre">ngen</span> <span class="pre">=</span> <span class="pre">1</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">ngen</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>Next, replace the following line of <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># unconstrained iesfree,iessw,ieskinr,I/O flag</span>
<span class="w">     </span><span class="m">435</span><span class="w">         </span><span class="m">466</span><span class="w">           </span><span class="m">6</span><span class="w">           </span><span class="m">0</span>
</pre></div>
</div>
<p>with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># unconstrained iesfree,iessw,ieskinr,I/O flag</span>
<span class="w">     </span><span class="m">435</span><span class="w">         </span><span class="m">466</span><span class="w">           </span><span class="m">6</span><span class="w">           </span><span class="m">1</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">I/O</span> <span class="pre">flag</span></code> is changed to <code class="docutils literal notranslate"><span class="pre">1</span></code>, which allows us to write the optimized variational parameters.</p>
<p>Run the dummy VMC by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>ave.in<span class="w"> </span>&gt;<span class="w"> </span>out_ave
</pre></div>
</div>
<p>Next step is to run VMC for calculating the total energy.
Prepare datasvmc.input:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span><span class="m">2</span>
<span class="nv">ngen</span><span class="o">=</span><span class="m">15000</span>
<span class="nv">maxtime</span><span class="o">=</span><span class="m">86000</span>
<span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
/
<span class="p">&amp;</span>optimization
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
</pre></div>
</div>
<p><strong>&amp;simulation section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">itestr4</span></code> indicates run type. Choose 2 for VMC.</p>
<p><code class="docutils literal notranslate"><span class="pre">ngen</span></code> Total number of Monte Carlo sampling.</p>
<p><code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">1</span></code> 1:From scratch, 0:Restart.</p>
<p>Run a VMC calculation by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
</pre></div>
</div>
<p>Remove unnecessary files when you finish the calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-r<span class="w"> </span>turborvb.scratch/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Files in turborvb.scratch is needed for continuing the calculation (i.e., <code class="docutils literal notranslate"><span class="pre">iopt</span></code> = 0).</p>
</div>
<p>After the VMC run finishes, check the total energy by running the script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>forcevmc.sh<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
...
max<span class="w"> </span>k<span class="w"> </span>corrections,<span class="w"> </span>bin<span class="w"> </span>lenght,<span class="w"> </span>ibinit,iskip<span class="w">  </span>?
number<span class="w"> </span>of<span class="w"> </span>measures<span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="o">=</span><span class="w">        </span><span class="m">1496</span>
max<span class="w"> </span>k<span class="w"> </span>corrections,<span class="w"> </span>bin<span class="w"> </span>lenght,<span class="w"> </span>ibinit,iskip<span class="w">  </span>?
number<span class="w"> </span>of<span class="w"> </span>measures<span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="o">=</span><span class="w">        </span><span class="m">1496</span>
-------------------------------------------------
The<span class="w"> </span>elapse<span class="w"> </span><span class="nb">time</span><span class="w"> </span>of<span class="w"> </span>forcevmc.sh<span class="w"> </span>is<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">[</span>sec<span class="o">]</span>
-------------------------------------------------
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">forcevmc.sh</span></code> performs reblocking, wherein 10, 5, and 1 are <code class="docutils literal notranslate"><span class="pre">bin</span> <span class="pre">length</span></code>, <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">discarded</span> <span class="pre">bins</span></code> (i.e., warm-up steps), and <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">ratio</span> <span class="pre">of</span> <span class="pre">Pulay</span> <span class="pre">force</span></code> (1 is ok), respectively. A reblocked total energy  and its variance is written in <code class="docutils literal notranslate"><span class="pre">pip0.d</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#cat pip0.d</span>

number<span class="w"> </span>of<span class="w"> </span>bins<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">        </span><span class="m">1496</span>
<span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>-1.1379192772188327<span class="w">        </span><span class="m">1</span>.7589095174214898E-004
Variance<span class="w"> </span><span class="nv">square</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="m">1</span>.7369139136828382E-003<span class="w">   </span><span class="m">2</span>.7618833870090571E-005
Est.<span class="w"> </span>energy<span class="w"> </span>error<span class="w"> </span><span class="nv">bar</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="m">1</span>.7510470092362484E-004<span class="w">   </span><span class="m">3</span>.9800256121536918E-006
Est.<span class="w"> </span>corr.<span class="w"> </span><span class="nb">time</span><span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">2</span>.6420266523220208<span class="w">       </span><span class="m">0</span>.10738159557488412
</pre></div>
</div>
</section>
<section id="lrdmc-wf-jdft">
<span id="turborvbtutorial-0101-04"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">04 LRDMC (WF=JDFT)</a><a class="headerlink" href="#lrdmc-wf-jdft" title="Permalink to this heading">¶</a></h2>
<p>Lattice regularized diffusion Monte Carlo (LRDMC) is a projection technique that
can improve a trial wavefunction obtained by a DFT calculation or a VMC optimization systematically. Indeed, this method filters out the ground state wavefunction
fro a given trial wavefunction. See <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.95.100201">the original Casula’s paper</a>, or the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper in detail.</p>
<p>In LRDMC, the Suzuki-Trotter decomposition is no longer necessary,
the so-called time step error does not exist unlike the conventional DMC technique.
Instead, there is the so-called lattice-space error in LRDMC,
because the Hamiltonian is regularized by allowing electrons hopping with finite step size <code class="docutils literal notranslate"><span class="pre">alat</span></code> (Bohr).
Therefore, one should extrapolate energies calculated by several
lattice spaces (<code class="docutils literal notranslate"><span class="pre">alat</span></code>) to obtain an unbiased energy (:math`alat to 0`).</p>
<p>Move to a working directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../04lrdmc
</pre></div>
</div>
<p>You should copy an optimized fort.10 to the current directory,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../03vmc/fort.10<span class="w"> </span>.
</pre></div>
</div>
<p>and prepare the following input files, <code class="docutils literal notranslate"><span class="pre">datasvmc.input</span></code> and <code class="docutils literal notranslate"><span class="pre">datasfn.input</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasvmc.input</span>
<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span><span class="m">2</span>
<span class="nv">ngen</span><span class="o">=</span><span class="m">100</span>
<span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
<span class="nv">epscut</span><span class="o">=</span><span class="m">1</span>.0d-10
/
<span class="p">&amp;</span>optimization
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
</pre></div>
</div>
<p>and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># datasfn.input</span>
<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span>-6
<span class="nv">ngen</span><span class="o">=</span><span class="m">200000</span>
<span class="nv">iopt</span><span class="o">=</span><span class="m">2</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>dmclrdmc
<span class="nv">tbra</span><span class="o">=</span><span class="m">0</span>.1d0
<span class="nv">etry</span><span class="o">=</span>-1.14d0
<span class="nv">alat</span><span class="o">=</span>-0.20
<span class="nv">alat2</span><span class="o">=</span><span class="m">0</span>.0d0
!iesrandoma<span class="o">=</span>.true.
/
<span class="p">&amp;</span>readio
/
<span class="p">&amp;</span>parameters
/
</pre></div>
</div>
<p>Here, the VMC run is needed for generating initial electron configurations.</p>
<p>Here are brief explanations of the variables for a LRDMC calculation:</p>
<p><strong>&amp;simulation section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">itestr4</span></code> Run type.  Choose -6 for LRDMC.</p>
<p><code class="docutils literal notranslate"><span class="pre">ngen</span></code> Total number of projections (i.e, <span class="math">\exp(-\tau \cdot \hat{\mathcal{H}})</span>).</p>
<p><code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">1</span></code> 1:From scratch, 2:Restart. Since initial configurations are generated by a VMC calculation, choose 2.</p>
<p><strong>&amp;dmclrdmc section</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">tbra</span></code> projection time (i.e, <span class="math">\exp(-\tau \cdot \hat{\mathcal{H}})</span>). Set 0.1 in general. However, for a heavy element, it is better to choose a smaller value. Please check Average number of survived walkers in <code class="docutils literal notranslate"><span class="pre">out_fn</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Av.<span class="w"> </span>num.<span class="w"> </span>of<span class="w"> </span>survived<span class="w"> </span>walkers/<span class="w"> </span><span class="c1"># walkers in the branching</span>
<span class="m">0</span>.9939
</pre></div>
</div>
<p>if the number is too small, try smaller <code class="docutils literal notranslate"><span class="pre">tbra</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">etry</span></code> Put a DFT of VMC energy. <span class="math">\Gamma</span> in eq.6 of the <a class="reference external" href="https://doi.org/10.1063/5.0005037">review</a> paper is set 2 <span class="math">\times</span> <code class="docutils literal notranslate"><span class="pre">etry</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">alat</span></code> The lattice space for discretizing the Hamitonian. If you do a single grid calculation (i.e., alat2=0.0d0), please put a negative value. If you do a double-grid calculation (See. Nakano’s paper), put a positive value and set <code class="docutils literal notranslate"><span class="pre">iesrandoma=.true.</span></code>. This trick is needed for satisfying the detailed-valance condition.</p>
<p><code class="docutils literal notranslate"><span class="pre">alat2</span></code> The corser lattice space used in the double-grid calculation. If you put 0.0d0, Turbo does a single grid calculation. If you want to do a double-grid calculation for a compound include Z &gt; 2 element, please comment out alat2 because alat2 is automatically set (See Nakano’s paper).</p>
<p>Prepare different working directories, copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> to each directory, and set the corresponding <code class="docutils literal notranslate"><span class="pre">alat</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alat_0.10<span class="w">  </span>&lt;-<span class="w"> </span>copy<span class="w"> </span>fort.10,<span class="w"> </span>datasvmc.input,<span class="w"> </span>and<span class="w"> </span>datasfn.input.<span class="w"> </span>Set<span class="w"> </span><span class="nv">alat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.10<span class="w"> </span><span class="k">in</span><span class="w"> </span>datasfn.input.
alat_0.20<span class="w">  </span>&lt;-<span class="w"> </span>copy<span class="w"> </span>fort.10,<span class="w"> </span>datasvmc.input,<span class="w"> </span>and<span class="w"> </span>datasfn.input.<span class="w"> </span>Set<span class="w"> </span><span class="nv">alat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.20<span class="w"> </span><span class="k">in</span><span class="w"> </span>datasfn.input.
alat_0.40<span class="w">  </span>&lt;-<span class="w"> </span>copy<span class="w"> </span>fort.10,<span class="w"> </span>datasvmc.input,<span class="w"> </span>and<span class="w"> </span>datasfn.input.<span class="w"> </span>Set<span class="w"> </span><span class="nv">alat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.40<span class="w"> </span><span class="k">in</span><span class="w"> </span>datasfn.input.
alat_0.60<span class="w">  </span>&lt;-<span class="w"> </span>copy<span class="w"> </span>fort.10,<span class="w"> </span>datasvmc.input,<span class="w"> </span>and<span class="w"> </span>datasfn.input.<span class="w"> </span>Set<span class="w"> </span><span class="nv">alat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-0.60<span class="w"> </span><span class="k">in</span><span class="w"> </span>datasfn.input.
</pre></div>
</div>
<p>And then, run each LRDMC calculation after generating initial electron configurations at the VMC level.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># in alat_0.XX directory</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc<span class="p">;</span>
turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasfn.input<span class="w"> </span>&gt;<span class="w"> </span>out_fn<span class="p">;</span>
</pre></div>
</div>
<p>You can average the local energies with considering weights:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># in alat_0.XX directory</span>
kosukenoMBP%<span class="w"> </span>readf.x
max<span class="w"> </span>k<span class="w"> </span>corrections,<span class="w"> </span>bin<span class="w"> </span>lenght,<span class="w"> </span>ibinit,iskip<span class="w">  </span>?
<span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
number<span class="w"> </span>of<span class="w"> </span>measures<span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="o">=</span><span class="w">        </span><span class="m">9996</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span>
collecting<span class="w"> </span>factor,<span class="w"> </span>bin<span class="w"> </span>length,<span class="w"> </span>initial<span class="w"> </span>bin,<span class="w"> </span>pulay<span class="w"> </span>force
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>fort.20
Independent<span class="w"> </span>bins<span class="w">        </span><span class="m">19996</span><span class="w"> </span>of<span class="w"> </span>lenght<span class="w">           </span><span class="m">10</span>

Energy<span class="w"> </span>,<span class="w"> </span>error,<span class="w"> </span><span class="c1"># of bias correcting factor</span>
-1.13793066055242<span class="w">       </span><span class="m">9</span>.375884167918795E-005<span class="w">           </span><span class="m">0</span><span class="w"> </span>&lt;--<span class="w"> </span>corr.<span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
-1.13796319111127<span class="w">       </span><span class="m">9</span>.318769592623732E-005<span class="w">           </span><span class="m">1</span><span class="w"> </span>&lt;--<span class="w"> </span>corr.<span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
-1.13797737445143<span class="w">       </span><span class="m">9</span>.295013704706716E-005<span class="w">           </span><span class="m">2</span><span class="w"> </span>&lt;--<span class="w"> </span>corr.<span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
-1.13798570959436<span class="w">       </span><span class="m">9</span>.282337020238336E-005<span class="w">           </span><span class="m">3</span><span class="w"> </span>&lt;--<span class="w"> </span>corr.<span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>
-1.13799119297896<span class="w">       </span><span class="m">9</span>.274814895227470E-005<span class="w">           </span><span class="m">4</span><span class="w"> </span>&lt;--<span class="w"> </span>corr.<span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
-1.13799487628498<span class="w">       </span><span class="m">9</span>.270631872370276E-005<span class="w">           </span><span class="m">5</span><span class="w"> </span>&lt;--<span class="w"> </span>corr.<span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
</pre></div>
</div>
<p>The effect of correcting factor is typically very small.
One can also try different reblocking lengths (bin length) and check the convergence.</p>
<p>Please collect all LRDMC energies into <code class="docutils literal notranslate"><span class="pre">evsa.in</span></code>, # at 04lrdmc directory</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span>
<span class="m">0</span>.10<span class="w"> </span>-1.13810148463746<span class="w">       </span><span class="m">1</span>.081107885639917E-004
<span class="m">0</span>.20<span class="w"> </span>-1.13799520203238<span class="w">       </span><span class="m">9</span>.985034545291718E-005
<span class="m">0</span>.40<span class="w"> </span>-1.13811591303364<span class="w">       </span><span class="m">1</span>.092139729594029E-004
<span class="m">0</span>.60<span class="w"> </span>-1.13785055959330<span class="w">       </span><span class="m">1</span>.244613258193110E-004
</pre></div>
</div>
<p>wherein</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># See. Readme of funvsa.x in detail.</span>
<span class="c1"># 2  number of data 4 1</span>
<span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span>
</pre></div>
</div>
<p>for a quadratic fitting i.e., <span class="math">E(a)=E(0) + k_{1} \cdots a^2 + k_{2} \cdots a^4</span> and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># alat    LRDMC energy            Its error bar</span>
<span class="w">  </span><span class="m">0</span>.10<span class="w">    </span>-1.13810148463746<span class="w">       </span><span class="m">1</span>.081107885639917E-004
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">funvsa.x</span></code> is a tool for a quadratic fitting:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>You can see</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Reduced<span class="w"> </span>chi^2<span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">0</span>.876592055494152
Coefficient<span class="w"> </span>found
<span class="w"> </span><span class="m">1</span><span class="w">  </span>-1.13803097957683<span class="w">       </span><span class="m">1</span>.045060026486010E-004<span class="w">  </span>&lt;-<span class="w"> </span>E_0
<span class="w"> </span><span class="m">2</span><span class="w"> </span>-1.039867020790643E-003<span class="w">  </span><span class="m">1</span>.780475364652620E-003<span class="w">  </span>&lt;-<span class="w"> </span>k_1
<span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="m">4</span>.237124912102820E-003<span class="w">  </span><span class="m">4</span>.688879337831868E-003<span class="w">  </span>&lt;-<span class="w"> </span>k_2
</pre></div>
</div>
<p>If you want to do a linear fitting, i.e, i.e., <span class="math">E(a)=E(0) + k_{1} \cdots a^2</span>, put evsa.in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span>
<span class="m">0</span>.10<span class="w"> </span>-1.13810148463746<span class="w">       </span><span class="m">1</span>.081107885639917E-004
<span class="m">0</span>.20<span class="w"> </span>-1.13799520203238<span class="w">       </span><span class="m">9</span>.985034545291718E-005
<span class="m">0</span>.40<span class="w"> </span>-1.13811591303364<span class="w">       </span><span class="m">1</span>.092139729594029E-004
<span class="m">0</span>.60<span class="w"> </span>-1.13785055959330<span class="w">       </span><span class="m">1</span>.244613258193110E-004
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">funvsa.x</span></code> can also do a linear fitting:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>funvsa.x<span class="w"> </span>&lt;<span class="w"> </span>evsa.in<span class="w"> </span>&gt;<span class="w"> </span>evsa.out
</pre></div>
</div>
<p>Check evsa.out</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Reduced<span class="w"> </span>chi^2<span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.873603895738953
Coefficient<span class="w"> </span>found
<span class="w"> </span><span class="m">1</span><span class="w">  </span>-1.13808947524004<span class="w">       </span><span class="m">8</span>.025420272361147E-005<span class="w">  </span>&lt;-<span class="w"> </span>E_0
<span class="w"> </span><span class="m">2</span><span class="w">  </span><span class="m">5</span>.210500236482952E-004<span class="w">  </span><span class="m">4</span>.472096760481409E-004<span class="w">  </span>&lt;-<span class="w"> </span>k_1
</pre></div>
</div>
<p>Thus, we get <span class="math">E(a \to 0)</span> = -1.13808(8) Ha.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For this hydrogen dimer, the linear fit is better than the quadratic one, because the energies are almost constant in the region. Try to plot evsa.in.</p>
</div>
</section>
<section id="convert-jdft-wf-to-jsagps-one">
<span id="turborvbtutorial-0101-05"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">05 Convert JDFT WF to JsAGPs one</a><a class="headerlink" href="#convert-jdft-wf-to-jsagps-one" title="Permalink to this heading">¶</a></h2>
<p>We have finished all JDFT calculation.
Next step is to convert the optimized JDFT ansatz to a JsAGPs one.</p>
<p>Create the following working directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../05convert_WF_JDFT_to_JsAGPs
</pre></div>
</div>
<p>Then, copy <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> in <code class="docutils literal notranslate"><span class="pre">03VMC</span></code> to <code class="docutils literal notranslate"><span class="pre">05convert_WF_JDFT_to_JsAGPs</span></code> and rename it as <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code>, and copy makefort10.input in 01trial_wavefunction/00makefort10 directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../03vmc/fort.10<span class="w"> </span>fort.10_in
cp<span class="w"> </span>../01trial_wavefunction/00makefort10/makefort10.input<span class="w"> </span>./
</pre></div>
</div>
<p>Open <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> by an editor (e.g., emacs) and check the values of <code class="docutils literal notranslate"><span class="pre">twobodypar</span></code> and <code class="docutils literal notranslate"><span class="pre">onebodypar</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters Jastrow two body</span>
<span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">0</span>.290626442260694<span class="w">        </span><span class="m">1</span>.08521356525542
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">twobodypar</span></code> is 0.290626442260694, and <code class="docutils literal notranslate"><span class="pre">onebodypar</span></code> is 1.08521356525542.
Put these values into <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">twobodypar</span><span class="o">=</span><span class="m">0</span>.290626442260694<span class="w">         </span>!<span class="w"> </span>two<span class="w"> </span>body<span class="w"> </span>parameter
<span class="nv">onebodypar</span><span class="o">=</span><span class="m">1</span>.08521356525542<span class="w">          </span>!<span class="w"> </span>one<span class="w"> </span>body<span class="w"> </span>parameter
</pre></div>
</div>
<p>Please generate a <strong>templete</strong> of a JsAGPs ansatz and rename it as <code class="docutils literal notranslate"><span class="pre">fort.10_out</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>makefort10.x<span class="w"> </span>&lt;<span class="w"> </span>makefort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_make
mv<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10_out
</pre></div>
</div>
<p>Next step is to convert the optimized JDFT ansatz to a JsAGPs one.
Prepare <code class="docutils literal notranslate"><span class="pre">convertfort10.input</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># convertfort10.input</span>
<span class="p">&amp;</span>option
/
<span class="p">&amp;</span>control
/
<span class="p">&amp;</span>mesh_info
<span class="nv">nx</span><span class="o">=</span><span class="m">128</span>
<span class="nv">ny</span><span class="o">=</span><span class="m">128</span>
<span class="nv">nz</span><span class="o">=</span><span class="m">256</span>
<span class="nv">ax</span><span class="o">=</span><span class="m">0</span>.05
<span class="nv">ay</span><span class="o">=</span><span class="m">0</span>.05
<span class="nv">az</span><span class="o">=</span><span class="m">0</span>.05
/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use the same grid as in the previous DFT calculation.</p>
</div>
<p>Run a conversion:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>convertfort10.x<span class="w"> </span>&lt;<span class="w"> </span>convertfort10.input<span class="w"> </span>&gt;<span class="w"> </span>out_conv
</pre></div>
</div>
<p>Please check the overlap square in out_conv:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>out_conv
....
Overlap<span class="w"> </span>square<span class="w"> </span>with<span class="w"> </span>no<span class="w"> </span>zero<span class="w">  </span><span class="m">0</span>.99999999999999800
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Overlap</span> <span class="pre">square</span></code> should be close to unity, i.e., if a conversion is perfect, this becomes unity.</p>
<p>The converted WF <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code>. This is an JAGP wavefunction.
Next step is to copy the optimized Jastrow factors. Please rename <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> as <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> and <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> as <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>fort.10_new<span class="w"> </span>fort.10
cp<span class="w"> </span>fort.10_in<span class="w"> </span>fort.10_new
</pre></div>
</div>
<p>A tool <code class="docutils literal notranslate"><span class="pre">copyjas.x</span></code> copies Jastrow factors written in fort.10_new to fort.10.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>copyjas.x<span class="w"> </span>&gt;<span class="w"> </span>out_copyjas
</pre></div>
</div>
<p>The conversion has finished. The obtained JAGP wavefunction is fort.10</p>
</section>
<section id="conversion-check">
<span id="turborvbtutorial-0101-06"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink">06 Conversion check</a><a class="headerlink" href="#conversion-check" title="Permalink to this heading">¶</a></h2>
<p>We recommend one should check if the above conversion was successful.
This can be checked using the so-called correlated sampling method.
Indeed, one can check the difference in energies of WFs using a VMC calculation.</p>
<p>Create a working directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../06conversion_check
</pre></div>
</div>
<p>Copy the obtained JsAGPs wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>, and the optimized JDFT wavefunction <code class="docutils literal notranslate"><span class="pre">fort.10_in</span></code> as <code class="docutils literal notranslate"><span class="pre">fort.10_corr</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../05convert_WF_JDFT_to_JsAGPs/fort.10<span class="w"> </span>./fort.10
cp<span class="w"> </span>../05convert_WF_JDFT_to_JsAGPs/fort.10_in<span class="w"> </span>./fort.10_corr
</pre></div>
</div>
<p>Prepare the following two input files for a correlated sampling calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#datasvmc.input</span>
<span class="p">&amp;</span>simulation
<span class="nv">itestr4</span><span class="o">=</span><span class="m">2</span>
<span class="nv">ngen</span><span class="o">=</span><span class="m">15000</span>
<span class="nv">maxtime</span><span class="o">=</span><span class="m">86000</span>
<span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
<span class="nv">epscut</span><span class="o">=</span><span class="m">1</span>.0d-10
/
<span class="p">&amp;</span>optimization
/
<span class="p">&amp;</span>readio
<span class="nv">iread</span><span class="o">=</span><span class="m">3</span>
/
<span class="p">&amp;</span>parameters
/
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># readforward.input</span>
<span class="p">&amp;</span>simulation
/
<span class="p">&amp;</span>system
/
<span class="p">&amp;</span>corrfun
<span class="nv">bin_length</span><span class="o">=</span><span class="m">100</span>
<span class="nv">initial_bin</span><span class="o">=</span><span class="m">5</span>
<span class="nv">correlated_samp</span><span class="o">=</span>.true.
/
</pre></div>
</div>
<p>Run a correlated sampling</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_vmc
readforward-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasvmc.input<span class="w"> </span>&gt;<span class="w"> </span>out_read
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">corrsampling.dat</span></code> contains the output.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>corrsampling.dat
<span class="w">                                   </span>Number<span class="w"> </span>of<span class="w"> </span>bins<span class="w">                </span><span class="m">146</span>
<span class="w">                      </span>reference<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span><span class="w">  </span>-0.113791540E+01<span class="w">     </span><span class="m">0</span>.169207044E-03
<span class="w">                </span>reweighted<span class="w"> </span>energy:<span class="w"> </span>E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">  </span>-0.113791540E+01<span class="w">     </span><span class="m">0</span>.169207054E-03
reweighted<span class="w"> </span>difference:<span class="w"> </span>E<span class="o">(</span>fort.10<span class="o">)</span>-E<span class="o">(</span>fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.315309090E-08<span class="w">     </span><span class="m">0</span>.316227766E-07
<span class="w">          </span>Overlap<span class="w"> </span>square<span class="w"> </span>:<span class="w"> </span><span class="o">(</span>fort.10,fort.10_corr<span class="o">)</span><span class="w">    </span><span class="m">0</span>.999999992E+00<span class="w">     </span><span class="m">0</span>.316227766E-07
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">reweighted</span> <span class="pre">difference</span></code> indicates the difference in energies of the WFs, <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> and <code class="docutils literal notranslate"><span class="pre">fort.10_corr</span></code>. This should be close to zero. <code class="docutils literal notranslate"><span class="pre">Overlap</span> <span class="pre">square</span></code> should be close to unity, i.e., if a conversion is perfect, this becomes unity.</p>
</section>
<section id="optimization-wf-jsagps">
<span id="turborvbtutorial-0101-07"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">07 Optimization (WF=JsAGPs)</a><a class="headerlink" href="#optimization-wf-jsagps" title="Permalink to this heading">¶</a></h2>
<p>Now that you have obtained a good trial JsAGPs wavefunction,
you can optimize its nodal surface at the VMC level.</p>
<p>Create a working directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>../07optimization
</pre></div>
</div>
<p>Then, copy the converted WF.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>../05convert_WF_JDFT_to_JsAGPs/fort.10<span class="w"> </span>./
</pre></div>
</div>
<p>Prepare <code class="docutils literal notranslate"><span class="pre">datasmin.input</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>simulation
<span class="w">  </span><span class="nv">itestr4</span><span class="o">=</span>-4
<span class="w">  </span><span class="nv">ngen</span><span class="o">=</span><span class="m">200000</span>
<span class="w">  </span><span class="nv">iopt</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">maxtime</span><span class="o">=</span><span class="m">10800</span>
<span class="w">  </span>!nscra<span class="o">=</span><span class="m">1</span>
/
<span class="p">&amp;</span>pseudo
/
<span class="p">&amp;</span>vmc
/
<span class="p">&amp;</span>optimization
<span class="w">  </span><span class="nv">ncg</span><span class="o">=</span><span class="m">2</span>
<span class="w">  </span><span class="nv">nweight</span><span class="o">=</span><span class="m">1000</span>
<span class="w">  </span><span class="nv">nbinr</span><span class="o">=</span><span class="m">10</span>
<span class="w">  </span><span class="nv">iboot</span><span class="o">=</span><span class="m">0</span>
<span class="w">  </span><span class="nv">tpar</span><span class="o">=</span><span class="m">1</span>.5d-1
<span class="w">  </span><span class="nv">parr</span><span class="o">=</span><span class="m">5</span>.0d-3
/
<span class="p">&amp;</span>readio
<span class="w">  </span>!iread<span class="o">=</span><span class="m">3</span>
<span class="w">  </span>!nowrite12<span class="o">=</span>.true.
/
<span class="p">&amp;</span>parameters
<span class="w">  </span><span class="nv">iesd</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iesfree</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="nv">iessw</span><span class="o">=</span><span class="m">1</span>
/
</pre></div>
</div>
<p>The difference from datasmin.input in <code class="docutils literal notranslate"><span class="pre">03optimization</span></code> is <code class="docutils literal notranslate"><span class="pre">iessw</span></code>, because we optimize the determinant part (nodal surface) at this step.</p>
<p>Run a VMC run.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>turborvb-serial.x<span class="w"> </span>&lt;<span class="w"> </span>datasmin.input<span class="w"> </span>&gt;<span class="w"> </span>out_min
</pre></div>
</div>
<p>The rest of procesure is the same as in <a class="reference internal" href="#turborvbtutorial-0101-02"><span class="std std-ref">02 Jastrow factor optimization (WF=JDFT)</span></a> part.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a real run (i.e., for a peer-reviewed paper), one should optimize variational parameters much more carefully. We recommend that one consult to an expert or a developer of TurboRVB, or carefully read the <a class="reference internal" href="../98_wf_optimization/tutorial.html#turborvbtutorial-98"><span class="std std-ref">98 Wavefuntion optimization</span></a> part.</p>
</div>
</section>
<section id="vmc-wf-jsagps">
<span id="turborvbtutorial-0101-08"></span><h2><a class="toc-backref" href="#id11" role="doc-backlink">08 VMC (WF=JsAGPs)</a><a class="headerlink" href="#vmc-wf-jsagps" title="Permalink to this heading">¶</a></h2>
<p>All procedure is the same as in 03VMC (WF=JDFT). You may get:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#cat pip0.d</span>

kosukenoMBP%<span class="w"> </span>cat<span class="w"> </span>pip0.d
number<span class="w"> </span>of<span class="w"> </span>bins<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="o">=</span><span class="w">        </span><span class="m">2996</span>
<span class="nv">Energy</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>-1.13824397697212<span class="w">       </span><span class="m">2</span>.031478212992182E-004
Variance<span class="w"> </span><span class="nv">square</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">6</span>.011315428358828E-004<span class="w">  </span><span class="m">3</span>.723234430114773E-005
Est.<span class="w"> </span>energy<span class="w"> </span>error<span class="w"> </span><span class="nv">bar</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">2</span>.043035139805420E-004<span class="w">  </span><span class="m">7</span>.792161532953647E-006
Est.<span class="w"> </span>corr.<span class="w"> </span><span class="nb">time</span><span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="m">2</span>.08300367700792<span class="w">       </span><span class="m">8</span>.581166733308811E-002
</pre></div>
</div>
<p>When fort.10 is <code class="docutils literal notranslate"><span class="pre">JsAGPs</span></code>, the obtained energy is usually lower than that of <code class="docutils literal notranslate"><span class="pre">JDFT</span></code>.
For the hydrogen dimer at this bond distance, the resonance effect is not important, so the energies are distinguishable. See the Li-dimer tutorial, where JsAGPs energy is much lower than JDFT one.</p>
</section>
<section id="lrdmc-wf-jsagps">
<span id="turborvbtutorial-0101-09"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">09 LRDMC (WF=JsAGPs)</a><a class="headerlink" href="#lrdmc-wf-jsagps" title="Permalink to this heading">¶</a></h2>
<p>All procedure is the same as in 04LRDMC (WF=JDFT). You may get:</p>
<p>Thus, we get <span class="math">E(a \to 0)</span> = -1.13808(7)</p>
<p>_turborvbtutorial_0101_10:</p>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">10 Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># WF energies</span>
VMC<span class="w">   </span><span class="o">(</span>JDFT<span class="o">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span>-1.1379<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w">  </span>Ha
VMC<span class="w">   </span><span class="o">(</span>JsAGPs<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-1.1382<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w">  </span>Ha
LRDMC<span class="w"> </span><span class="o">(</span>JDFT<span class="o">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span>-1.13809<span class="o">(</span><span class="m">8</span><span class="o">)</span><span class="w"> </span>Ha
LRDMC<span class="w"> </span><span class="o">(</span>JsAGPs<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-1.13808<span class="o">(</span><span class="m">7</span><span class="o">)</span><span class="w"> </span>Ha
</pre></div>
</div>
<p>All energies are indistinguishable within the error bars for the hydrogen dimer at 2.0 Bohr. Try a longer bond distance where the static correlation plays an important role (i.e., JsAGPs is better than JDFT).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../00index.html" class="btn btn-neutral float-left" title="TurboRVB tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../01_02Hydrogen_dimer/tutorial.html" class="btn btn-neutral float-right" title="01_02Hydrogen_dimer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kosuke Nakano (SISSA/JAIST) and collaborators..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>